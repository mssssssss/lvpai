!function(l){function e(e){for(var t,n,a=e[0],o=e[1],i=e[2],r=0,c=[];r<a.length;r++)n=a[r],Object.prototype.hasOwnProperty.call(d,n)&&d[n]&&c.push(d[n][0]),d[n]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(l[t]=o[t]);for(p&&p(e);c.length;)c.shift()();return u.push.apply(u,i||[]),s()}function s(){for(var e,t=0;t<u.length;t++){for(var n=u[t],a=!0,o=1;o<n.length;o++){var i=n[o];0!==d[i]&&(a=!1)}a&&(u.splice(t--,1),e=r(r.s=n[0]))}return e}var n={},d={0:0},u=[];function r(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return l[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=l,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://static.meiqia.com/widget/";var t=window.webpackJsonp=window.webpackJsonp||[],a=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var p=a;u.push([478,1]),s()}({126:function(e,t,n){e.exports=n.p+"static/photo-sending.png"},180:function(e,t,n){e.exports=n.p+"static/default-avatar.jpg"},237:function(e,t,n){e.exports=n.p+"static/photo-fail.png"},450:function(e){e.exports=JSON.parse('{"点击问题或回复数字查看答案":"Select the question or reply the number to get solve your problem.","给我们留言":"Leave us a message","分类":"Classification","姓名":"Name","手机":"Phone number","邮箱":"Email","微信":"WeChat","QQ":"QQ","联系人":"Contact","性别":"gender","年龄":"age","电话":"phone","微博":"Weibo","地址":"address","备注":"Remarks","留言内容":"Message","请输入":"Please enter","验证码":"Verification Code","点击更换":"Click Replace","提交":"Submit","留言成功":"Message sent successful","我们会尽快联系你":"We will contact you as soon as possible","关闭":"Close","再次留言":"Leave us a message again","发送":"Send","对方输入消息中...":"The other party enters the message...","连接中...":"Connecting...","对话已结束":"Conversation has ended","对话已结束，您可以<1>开始新的对话</1>或<3>留言</3>":"Conversation has ended, do you wish to <1>continue</1>or to<3>leave a message</3>?","你被移出了黑名单":"You are removed from the blacklist","表情":"Emoji","发送图片":"Picture","发送文件":"File","评价":"Service evaluation","好评":"Satisfied","中评":"Normal","差评":"Dissatisfied","请填写评价内容（选填）":"Please fill in the  evaluation(selectivity)","你给出了":"You are given","下载":"Download","接下来由<1>{{name}}</1>为您服务":"Next by the <1>{{name}}</1> to serve you","客服软件由美洽提供":"Customer service software provided by the Meiqia","转人工":"Change Live Support","免费通话":"Free calls","欢迎使用完全免费的网页回呼与我们通话":"Welcome to the free web page call back to us","请输入你的电话号码":"Please enter your phone number","开始免费通话":"Start a free call","请保持电话畅通，客服人员即将致电":"Please keep the phone open, customer service is about to call","你将接到「010-52729285」的来电":"You will receive an 「010-52729285」 call","询前表单":"Inquiry","获取验证码失败":"Failed to get verification code","加载历史消息":"Load History messages","加载更多历史消息":"Loads more history messages","没有更多了":"No more","加载中...":"Loading...","排队失败，请刷新重试":"Queuing failed. Please refresh and try again","抱歉没能理解您的提问，可选择":"Sorry to fail to understand your question","留言":"message","评价失败，请稍后重试":"Evaluation failed. Please try again later","美洽客服消息":"Meiqia customer service news","管理员":"administrator","[推广消息]":"[Promotion message]","「发来了一个文件」":"「Sent a file」","「发来了一张图片」":"「Sent a picture」","新消息":"New message","粘贴图片失败，请用「图片按钮」上传图片":"Paste picture failed. Please use picture button to upload picture","排队等待中...":"Waiting","正在为您转接，请稍候..":"Please Wait, Turning to Live Support","小时":"Hours","分钟":"Minutes","秒":"Seconds","网络错误，请稍后重试":"Network error. Please try again later","请控制":"Please control","在1到100个字符":"in 1 to 100 characters","请填写必填字段":"required ","请选择":"please choose","请输入验证码":"enter verification code","加载询前表单失败，请稍后重试":"Failed to load pre-query form. Please try again later","连接已断开，请刷新页面":"Network connection error. Please refresh your page and try again.","很抱歉您对此回答不满意":"Dissatisfaction","提交失败，请稍候再试":"Failed to submit. Please try again later","请正确填写手机或带区号的座机号码":"Please fill in the correct mobile phone number","请正确填写验证码":"Please fill in the correct verification code","请选择分类":"please select a type","请正确填写姓名":"Please fill in the name correctly","请正确填写手机号":"Please fill in the mobile phone number correctly","请正确填写联系邮箱":"Please fill in the email correctly","请正确填写微信":"Please fill in the weChat correctly","请正确填写QQ":"Please fill in the QQ correctly","请至少填写一项联系方式":"Please fill in at least one contact information","请保持留言内容在 1～1024 字符内":"Please keep the message in 1 ~ 1024 characters","留言失败，请稍候再试":"Message failed. Please try again later","取消上传":"Cancel upload","上传失败":"Upload failed","上传成功":"Uploaded successfully","只能发送图片哦":"Can only send pictures","只能发送小于 50MB 的文件哦":"Can only send less than 50MB of documents","最多只能发送 2048 个字符哦":"Up to only 2048 characters can be sent","请选择评价等级":"Please select rating","最多只能发送 30 个字符哦":"Up to 30 characters can be sent","抱歉，客服系统暂时无法使用":"Sorry, Service unavailable","当前等待人数":"Number of visitors waiting","如果等不及，可以选择":"Don’t want to wait? Leave us a message.","上传中":"Uploading","已过期":"Expired","{{expireTime}}后过期":"Expires after {{expireTime}}","解决":"Solve","未解决":"Unsolve","提交中":"Submit","已反馈":"Feedback","服务连接中，请稍候…":"Service connecting, please wait...","请至少填写一项":"Please fill in at least one item","您已成功提交":"You have successfully submitted","机器人":"robot"}')},451:function(e){e.exports=JSON.parse('{"点击问题或回复数字查看答案":"點擊問題或回覆數字查看答案","给我们留言":"給我們留言","分类":"分類","姓名":"姓名","手机":"手機","邮箱":"郵箱","微信":"微信","QQ":"QQ","联系人":"聯繫人","性别":"性別","年龄":"年齡","电话":"電話","微博":"微博","地址":"地址","备注":"備註","留言内容":"留言內容","请输入":"請輸入","验证码":"驗證碼","点击更换":"點擊更換","提交":"提交","留言成功":"留言成功","我们会尽快联系你":"我們會盡快聯繫你","关闭":"關閉","再次留言":"再次留言","发送":"發送","对方输入消息中...":"對方輸入消息中...","连接中...":"連接中...","对话已结束":"對話已結束","对话已结束，您可以<1>开始新的对话</1>或<3>留言</3>":"對話已結束，您可以<1>開始新的對話</1>或<3>留言</3>","你被移出了黑名单":"你被移出了黑名單","表情":"表情","发送图片":"發送圖片","发送文件":"發送文件","评价":"評價","好评":"好評","中评":"中評","差评":"差評","请填写评价内容（选填）":"請填寫評價內容（選填）","你给出了":"你給出了","下载":"下載","接下来由<1>{{name}}</1>为您服务":"接下來由<1>{{name}}</1>為您服務","客服软件由美洽提供":"客服系統由美洽提供","转人工":"轉人工","免费通话":"免費通話","欢迎使用完全免费的网页回呼与我们通话":"歡迎使用完全免費的網頁回呼與我們通話","请输入你的电话号码":"請輸入你的電話號碼","开始免费通话":"開始免費通話","请保持电话畅通，客服人员即将致电":"請保持電話暢通，客服人員即將致電","你将接到「010-52729285」的来电":"你將接到「010-52729285」的來電","询前表单":"詢前表單","获取验证码失败":"獲取驗證碼失敗","加载历史消息":"載入歷史消息","加载更多历史消息":"載入更多歷史消息","没有更多了":"沒有更多了","加载中...":"加載中...","排队失败，请刷新重试":"排隊失敗，請刷新重試","抱歉没能理解您的提问，可选择":"抱歉沒能理解您的提問，可選擇","留言":"留言","评价失败，请稍后重试":"評價失敗，請稍後重試","美洽客服消息":"美洽客服消息","管理员":"管理員","[推广消息]":"[推廣消息]","「发来了一个文件」":"「發來了一個文件」","「发来了一张图片」":"「發來了一張圖片」","新消息":"新消息","粘贴图片失败，请用「图片按钮」上传图片":"粘貼圖片失敗，請用「圖片按鈕」上傳圖片","排队等待中...":"排隊等待中...","正在为您转接，请稍候..":"正在為您轉接，請稍候..","小时":"小時","分钟":"分鐘","秒":"秒","网络错误，请稍后重试":"網絡錯誤，請稍後重試","请控制":"請控制","在1到100个字符":"在1到100個字符","请填写必填字段":"請填寫必填字段","请选择":"請選擇","请输入验证码":"請輸入驗證碼","加载询前表单失败，请稍后重试":"加載詢前表單失敗，請稍後重試","连接已断开，请刷新页面":"連接已斷開，請刷新頁面","很抱歉您对此回答不满意":"很抱歉您對此回答不滿意","提交失败，请稍候再试":"提交失敗，請稍候再試","请正确填写手机或带区号的座机号码":"請正確填寫手機或帶區號的座機號碼","请正确填写验证码":"請正確填寫驗證碼","请选择分类":"請選擇分類","请正确填写姓名":"請正確填寫姓名","请正确填写手机号":"請正確填寫手機號","请正确填写联系邮箱":"請正確填寫聯繫郵箱","请正确填写微信":"請正確填寫微信","请正确填写QQ":"請正確填寫QQ","请至少填写一项联系方式":"請至少填寫一項聯繫方式","请保持留言内容在 1～1024 字符内":"請保持留言內容在 1～1024 字符內","留言失败，请稍候再试":"留言失敗，請稍候再試","取消上传":"取消上傳","上传失败":"上傳失敗","上传成功":"上傳成功","只能发送图片哦":"只能發送圖片哦","只能发送小于 50MB 的文件哦":"只能發送小於 50MB 的文件哦","最多只能发送 2048 个字符哦":"最多隻能發送 2048 個字符哦","请选择评价等级":"請選擇評價等級","最多只能发送 30 个字符哦":"最多隻能發送 30 個字符哦","抱歉，客服系统暂时无法使用":"抱歉，客服系統暫時無法使用","当前等待人数":"當前等待人數","如果等不及，可以选择":"如果等不及，可以選擇","上传中":"上傳中","已过期":"已過期","{{expireTime}}后过期":"{{expireTime}}後過期","解决":"解决","未解决":"未解决","提交中":"提交中","已反馈":"已反饋","服务连接中，请稍候…":"服務連接中，請稍候..","请至少填写一项":"請至少填寫一項","您已成功提交":"您已成功提交","机器人":"機器人"}')},452:function(e){e.exports=JSON.parse('{"点击问题或回复数字查看答案":"点击问题或回复数字查看答案","给我们留言":"给我们留言","分类":"分类","姓名":"姓名","手机":"手机","邮箱":"邮箱","微信":"微信","QQ":"QQ","联系人":"联系人","性别":"性别","年龄":"年龄","电话":"电话","微博":"微博","地址":"地址","备注":"备注","留言内容":"留言内容","请输入":"请输入","验证码":"验证码","点击更换":"点击更换","提交":"提交","留言成功":"留言成功","我们会尽快联系你":"我们会尽快联系你","关闭":"关闭","再次留言":"再次留言","发送":"发送","对方输入消息中...":"对方输入消息中...","连接中...":"连接中...","对话已结束":"对话已结束","对话已结束，您可以<1>开始新的对话</1>或<3>留言</3>":"对话已结束，您可以<1>开始新的对话</1>或<3>留言</3>","你被移出了黑名单":"你被移出了黑名单","表情":"表情","发送图片":"发送图片","发送文件":"发送文件","评价":"评价","好评":"好评","中评":"中评","差评":"差评","请填写评价内容（选填）":"请填写评价内容（选填）","你给出了":"你给出了","下载":"下载","接下来由<1>{{name}}</1>为您服务":"接下来由<1>{{name}}</1>为您服务","客服软件由美洽提供":"客服软件由美洽提供","转人工":"转人工","免费通话":"免费通话","欢迎使用完全免费的网页回呼与我们通话":"欢迎使用完全免费的网页回呼与我们通话","请输入你的电话号码":"请输入你的电话号码","开始免费通话":"开始免费通话","请保持电话畅通，客服人员即将致电":"请保持电话畅通，客服人员即将致电","你将接到「010-52729285」的来电":"你将接到「010-52729285」的来电","询前表单":"询前表单","获取验证码失败":"获取验证码失败","加载历史消息":"加载历史消息","加载更多历史消息":"加载更多历史消息","没有更多了":"没有更多了","加载中...":"加载中...","排队失败，请刷新重试":"排队失败，请刷新重试","抱歉没能理解您的提问，可选择":"抱歉没能理解您的提问，可选择","留言":"留言","评价失败，请稍后重试":"评价失败，请稍后重试","美洽客服消息":"美洽客服消息","管理员":"管理员","[推广消息]":"[推广消息]","「发来了一个文件」":"「发来了一个文件」","「发来了一张图片」":"「发来了一张图片」","新消息":"新消息","粘贴图片失败，请用「图片按钮」上传图片":"粘贴图片失败，请用「图片按钮」上传图片","排队等待中...":"排队等待中...","正在为您转接，请稍候..":"正在为您转接，请稍候..","小时":"小时","分钟":"分钟","秒":"秒","网络错误，请稍后重试":"网络错误，请稍后重试","请控制":"请控制","在1到100个字符":"在1到100个字符","请填写必填字段":"请填写必填字段","请选择":"请选择","请输入验证码":"请输入验证码","加载询前表单失败，请稍后重试":"加载询前表单失败，请稍后重试","连接已断开，请刷新页面":"连接已断开，请刷新页面","很抱歉您对此回答不满意":"很抱歉您对此回答不满意","提交失败，请稍候再试":"提交失败，请稍候再试","请正确填写手机或带区号的座机号码":"请正确填写手机或带区号的座机号码","请正确填写验证码":"请正确填写验证码","请选择分类":"请选择分类","请正确填写姓名":"请正确填写姓名","请正确填写手机号":"请正确填写手机号","请正确填写联系邮箱":"请正确填写联系邮箱","请正确填写微信":"请正确填写微信","请正确填写QQ":"请正确填写QQ","请至少填写一项联系方式":"请至少填写一项联系方式","请保持留言内容在 1～1024 字符内":"请保持留言内容在 1～1024 字符内","留言失败，请稍候再试":"留言失败，请稍候再试","取消上传":"取消上传","上传失败":"上传失败","上传成功":"上传成功","只能发送图片哦":"只能发送图片哦","只能发送小于 50MB 的文件哦":"只能发送小于 50MB 的文件哦","最多只能发送 2048 个字符哦":"最多只能发送 2048 个字符哦","请选择评价等级":"请选择评价等级","最多只能发送 30 个字符哦":"最多只能发送 30 个字符哦","抱歉，客服系统暂时无法使用":"抱歉，客服系统暂时无法使用","当前等待人数":"当前等待人数","如果等不及，可以选择":"如果等不及，可以选择","上传中":"上传中","已过期":"已过期","{{expireTime}}后过期":"{{expireTime}}后过期","解决":"解决","未解决":"未解决","提交中":"提交中","已反馈":"已反馈","服务连接中，请稍候…":"服务连接中，请稍候…","请至少填写一项":"请至少填写一项","您已成功提交":"您已成功提交","机器人":"机器人"}')},459:function(e,t,n){e.exports=n.p+"static/icon-desktop@2x.png"},460:function(e,t,n){e.exports=n.p+"static/icon-mobile@2x.png"},461:function(e,t,n){e.exports=n.p+"static/icon-mq-round@2x.png"},466:function(e,t,n){e.exports=n.p+"static/emoji@2x.png"},468:function(e,t,n){e.exports=n.p+"static/new-chat.ogg"},469:function(e,t,n){e.exports=n.p+"static/new-chat.mp3"},470:function(e,t,n){e.exports=n.p+"static/new-message.ogg"},471:function(e,t,n){e.exports=n.p+"static/new-message.mp3"},472:function(e,t,n){e.exports=n.p+"static/sent-message.ogg"},473:function(e,t,n){e.exports=n.p+"static/sent-message.mp3"},474:function(e,t,n){e.exports=n.p+"static/invite-bgi-2.png"},475:function(e,t,n){e.exports=n.p+"static/invite-bgi-3.png"},476:function(e,t,n){e.exports=n.p+"static/invite-bgi-4.png"},478:function(e,t,n){n(479),e.exports=n(799)},795:function(e,t,n){var a={"./af":318,"./af.js":318,"./ar":319,"./ar-dz":320,"./ar-dz.js":320,"./ar-kw":321,"./ar-kw.js":321,"./ar-ly":322,"./ar-ly.js":322,"./ar-ma":323,"./ar-ma.js":323,"./ar-sa":324,"./ar-sa.js":324,"./ar-tn":325,"./ar-tn.js":325,"./ar.js":319,"./az":326,"./az.js":326,"./be":327,"./be.js":327,"./bg":328,"./bg.js":328,"./bm":329,"./bm.js":329,"./bn":330,"./bn.js":330,"./bo":331,"./bo.js":331,"./br":332,"./br.js":332,"./bs":333,"./bs.js":333,"./ca":334,"./ca.js":334,"./cs":335,"./cs.js":335,"./cv":336,"./cv.js":336,"./cy":337,"./cy.js":337,"./da":338,"./da.js":338,"./de":339,"./de-at":340,"./de-at.js":340,"./de-ch":341,"./de-ch.js":341,"./de.js":339,"./dv":342,"./dv.js":342,"./el":343,"./el.js":343,"./en-SG":344,"./en-SG.js":344,"./en-au":345,"./en-au.js":345,"./en-ca":346,"./en-ca.js":346,"./en-gb":347,"./en-gb.js":347,"./en-ie":348,"./en-ie.js":348,"./en-il":349,"./en-il.js":349,"./en-nz":350,"./en-nz.js":350,"./eo":351,"./eo.js":351,"./es":352,"./es-do":353,"./es-do.js":353,"./es-us":354,"./es-us.js":354,"./es.js":352,"./et":355,"./et.js":355,"./eu":356,"./eu.js":356,"./fa":357,"./fa.js":357,"./fi":358,"./fi.js":358,"./fo":359,"./fo.js":359,"./fr":360,"./fr-ca":361,"./fr-ca.js":361,"./fr-ch":362,"./fr-ch.js":362,"./fr.js":360,"./fy":363,"./fy.js":363,"./ga":364,"./ga.js":364,"./gd":365,"./gd.js":365,"./gl":366,"./gl.js":366,"./gom-latn":367,"./gom-latn.js":367,"./gu":368,"./gu.js":368,"./he":369,"./he.js":369,"./hi":370,"./hi.js":370,"./hr":371,"./hr.js":371,"./hu":372,"./hu.js":372,"./hy-am":373,"./hy-am.js":373,"./id":374,"./id.js":374,"./is":375,"./is.js":375,"./it":376,"./it-ch":377,"./it-ch.js":377,"./it.js":376,"./ja":378,"./ja.js":378,"./jv":379,"./jv.js":379,"./ka":380,"./ka.js":380,"./kk":381,"./kk.js":381,"./km":382,"./km.js":382,"./kn":383,"./kn.js":383,"./ko":384,"./ko.js":384,"./ku":385,"./ku.js":385,"./ky":386,"./ky.js":386,"./lb":387,"./lb.js":387,"./lo":388,"./lo.js":388,"./lt":389,"./lt.js":389,"./lv":390,"./lv.js":390,"./me":391,"./me.js":391,"./mi":392,"./mi.js":392,"./mk":393,"./mk.js":393,"./ml":394,"./ml.js":394,"./mn":395,"./mn.js":395,"./mr":396,"./mr.js":396,"./ms":397,"./ms-my":398,"./ms-my.js":398,"./ms.js":397,"./mt":399,"./mt.js":399,"./my":400,"./my.js":400,"./nb":401,"./nb.js":401,"./ne":402,"./ne.js":402,"./nl":403,"./nl-be":404,"./nl-be.js":404,"./nl.js":403,"./nn":405,"./nn.js":405,"./pa-in":406,"./pa-in.js":406,"./pl":407,"./pl.js":407,"./pt":408,"./pt-br":409,"./pt-br.js":409,"./pt.js":408,"./ro":410,"./ro.js":410,"./ru":411,"./ru.js":411,"./sd":412,"./sd.js":412,"./se":413,"./se.js":413,"./si":414,"./si.js":414,"./sk":415,"./sk.js":415,"./sl":416,"./sl.js":416,"./sq":417,"./sq.js":417,"./sr":418,"./sr-cyrl":419,"./sr-cyrl.js":419,"./sr.js":418,"./ss":420,"./ss.js":420,"./sv":421,"./sv.js":421,"./sw":422,"./sw.js":422,"./ta":423,"./ta.js":423,"./te":424,"./te.js":424,"./tet":425,"./tet.js":425,"./tg":426,"./tg.js":426,"./th":427,"./th.js":427,"./tl-ph":428,"./tl-ph.js":428,"./tlh":429,"./tlh.js":429,"./tr":430,"./tr.js":430,"./tzl":431,"./tzl.js":431,"./tzm":432,"./tzm-latn":433,"./tzm-latn.js":433,"./tzm.js":432,"./ug-cn":434,"./ug-cn.js":434,"./uk":435,"./uk.js":435,"./ur":436,"./ur.js":436,"./uz":437,"./uz-latn":438,"./uz-latn.js":438,"./uz.js":437,"./vi":439,"./vi.js":439,"./x-pseudo":440,"./x-pseudo.js":440,"./yo":441,"./yo.js":441,"./zh-cn":442,"./zh-cn.js":442,"./zh-hk":443,"./zh-hk.js":443,"./zh-tw":444,"./zh-tw.js":444};function o(e){var t=i(e);return n(t)}function i(e){if(n.o(a,e))return a[e];var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return Object.keys(a)},o.resolve=i,(e.exports=o).id=795},799:function(e,t,n){"use strict";n.r(t);var ue=n(0),pe=n.n(ue),a=n(84),o=n(6),d=n(1),R=n(13),me=n(10),i={en:{translation:n(450)},tw:{translation:n(451)},cn:{translation:n(452)}};R.a.use(me.b).init({lng:"cn",fallbackLng:"cn",resources:i,debug:!1,interpolation:{escapeValue:!1},react:{wait:!0},keySeparator:"::"});var r=function(){var e=window.parent.document,t=e.createElement("div");if(t.id="meiqia-container",e.getElementById("meiqia-container")){var n=e.getElementById("meiqia-container");n.parentElement.removeChild(n),e.body.appendChild(t)}else e.body.appendChild(t);return t},c=n(74),u=n.n(c),l=n(94),p=n.n(l),s=n(11),m=n.n(s),f=(n(208),n(79),n(802)),h=n(803),L=n(17),g=n(14),b=n.n(g),v=n(15),_=n.n(v),w=n(8),y=n.n(w),x=n(9),k=n.n(x),E=n(7),I=n.n(E),C=n(12),T=n.n(C),S={defaults:"https://new-api.meiqia.com",public:"https://static.meiqia.com/widget/",qcloud:"https://s3-qcloud.meiqia.com",socket:"https://camorope-client-a.meiqia.com/pusher"},j=n(85),V=n.n(j);function N(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):N(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}function M(e,a){var o=O({},e);return o.baseURL||(o.baseURL=S.defaults),new V.a(function(t,n){window.parent.meiqia.event.emit(a,{data:o,success:function(e){t(JSON.parse(e))},error:function(e){n(e)}})})}var fe=function(e){var a=O({},e);return new V.a(function(t,n){a.baseURL||(a.baseURL=S.defaults),window.parent.meiqia.event.emit("request",{data:a,success:function(e){t(JSON.parse(e))},error:function(e){n(e)}})})};function D(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function he(e,t,n,a,o,i){return!!o&&fe({url:"client/attrs_jsonp",method:"jsonp",callbackParamName:"jsonp_cb",jsonp:"jsonp_cb",params:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):D(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({ent_id:e,track_id:t,visit_id:n,browser_id:a},5<arguments.length&&void 0!==i?i:{},{attrs:u()(o)})})}function z(e,t){return e.className.match(new RegExp("(\\s|^)".concat(t,"(\\s|$)")))}function B(e){var t=window.parent.document.querySelector("iframe[name=chat]").contentWindow.document,n=t.getElementById(ne);e.target!==n?setTimeout(function(){if(window.focus(),n.blur(),X.isUC()){var e=document.createElement("input");e.type="text",e.style.visible="hidden",e.style.position="absolute",e.style.right="-999999px",n.parentNode.appendChild(e),e.focus(),e.remove()}t.removeEventListener("touchstart",B,!1),t.removeEventListener("touchend",B,!1)},200):window.focus()}function P(){var e=window.parent.document.querySelector("iframe[name=chat]").contentWindow.document;e.addEventListener("touchstart",B,!1),e.addEventListener("touchend",B,!1)}var A=Object(f.a)({SET_ROUTER:function(e){return e},SET_ROUTER_BUTTON_VISIBLE:function(e){return e},SET_ROUTER_WIDGET_VISIBLE:function(e){return e},SET_BUBBLE_VISIBLE:function(e){return e},SET_INVITE_VISIBLE:function(e){return e},SET_SMART_GUIDE_VISIBLE:function(e){return e}}),q=A.setRouter,U=A.setRouterButtonVisible,F=A.setRouterWidgetVisible,W=A.setBubbleVisible,G=A.setInviteVisible,H=A.setSmartGuideVisible,Q=Object(h.a)({SET_ROUTER:function(e,t){return e.merge(t.payload)},SET_ROUTER_BUTTON_VISIBLE:function(e,t){return e.set("showButton",t.payload)},SET_ROUTER_WIDGET_VISIBLE:function(e,t){var n;return n=t.payload?{showWidget:!0,showInvite:!1,showButton:!1,showCallback:!1,showBubble:!1,showSmartGuide:!1}:{showWidget:!1},e.merge(n)},SET_BUBBLE_VISIBLE:function(e,t){return e.showWidget&&t.payload?e.set("showBubble",!1):e.set("showBubble",t.payload)},SET_INVITE_VISIBLE:function(e,t){return e.set("showInvite",t.payload)},SET_SMART_GUIDE_VISIBLE:function(e,t){return e.get("showWidget")&&t.payload?e.set("showSmartGuide",!1):e.set("showSmartGuide",t.payload)}},Object(L.fromJS)({showWidget:!1,widgetContent:"",buttonActived:"",showInvite:!1,showButton:!1,showCallback:!1,showBubble:!1,showSmartGuide:!1,alertVisible:!1,alertConfig:{}})),Y=n(110),$=n.n(Y),J=n(18),K=n.n(J),Z=(n(132),n(156),window),X={isMobile:function(){var e=!1,t=(navigator.userAgent||navigator.vendor||Z.opera).toLowerCase();return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4)))&&(e=!0),e},isThisDevice:function(e){return 0<=(navigator.userAgent||navigator.vendor||Z.opera).toLowerCase().indexOf(e.toLowerCase())},isSafari:function(){var e=navigator.userAgent.toLowerCase();return/safari/.test(e)&&!/(chrome|crios|qqbrowser|baidu)/.test(e)},isUC:function(){var e=navigator.userAgent.toLowerCase();return/ucbrowser/.test(e)},isIE:function(e){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("msie")&&K()(t.split("msie")[1],10)===e},iOSversion:function(){var e=(navigator.userAgent||navigator.vendor||Z.opera).toLowerCase();if(/ip(hone|od|ad)/.test(e)){var t=e.match(/os (\d+)_(\d+)_?(\d+)?/);return+[K()(t[1],10),K()(t[2],10),K()(t[3]||0,10)].join("")}return null},isWechatMiniprogram:function(){return navigator.userAgent.match(/miniprogram/i)||"miniprogram"===window.__wxjs_environment}},ee=(n(52),n(152),function(e,t){var n=e;z(e,t)||(n.className+=" ".concat(t))}),te=function(e,t){var n=e;if(z(e,t)){var a=new RegExp("(\\s|^)".concat(t,"(\\s|$)"));n.className=e.className.replace(a,"")}},ne="_MEIQIA_INPUT",ae={wxScroll:function(){window.parent.scrollTo()},fixIOSBlur:function(){var t=window.parent.document.querySelector("iframe[name=chat]").contentWindow.document;-1!==navigator.userAgent.toUpperCase().indexOf("IPHONE")&&function(){var e=t.getElementById(ne);if(!e)throw new Error("objBlur()没有找到元素");e.removeEventListener("focus",P,!1),e.addEventListener("focus",P,!1)}()},fixedBody:function(){if(X.isMobile()){var e=window.parent.document,t=e.body.scrollTop||e.documentElement.scrollTop;ee(e.body,"_MEIQIA_FIX_BODY"),e.body.style.cssText+="top:-".concat(t,"px;")}},looseBody:function(){if(X.isMobile()){var e=window.parent.document,t=e.body.style.top;te(e.body,"_MEIQIA_FIX_BODY"),e.body.scrollTop=-K()(t,10),e.documentElement.scrollTop=-K()(t,10),e.body.style.top=""}},fixInput:function(){var e=window.parent.document,t=window.parent.screen.height,n=e.querySelector("iframe[name=chat]").contentWindow.document.getElementById(ne);return!X.isMobile()||X.isThisDevice("android")||(X.isUC()&&ae.fixIOSBlur(),1300<=(X.iOSversion()||0)||(X.isSafari()?setTimeout(function(){812<t&&window.parent.scrollTo(0,330)},100):X.isUC()?setTimeout(function(){n.scrollIntoView(!0)},100):setTimeout(function(){window.parent.scrollTo(0,400)},100))),null}},ge=ae,oe=(n(90),n(19)),ie=n.n(oe),re=n(36),ce=n.n(re);n(205),n(30),n(269);function le(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?le(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):le(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}function de(t,e,n){function a(e){switch(e){case"source":return t.source_url;case"landing":return t.landing_url;case"visiting":return window.parent.document.location.href;case"returning":return 1<t.visit_cnt?"1":"0";case"keyword":return t.keyword?"1":"0";default:return null}}function o(e,t,n){switch(t){case 1:return e===n;case 2:return e!==n;case 7:return new RegExp(n).test(e);case 8:return!new RegExp(n).test(e);case 9:return new RegExp("^".concat(n)).test(e);case 10:return new RegExp("".concat(n,"$")).test(e);default:return!1}}return n?e.every(function(e){return o(a(e.name),e.op,e.val)}):e.some(function(e){return o(a(e.name),e.op,e.val)})}function be(){var e=window.sessionStorage;e.removeItem("MEIQIA-SMART-GUIDE-ID"),e.removeItem("MEIQIA-SMART-GUIDE-COUNT"),e.removeItem("MEIQIA-SMART-GUIDE-TIMEOUT"),e.removeItem("MEIQIA-SMART-GUIDE-NEVER")}function ve(e,t){var n=1<arguments.length&&void 0!==t?t:"",a=e.keyword,o=window.parent.document.title;return n.replace(/\{\{\s*replace\.(searchKeyWord|documentTitle)\s*(\|\s*'(.*?)'\s*)?\}\}/g,function(){switch(arguments.length<=1?void 0:arguments[1]){case"searchKeyWord":return a||(arguments.length<=3?void 0:arguments[3])||"";case"documentTitle":return o||(arguments.length<=3?void 0:arguments[3])||"";default:return arguments.length<=0?void 0:arguments[0]}})}function _e(e,t){var n=se({},e,{agentId:e.sender_id,agentName:e.sender_name,avatar:e.sender_avatar,frequency:e.push_rate,gap:e.gap_second,nodes:function(t,e){return(1<arguments.length&&void 0!==e?e:[]).map(function(e){return se({},e,{node_body:e.node_body.map(function(e){return"message"===e.type?se({},e,{content:ve(t,e.content)}):e})})})}(t,e.nodes)}),a="";return a=X.isMobile()?e.greetings_phone_content:e.greetings_pc_content,n.html=ve(t,a),n}function we(e){var t=e(),n=t.get("smartGuide"),o=X.isMobile(),i=n.get("visitorInfo"),r=t.getIn(["config","servability"]),a=(t.getIn(["config","agentOnline"]),n.get("templates")),c=[];return(a=a.filter(function(e){if(e.push_time){if("online"===e.push_time&&!r)return!1;if("offline"===e.push_time&&r)return!1}else{var t=function(){var e=new Date,t=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0"),a=e.getSeconds().toString().padStart(2,"0");return"".concat(t,":").concat(n,":").concat(a)}(),n=e.push_begin_time,a=e.push_end_time;if(t<n||a<t)return!1}return(1!==e.push_platform||!o)&&(!(2===e.push_platform&&!o)&&(2!==e.push_visitor_type||!i.clue))})).forEach(function(e){var t=!0;3===e.push_visitor_type&&(t=de(i,e.visitor_rules,1===e.work_rule)),t&&c.push(e)}),0<c.length&&(c=c.sort(function(e,t){return t.created_at-e.created_at}).sort(function(e,t){return(e.index||0)-(t.index||0)})),c[0]?c[0].id:null}var ye=0,xe=null,ke=Object(f.a)({SET_SMART_GUIDE:function(e){return e},MATCH_TEMPLATE:function(e,t){var n=window.sessionStorage.getItem("MEIQIA-SMART-GUIDE-ID"),a=we(t);return n!==a&&be(),a&&(window.sessionStorage.setItem("MEIQIA-SMART-GUIDE-ID",a),e(Ce(e,t,a))),{selectedTemplate:a,visitorInfo:{visiting_url:window.parent.location.href}}},GET_TEMPLATE_DETAIL:function(t,n,e){var a=n(),o=a.get("config"),i=o.get("entId"),r=o.get("trackId"),c=a.getIn(["smartGuide","visitorInfo"]);return function(e,t,n){return fe({url:"/mpush/widget/templates",method:"get",params:{template_id:n,ent_id:e,track_id:t}})}(i,r,e).then(function(e){if(e.data)t(Ee({templateDetail:_e(e.data.data,c)})),t(Te(t,n,!0));else if(e.code)switch(e.code){case 5:return be(),void(ye<2&&(ye+=1,t(function(e,t){return e(Ie(e,t))})));default:be()}}),null},TOGGLE_SMART_GUIDE:function(e,t,n){var a=t(),o=a.get("router").get("showWidget"),i=a.get("smartGuide"),r=a.getIn(["message","chatHasEnd"]),c=a.getIn(["queue","inQueue"]),l=i.get("selectedTemplate");return!1===r||!l||o||c||!1===i.get("enabled")?(be(),clearInterval(xe),e(H(!1)),!1):(n?function(n,e){var a=window.sessionStorage,t=e().get("smartGuide"),o=t.get("templateDetail"),i=t.get("refreshFlag"),r=o.frequency,c=o.gap;if(1===r)!function(){var e=+a.getItem("MEIQIA-SMART-GUIDE-COUNT"),t=+a.getItem("MEIQIA-SMART-GUIDE-TIMEOUT");e&&t&&0!==c?(ce()()>=t&&(t=ce()()+1e3*c,a.setItem("MEIQIA-SMART-GUIDE-TIMEOUT",t)),clearInterval(xe),xe=setInterval(function(){ce()()>t&&(clearInterval(xe),a.removeItem("MEIQIA-SMART-GUIDE-TIMEOUT"),a.setItem("MEIQIA-SMART-GUIDE-COUNT",1+e),n(H(!0)))},1e3)):(n(H(!0)),a.setItem("MEIQIA-SMART-GUIDE-COUNT",1))}();else if(2===r)i||(n(Ee({refreshFlag:!0})),n(H(!0)));else{var l=a.getItem("MEIQIA-SMART-GUIDE-NEVER");n(H(!l))}}(e,t):function(e,t){var n=window.sessionStorage,a=t().get("smartGuide"),o=a.get("templateDetail"),i=a.get("selectedTemplate"),r=o.frequency,c=o.gap;1===r&&i?n.setItem("MEIQIA-SMART-GUIDE-TIMEOUT",ce()()+1e3*c):3===r&&n.setItem("MEIQIA-SMART-GUIDE-NEVER",1);e(H(!1)),e(Te(e,t,!0))}(e,t),{})},PUSH_SMART_GUIDE_QUEUE:function(e,t){return{msg:e,clear:t}},REMOVE_SMART_GUIDE_MSG:function(e){return e}}),Ee=ke.setSmartGuide,Ie=ke.matchTemplate,Ce=ke.getTemplateDetail,Te=ke.toggleSmartGuide,Se=ke.pushSmartGuideQueue,je=ke.removeSmartGuideMsg;function Ne(e){return window.parent.document.querySelector("#meiqia-container iframe[name=".concat(e,"]"))}function Oe(){if(We&&Fe)try{var e=Ne(We);He(e,We),Fe.addEventListener("mousedown",Qe,!1),Fe.addEventListener("mousemove",Ye,!1),Fe.addEventListener("mouseup",$e,!1),Fe.addEventListener("click",Je,!1),Fe.style.display="block"}catch(e){console.log(e)}}var Me=Object(h.a)({SET_SMART_GUIDE:function(e,t){return e.merge(t.payload)},MATCH_TEMPLATE:function(e,t){return e.mergeDeep(t.payload)},GET_TEMPLATE_DETAIL:function(e,t){return e.mergeDeep(t.payload)},TOGGLE_SMART_GUIDE:function(e){return e},PUSH_SMART_GUIDE_QUEUE:function(e,t){var n=ie()(e.get("queue"));return t.payload.clear?n=[t.payload.msg]:n.push(t.payload.msg),e.set("queue",n)},REMOVE_SMART_GUIDE_MSG:function(e,t){var n=ie()(e.get("queue")),a=n.findIndex(function(e){return e.id===t.payload});return n.splice(a,1),e.set("queue",n)}},Object(L.Map)({enabled:!1,visitorInfo:{},templates:[],selectedTemplate:null,templateDetail:{},refreshFlag:!1,queue:[],templateActive:!1})),De="",ze=function(e){var t=window.parent.document,n="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no";if("init"===e){var a=t.getElementsByName("viewport")[0],o=a&&a.getAttribute("content");a&&o&&(De=-1!==o.indexOf("width=device-width")&&-1!==o.indexOf("initial-scale=1.0")&&-1!==o.indexOf("minimum-scale=1.0")&&-1!==o.indexOf("maximum-scale=1.0")&&-1!==o.indexOf("user-scalable=no")?"same":o)}else if("set"===e)if(De)"same"!==De&&t.getElementsByName("viewport")[0].setAttribute("content",n);else{var i=t.createElement("meta");i.name="viewport",i.content=n,t.getElementsByTagName("head")[0].appendChild(i)}else if("remove"===e){var r=t.getElementsByName("viewport")[0];r&&(De?"same"!==De&&r.setAttribute("content",De):r.parentElement.removeChild(t.getElementsByName("viewport")[0]))}},Be=null,Pe=function(){return Be},Ae=n(178),qe=n.n(Ae),Re=n(16),Le=n.n(Re),Ue=null,Fe=null,We="",Ge=!1,Ve={x:0,y:0,px:0,py:0},He=function(e,t){var n="_meiqia_drag_handler_".concat(t);(Fe=window.parent.document.getElementById(n))&&Fe.parentNode.removeChild(Fe),(Fe=window.parent.document.createElement("div")).id=n;var a=window.parent.getComputedStyle(e);Le()(Fe.style,{position:a.position,"z-index":a.zIndex,top:a.top,left:"".concat(qe()(a.left)+130,"px"),width:"400px",height:"60px",cursor:"move","user-select":"none",transform:a.transform,display:a.display}),e.parentNode.appendChild(Fe)},Qe=function(e){e.stopPropagation(),Ue=Ne(We),Ve.x=Ue.offsetLeft,Ve.y=Ue.offsetTop,Ve.px=Ge?e.touches[0].screenX:e.screenX,Ve.py=Ge?e.touches[0].screenY:e.screenY,Ue&&Fe&&(Fe.style.width="100%",Fe.style.height="100%",Fe.style.top=0,Fe.style.bottom=0,Fe.style.left=0,Fe.style.right=0,Fe.style.transform="")},Ye=function(e){if(e.preventDefault(),e.stopPropagation(),Ue){var t=Ge?e.touches[0].screenX:e.screenX,n=Ge?e.touches[0].screenY:e.screenY,a=Ve.x+(t-Ve.px),o=Ve.y+(n-Ve.py);Ue.style.setProperty("left","".concat(a,"px"),"important"),Ue.style.setProperty("top","".concat(o,"px"),"important")}},$e=function(e){e.stopPropagation(),Ge||Oe(),Ue=Ue&&null},Je=function(e){var t=e.screenX,n=e.screenY;(3<Math.abs(t-Ve.px)||3<Math.abs(n-Ve.py))&&e.stopPropagation(),Ue&&(Ue=null,Le()(Ve,{x:0,y:0,px:0,py:0}))},Ke={register:function(e,t,n){if(e&&t)if(We=t,Ge=n)e.addEventListener("touchstart",Qe,!1),e.addEventListener("touchmove",Ye,!1),e.addEventListener("touchend",$e,!1),e.addEventListener("click",Je,!1);else{var a=Ne(We);He(a,We),Fe.addEventListener("mousedown",Qe,!1),Fe.addEventListener("mousemove",Ye,!1),Fe.addEventListener("mouseup",$e,!1),Fe.addEventListener("click",Je,!1),window.parent.addEventListener("resize",Oe)}},unregister:function(e,t){t?(e.removeEventListener("touchstart",Qe,!1),e.removeEventListener("touchmove",Ye,!1),e.removeEventListener("touchend",$e,!1),e.removeEventListener("click",Je,!1)):Fe&&(Fe.removeEventListener("mousedown",Qe,!1),Fe.removeEventListener("mousemove",Ye,!1),Fe.removeEventListener("mouseup",$e,!1),Fe.removeEventListener("click",Je,!1),window.parent.removeEventListener("resize",Oe),Fe.style.display="none",Fe=null)},updatePosition:Oe,resetPosition:function(){Fe&&(Fe.style.display="none")}},Ze=function(e,t,n){try{var a=window.parent.localStorage;if("get"===e)return a.getItem(t);"set"===e?a.setItem(t,n):"remove"===e&&a.removeItem(t)}catch(e){return null}return null},Xe=function(e){for(var t,n=window.parent.meiqia,a=arguments.length,o=new Array(1<a?a-1:0),i=1;i<a;i++)o[i-1]=arguments[i];(t=n.event).emit.apply(t,[e].concat(o))};var et=function(e,t){var n=Pe().getState().get("config");try{var a="unreadMsg-".concat(n.get("entId"),"-").concat(n.get("trackId"));if("get"===e)return Ze("get",a);if("set"===e){var o=Ze("get",a);if(o){try{o=JSON.parse(o)}catch(e){o=[]}o=u()(function(e){for(var t=0;t<e.length;t+=1)for(var n=t+1;n<e.length;n+=1)e[t].id===e[n].id&&e.splice(n-=1,1);return e}(o.concat(t)))}else o=u()(t);Ze("set",a,o)}else"remove"===e&&Ze("remove",a)}catch(e){return null}return null},tt=n(38),nt=n.n(tt);function at(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}var ot=Object(f.a)({SET_MESSAGE:function(e){return e},PUSH_QUEUE:function(e){return e},SETIN_QUEUE:function(e,t){return{index:e,value:t}},REPLACE_MSG:function(e,t){return{id:e,msg:t}},DELETE_MSG:function(e){return e},SET_MSG_DATA:function(e,t){return{id:e,data:t}},PUSH_FAKE:function(e){return e},SET_UNREAD:function(e){return e},REMOVE_UNREAD:function(e){return e},RING:function(e){return e},TOGGLE_RING:function(e){return e},SET_CONV_STATUS:function(e){return e},SET_INVITE_FROM:function(e){return e},SET_CONV_TYPE:function(e){return e},SET_INPUTTING:function(e){return e},SET_GREETING:function(e){return e}}),it=ot.setMessage,rt=ot.pushQueue,ct=(ot.setinQueue,ot.replaceMsg),lt=ot.deleteMsg,st=ot.setMsgData,dt=ot.pushFake,ut=ot.setUnread,pt=ot.removeUnread,mt=ot.ring,ft=ot.toggleRing,ht=ot.setConvStatus,gt=ot.setInviteFrom,bt=ot.setConvType,vt=ot.setInputting,_t=ot.setGreeting,wt=Object(h.a)({SET_MESSAGE:function(e,t){return e.merge(t.payload)},PUSH_QUEUE:function(e,t){var n=nt()(t.payload)?t.payload:[t.payload],a=[].concat(ie()(e.get("queue")),ie()(n));return e.merge({queue:a})},SETIN_QUEUE:function(e,t){var n=e.get("queue"),a=t.payload,o=a.index,i=a.value;return n=[].concat(ie()(n.slice(0,o)),[i],ie()(n.slice(o))),e.merge({queue:n})},REPLACE_MSG:function(e,t){var n=e.get("queue"),a=t.payload,o=a.id,i=a.msg,r=n.findIndex(function(e){return e.id===o});return-1!==r&&(n=[].concat(ie()(n.slice(0,r)),[i],ie()(n.slice(r+1)))),e.merge({queue:n})},DELETE_MSG:function(e,t){var n=ie()(e.get("queue")),a=t.payload,o=n.findIndex(function(e){return e.id===a});return-1!==o&&n.splice(o,1),e.merge({queue:n})},SET_MSG_DATA:function(e,t){var n=e.get("queue"),a=t.payload,o=a.id,i=a.data,r=n.findIndex(function(e){return e.id===o});if(-1!==r){var c=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?at(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):at(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},n[r],{},i);n=[].concat(ie()(n.slice(0,r)),[c],ie()(n.slice(r+1)))}return e.merge({queue:n})},PUSH_FAKE:function(e,t){var n=nt()(t.payload)?t.payload:[t.payload],a=[].concat(ie()(e.get("fakeMsg")),ie()(n));return e.merge({fakeMsg:a})},SET_UNREAD:function(e,t){var n=e.get("unReadCount"),a=nt()(t.payload)?t.payload:[t.payload],o=a[a.length-1];return Xe("getUnreadMsg",a),e.merge({unReadMsg:o,unReadCount:n+a.length})},REMOVE_UNREAD:function(e){return Xe("getUnreadMsg","hasBeenRead"),e.merge({unReadMsg:null,unReadCount:0})},RING:function(e,t){return e.merge({ringing:!0,ringType:t.payload})},TOGGLE_RING:function(e,t){return e.merge({ringEnabled:t.payload})},SET_CONV_STATUS:function(e,t){return e.set("chatHasEnd",!t.payload)},SET_INVITE_FROM:function(e,t){var n=e;if("auto"===e.get("inviteType")){var a="customer"===t.payload?"sys_invite_cutomer_accept":"sys_invite_sys_accept";return"auto"===t.payload&&(n=n.set("convType","autoInvite")),n.set("inviteFrom",a)}if("manual"!==e.get("inviteType"))return n;var o="customer"===t.payload?"agent_invite_cutomer_accept":"agent_invite_sys_accept";return(n=n.set("convType","manualInvite")).set("inviteFrom",o)},SET_CONV_TYPE:function(e,t){return e.set("convType",t.payload)},SET_INPUTTING:function(e,t){return e.set("inputting",t.payload)},SET_GREETING:function(e,t){var n=t.payload,a=n.greeting,o=n.assign,i=e.get("agentToken"),r=e.get("groupToken"),c=ie()(e.get("fakeMsg"));return o.agentToken&&i!==o.agentToken||o.groupToken&&r!==o.groupToken||!e.get("scheduler")?(a&&"string"==typeof a&&c.push({id:Math.random(),from_type:"client",content_type:"text",content:a}),e.merge({fakeMsg:c,greeting:a,schedulerMsg:!0,scheduler:!1})):e}},Object(L.Map)({entWelcomeMessage:"",convId:"",convType:"",unableToServe:!1,scheduler:!1,isBot:!1,lastMsgDate:null,evaluationActive:!1,reserveToken:null,chatHasEnd:null,schedulerMsg:!1,visitorStatus:0,enterpriseInfo:{},schedulerAfterClientSendMsg:!1,noMsgFilter:!1,hasSendPromotion:!1,promotionMsgs:{},inputting:!1,inviteType:"",inviteFrom:"",ringEnabled:!0,ringing:!1,ringType:"",fileEnabled:!1,unReadMsg:null,unReadCount:0,unReadPreview:!1,autoFit:[],autoFitSelected:-1,blacklist:!1,showHistoryBtn:!1,historyLoading:!1,msgLoadLimit:10,historyArray:[],historyTimes:0,agent:null,agentToken:null,groupToken:null,agentInfo:{},agentInputing:!1,assign:{},fakeMsg:[],surveyMsg:null,queue:[]}));function yt(e,t){var n=1<arguments.length&&void 0!==t?t:"chat",a=Pe();Ze("set","MEIQIA_PANEL_VISIBILITY",e?"visible":"hidden");var o=a.getState(),i=a.dispatch;e?(ge.fixedBody(),X.isMobile()?ze("set"):setTimeout(function(){Ke.updatePosition()},500),et("remove"),i(pt()),i(q({buttonActived:n})),i(F(!0)),Xe("getPanelVisibility","visible")):(o.getIn(["config","withoutBtn"])||i(q({showButton:!0})),ge.looseBody(),X.isMobile()?ze("remove"):Ke.resetPosition(),i(F(!1)),Xe("getPanelVisibility","invisible"),i(function(e,t){return Te(e,t,!0)}))}var xt,kt,Et;function It(e){var t=Pe();setTimeout(function(){t.dispatch(q({widgetContent:e}))},0)}function Ct(e,t){clearTimeout(xt),clearTimeout(kt),clearTimeout(Et);var n=t(),a=n.get("invite"),o=n.get("config");if(e(G(!1)),function(e,t,n){fe({url:"/visit/".concat(e,"/").concat(t,"/reject"),method:"post",headers:{"content-type":"application/json"},data:{browser_id:n}})}(o.get("entId"),o.get("trackId"),o.get("browserId")),"auto"===n.getIn(["message","inviteType"])&&"stop"===a.getIn(["auto","reject","type"])?window.sessionStorage.setItem("MEIQIA_AUTO_INVITE_REJECTED","1"):window.sessionStorage.removeItem("MEIQIA_AUTO_INVITE_REJECTED"),"close"!==a.getIn(["auto","status"])){var i=a.getIn(["auto","reject"]);if(i&&"again"===i.get("type")){var r=i.get("countdown");Et=setTimeout(function(){e(Mt(e,t,{inviteType:"auto"}))},1e3*r)}}}function Tt(e){var t=e.data,n=e.headers;return fe({url:"/client/tickets_v2",method:"post",headers:Le()({"content-type":"application/json"},n),data:t})}function St(e,t,n,a){return fe({url:"/client/history_conversation",method:"get",params:{ent_id:e,track_id:t,page:n,limit:a}})}var jt=Object(L.Map)({inviteType:""}),Nt=Object(f.a)({SET_INVITE:function(e){return e},AUTO_ACCEPT_INVITE:function(e,t,n){var a=t(),o=a.getIn(["invite","auto"]),i=a.getIn(["message","convId"]),r=a.getIn(["config","visitorStatus"]),c=a.getIn(["router","showWidget"]);if(i||c||4===r||(e(G(!0)),e(it(n))),o){var l=o.getIn(["accept","status"]),s=o.getIn(["accept","countdown"]);"open"!==l||i||c||(xt=setTimeout(function(){e(gt("auto")),yt(!0,"invite")},1e3*s))}return n},MANUAL_ACCEPT_INVITE:function(e,t,n){var a=t(),o=a.getIn(["invite","manual"]),i=a.getIn(["message","convId"]),r=a.getIn(["router","showWidget"]);if(i||r||(e(G(!0)),e(it(n))),o){var c=o.getIn(["accept","status"]),l=o.getIn(["accept","countdown"]);"open"!==c||i||r||(kt=setTimeout(function(){e(gt("auto")),yt(!0,"invite")},1e3*l))}return n}}),Ot=Nt.setInvite,Mt=Nt.autoAcceptInvite,Dt=Nt.manualAcceptInvite,zt=Object(h.a)({SET_INVITE:function(e,t){var n=Object(L.fromJS)(t.payload);return e.merge(n)},AUTO_ACCEPT_INVITE:function(e,t){var n=Object(L.fromJS)(t.payload);return e.merge(n)},MANUAL_ACCEPT_INVITE:function(e,t){var n=Object(L.fromJS)(t.payload);return e.merge(n)}},jt),Bt=function(e,t,n,a){return fe({url:"/client/timeline",method:"get",params:{ent_id:e,track_id:t,filter_type:n,dt:a}})},Pt=n(144),At=n(453),qt=n(454),Rt=n.n(qt),Lt=n(455),Ut=Object(L.Map)({isInit:!1,trackId:"",docLocation:"",docTitle:"",docReferrer:"",entId:"",fallback:3,metadata:null,clientId:"",disableBrandLink:!1,language:"zh",withoutBtn:!1,browserFamily:"",browserId:"",servability:!1,visitId:"",visitPageId:"",visitorStatus:"",visitorStatusAgentToken:"",standalone:!1,socket:!1,isReconnect:!1,stopReconnect:!1}),Ft=Object(f.a)({SET_CONFIG_DATA:function(e){return e}}).setConfigData,Wt=Object(h.a)({SET_CONFIG_DATA:function(e,t){return e.merge(t.payload)}},Ut),Gt=Object(f.a)({SET_THEME:function(e){return e},SET_LIMIT_BUTTON:function(e){return e}}),Vt=Gt.setTheme,Ht=Gt.setLimitButton,Qt=Object(h.a)({SET_THEME:function(e,t){return e.mergeDeep(t.payload)},SET_LIMIT_BUTTON:function(e,t){var n=t.payload||{mobile:{btn:{theme:"007aff",position:{horizontal:"20",type:"right",bottom:"20"},text:{offline:"",online:""},type:"round"}},desktop:{btn:{theme:"007aff",position:{horizontal:60,type:"right",bottom:"80"},text:{offline:"",online:""},type:"round"}}};return n.isLimitButton=!0,n.mobile.btn.text.offline=n.mobile.btn.text.online,n.desktop.btn.text.offline=n.desktop.btn.text.online,e.mergeDeep(n)}},Object(L.Map)({device:"mobile",isLimitButton:!1})),Yt=Object(f.a)({SET_TICKET:function(e){return e}}).setTicket,$t=Object(h.a)({SET_TICKET:function(e,t){return e.mergeDeep(t.payload)}},Object(L.Map)({showTicket:!1,captcha:"",category:"",contactRule:"",defaultTemplate:"",defaultTemplateContent:"",email:"",intro:"",name:"",permission:"",qq:"",tel:"",wechat:""})),Jt=Object(f.a)({SET_SURVEY:function(e){return e}}).setSurvey,Kt=Object(h.a)({SET_SURVEY:function(e,t){return e.merge(Object(L.fromJS)(t.payload))}},Object(L.fromJS)({status:"open",categoryStatus:"close",showSurvey:!0})),Zt=Object(f.a)({SET_EVALUATION:function(e){return e}}).setEvaluation,Xt=Object(h.a)({SET_EVALUATION:function(e,t){return e.merge(Object(L.fromJS)(t.payload))}},Object(L.fromJS)({agent_invitation:"close",agent_visible:"close",auto_invitation:"close",prompt_text:""})),en=Object(f.a)({SET_QUEUE:function(e){return e}}).setQueue,tn=Object(h.a)({SET_QUEUE:function(e,t){return e.merge(Object(L.fromJS)(t.payload))}},Object(L.fromJS)({inQueue:!1,intro:"",position:0,status:"normal"})),nn=Object(f.a)({SET_ROBOT:function(e){return e}}).setRobot,an=Object(h.a)({SET_ROBOT:function(e,t){return e.merge(t.payload)}},Object(L.fromJS)({})),on=Object(Lt.combineReducers)({config:Wt,theme:Qt,router:Q,ticket:$t,survey:Kt,invite:zt,evaluation:Xt,message:wt,queue:tn,robot:an,smartGuide:Me}),rn=[Rt.a,At.a],cn=Object(Pt.c)(on,Pt.a.apply(void 0,rn));Be=cn;var ln=cn,sn=function(e){var t=ln.getState(),n=ln.dispatch,a=t.get("message"),o={};return e&&(e.agentToken||e.groupToken)?(o.agentToken=e.agentToken||null,o.groupToken=e.groupToken||null):(o.agentToken=a.getIn(["assign","agentToken"])||null,o.groupToken=a.getIn(["assign","groupToken"])||null),n(it(o)),o},dn=(n(105),n(117),[]),un=function(e){return!(dn.indexOf(e)<0)||(dn.push(e),dn=dn.slice(-200),!1)},pn=n(179),mn=n.n(pn),fn={},hn="",gn=null;function bn(e,t){var n=e.text,a=e.entId;return gn&&gn("cancel"),fn[n]?t(it({autoFit:fn[n].slice(0,8)})):function(e){return fe(Le()({url:"/robot/auto_complete",method:"get"},e))}({params:{text:n,ent_id:a},cancelToken:new mn.a.CancelToken(function(e){gn=e})}).then(function(e){e&&e.data&&e.data.success&&(fn[n]=e.data.data||[],t(it({autoFit:e.data.data.slice(0,8)||[]})))})}var vn={search:function(e){var t=ln.getState(),n=ln.dispatch,a=t.getIn(["config","entId"]),o=t.getIn(["message","isBot"]);return hn!==e&&(!!o&&("string"!=typeof e?vn.remove():e.length?bn({text:hn=e,entId:a},n):vn.remove()))},remove:function(){var e=ln.dispatch;return gn&&gn("cancel"),e(it({autoFit:[],autoFitSelected:-1})),hn="",!1},select:function(e){var t=ln.getState(),n=ln.dispatch,a=t.getIn(["message","autoFit"]),o=t.getIn(["message","autoFitSelected"]),i=0;return 0!==a.length&&("prev"===e?i=o<=0?a.length-1:o-1:"next"===e&&(i=o>=a.length-1?0:o+1),n(it({autoFitSelected:i})),(a[i].question||"").replace(/<em>|<\/em>/g,""))}},_n=vn;function wn(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function yn(e,t,n,a){var o=3<arguments.length&&void 0!==a?a:{};(0,ln.dispatch)(st(e,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wn(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):wn(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({status:t,created_on:n},o)))}function xn(o){var i=ln.dispatch,e=ln.getState().get("config"),t={ent_id:e.get("entId"),track_id:e.get("trackId"),browser_id:e.get("browserId"),type:o.content_type,content:o.content};"file"===o.content_type&&(t.extra=o.extra),yn(o.id,"sending"),function(e,t){return fe({url:"/client/send_msg",method:"post",headers:{"content-type":"application/json"},params:{ent_id:e},data:t})}(t.ent_id,t).then(function(e){var t=e.data;if(t.success){i(mt("sentMessage")),un("message".concat(t.msg.id));var n=t.sensitive_content,a=null;n&&(a={sensitive:n,content:n.replaced_content}),yn(o.id,"success",t.msg.created_on,a)}else"conversation not found"===t.message&&i(ht(!1)),yn(o.id,"error")},function(){yn(o.id,"error")}).finally(function(){_n.remove()})}function kn(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function En(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?kn(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):kn(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}function In(e,t){if(t.length)for(var n=0;n<t.length;n+=1)"photo"!==t[n].content_type&&"file"!==t[n].content_type?e.push({id:t[n].id,from_type:"client",content_type:"text",status:"sending",content:t[n].content,type:"text"}):"photo"===t[n].content_type&&e.push(En({},t[n],{type:"photo"})),xn(t[n]);return e}function Cn(e,t){var n=1<arguments.length&&void 0!==t?t:300;window.requestAnimationFrame?function(i,e){var r=1<arguments.length&&void 0!==e?e:300,c=null;Mn&&window.cancelAnimationFrame(Mn),Mn=window.parent.requestAnimationFrame(function e(t){var n=Dn.scrollTop;if(r<t-(c=c||t))Mn=0,Dn.scrollTop=i;else if(Mn){var a=(t-c)/r;if(0!=a){var o=(i-n)*a;Dn.scrollTop=n+o}window.parent.requestAnimationFrame(e)}})}(e,n):Dn.scrollTop=e}function Tn(e){var o=0<arguments.length&&void 0!==e?e:100;setTimeout(function(){if(Dn){var e=Dn,t=e.scrollHeight,n=void 0===t?0:t,a=e.clientHeight;Cn(n-(void 0===a?0:a)+100,o)}},100)}function Sn(e){zn.includes(e)||zn.push(e)}function jn(t){if(zn.includes(t)){var e=zn.findIndex(function(e){return e===t});zn.splice(e,1),Tn()}}var Nn=n(27),On=n.n(Nn),Mn=(n(81),n(134),0),Dn=null,zn=[];function Bn(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function Pn(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},l=e.firstTime,s=e.sendFake,d=e.keepPosition,t=ln.getState(),u=ln.dispatch,n=t.get("config"),a=t.get("message"),o=n.get("entId"),i=n.get("trackId"),p=a.get("msgLoadLimit"),m=ie()(a.get("historyArray"));if(-1!==qn.indexOf(o))return null;function f(e){var t=ln.getState().get("message"),n=ie()(t.get("queue")),a=t.get("fakeMsg"),o=l?0:t.get("historyTimes"),i=n[0]?n[0].id:null,r={queue:n};if(m.length)if(l)r.showHistoryBtn=!0;else{var c=m.splice(0,p).map(function(e){var t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bn(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):Bn(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},e);return"hybrid"===t.content_type&&(t.content=JSON.parse(t.content)),t});r.queue=[].concat(ie()(c.reverse()),ie()(n))}l||(m.length||!e?r.showHistoryBtn=!0:r.showHistoryBtn=!1),s&&(r.queue=In(r.queue,a)),r.historyTimes=o+1,r.historyArray=m,u(it(r)),d?function(e){if(Dn&&e){var t=window.parent.document.querySelector("iframe[name=chat]").contentDocument.getElementById(e);Dn.style["overflow-y"]="hidden",Dn.scrollTop=t.offsetTop,setTimeout(function(){Dn.style["overflow-y"]="auto"},100)}}(i):Tn()}return l&&(An=0,m=[]),m.length<p?function(t){var n,a,o,i,r,c,l,s,d=arguments;On.a.async(function(e){for(;;)switch(e.prev=e.next){case 0:for(t(it({historyLoading:!0})),n={},e.prev=2,a=d.length,o=new Array(1<a?a-1:0),i=1;i<a;i++)o[i-1]=d[i];return e.next=6,On.a.awrap(St.apply(void 0,o));case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:if(t(it({historyLoading:!1})),n.data)if(r=n.data,(c=r.conversations).length){for(l=c.length-1;0<=l;l-=1)for(s=c[l].messages.length-1;0<=s;s-=1)c[l].messages[s]._renderType="history",m.push(c[l].messages[s]);c.length<1?f(!0):f()}else f(!0);case 14:case"end":return e.stop()}},null,null,[[2,9]])}(u,o,i,An+=1,5):f(),null}var An=0,qn=[62421],Rn="hidden"in document,Ln="Notification"in window,Un=null;document.implementation&&document.implementation.createHTMLDocument&&(Un=document.implementation.createHTMLDocument("sinker"));var Fn={__instance:null,__timer:null,close:function(e){var t=this;this.__timer&&clearTimeout(this.__timer),this.__timer=setTimeout(function(){t.__instance&&t.__instance.close&&t.__instance.close(),t.__instance=null},e||0)},show:function(e){var t=this,n=0<arguments.length&&void 0!==e?e:{};this.__instance=new window.Notification(n.title||R.a.t("美洽客服消息"),{body:n.body||"",icon:n.icon||"",tag:n.tag||""}),this.__instance.onclick=function(){window.parent.focus(),t.close(),function(){var e=window.parent.document.querySelector("iframe[name=chat]").contentDocument.getElementById("_MEIQIA_INPUT");e&&e.focus&&e.focus()}()},this.close(8e3)}};function Wn(e){return"string"!=typeof e?"":function(e){if(!Un||!e)return e;var t=Un.documentElement;return t.innerHTML=(e||"").trim(),t.innerText||t.textContent||""}(e.replace(/<img\sclass="emoji".+?alt=":(\w+):">/g,function(e,t){return":".concat(t,":")}).replace(/<br\/?>/g," ")).replace(/^\s+|\s+$/g,"")}function Gn(e){var t=e;if(t&&"agent"===t.from_type){var n=t.agent.nickname||t.agent.realname||R.a.t("管理员");if(t.content===R.a.t("[推广消息]"))return!1;"file"===t.content_type&&(t.content=R.a.t("「发来了一个文件」")),"photo"===t.content_type&&(t.content=R.a.t("「发来了一张图片」"));var a=Wn(t.content);if(!a.length)return!1;!function(t){Rn&&(!Ln||document.hidden&&("granted"===window.Notification.permission?Fn.show(t):"denied"!==window.Notification.permission&&window.Notification.requestPermission(function(e){"granted"===e&&Fn.show(t)})))}({title:R.a.t("新消息"),icon:t.agent.avatar,body:"".concat(n,": ").concat(a),tag:n})}return null}n(89);function Vn(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function Hn(e,t,_){return function(e,t){return fe({url:"/scheduler",method:"post",headers:{"content-type":"application/json"},params:{ent_id:e},data:t})}(e,t).then(function(e){var t=e.data,n=ln.getState(),a=n.get("message"),o=n.get("config"),i=n.get("smartGuide"),r="open"===a.getIn(["enterpriseInfo","prompt_status"]),c=a.get("chatHasEnd"),l={reserveToken:t.reserve_token,queue:ie()(a.get("queue")),fakeMsg:ie()(a.get("fakeMsg"))};if(t.success){l.convId=t.conv.id,Xe("convClickCallback","conv",l.convId),n.getIn(["config","standalone"])||Xe("startConversation"),t&&t.agent&&(l.agent=t.agent,l.isBot="bot"===t.agent.privilege),l.convNewCreate=t.conv_new_create,l.agentInfo={name:t.agent.nickname,avatar:t.agent.avatar,tel:t.agent.telephone,cellphone:t.agent.public_cellphone,email:t.agent.public_email,qq:t.agent.qq,weixin:t.agent.weixin,signature:t.agent.signature,isBot:"bot"===t.agent.privilege},!X.isMobile()&&l.convNewCreate&&_(mt("newChat"));var s=t.messages;if(l.convNewCreate||l.isBot||(t.agent_welcome_message&&s.unshift({id:"".concat(ce()(),"_agent_welcome"),from_type:"agent",content_type:"text",created_on:t.conv.created_on,content:t.agent_welcome_message,type:"message",agent:{nickname:t.agent.nickname,avatar:t.agent.avatar}}),a.get("entWelcomeMessage")&&s.unshift({id:"".concat(ce()(),"_ent_welcome"),from_type:"agent",content_type:"text",created_on:t.conv.created_on,content:a.get("entWelcomeMessage"),type:"message",agent:{nickname:"",avatar:a.get("enterpriseInfo").avatar||t.agent.avatar||Xn.a}})),s.length){for(var d=0;d<s.length;d+=1)s[d]._renderType="scheduler","hybrid"===s[d].content_type&&(s[d].content=JSON.parse(s[d].content)),un(s[d].action+s[d].id),s[d].created_on&&(l.lastMsgDate=s[d].created_on);if(r||!c)if(a.get("schedulerMsg")){var u;if(0===l.queue.length)(u=l.queue).push.apply(u,ie()(s))}else l.queue=ie()(s)}l.chatHasEnd=!1,a.get("surveyMsg")&&(l.fakeMsg.push(a.get("surveyMsg")),l.surveyMsg=null),o.get("trackId")&&Pn({firstTime:!0}),l.queue=In(l.queue,l.fakeMsg),l.fakeMsg=[],l.unableToServe=!1,l.schedulerMsg=!1,l.evaluationActive=!1,l.noMsgFilter=!1;var p=i.get("selectedTemplate"),m=i.get("templateActive"),f=i.getIn(["templateDetail","agentId"]),h=i.getIn(["templateDetail","html"]),g=i.getIn(["templateDetail","type"]),b=void 0===g||"welcoming"===g;if(m&&p&&l.convNewCreate&&b)!function(e,t,n,a,o,i){fe({url:"/mpush/enter",method:"post",headers:{"content-type":"application/json"},data:{ent_id:e,track_id:t,conv_id:n,template_id:a,agent_id:o,content:i}})}(o.get("entId"),o.get("trackId"),l.convId,p,f,h);else if(i.get("submitData")){var v=i.get("submitData");Kn(v.nodePath,!1)}_(Ee({templateActive:!1,submitData:null})),"bot"===t.agent.privilege||X.isMobile()||Ln&&window.Notification.requestPermission(),_(en({inQueue:!1})),_(it(l))}else"queueing"===t.result?_(en({inQueue:!0,position:t.position})):(l.convId=null,l.agent=null,l.agentToken=null,l.groupToken=null,l.unableToServe=!0,_(it(l)),_(Ft({visitorStatus:0})),_(Yt({showTicket:!0})));return Tn(),e})}function Qn(e){if(ea)return V.a.resolve();var t=ln.dispatch,n=ln.getState(),a=n.get("config"),o=n.get("message"),i={sys_invite_sys_accept:1,sys_invite_cutomer_accept:1,agent_invite_sys_accept:2,agent_invite_cutomer_accept:2},r=o.get("inviteFrom"),c=o.get("agentToken")||null,l=o.get("groupToken")||null;if(!c&&!l){var s=sn();c=s.agentToken||null,l=s.groupToken||null}var d={ent_id:a.get("entId"),track_id:a.get("trackId"),visit_id:a.get("visitId"),agent_token:c,group_token:c?null:l,url:window.parent.document.location.href,title:window.parent.document.title,queueing:!0,from_type:2===i[r]?"invitation":null};switch(a.get("fallback")&&(d.fallback=a.get("fallback")),e&&e.exclude_agent_tokens&&(d.exclude_agent_tokens=e.exclude_agent_tokens),d.conv_create_type=r?i[r]:0,o.get("convType")){case"click":case"newConv":d.conv_initiate_type="client";break;case"autoInvite":d.conv_initiate_type="sys_forced";break;case"manualInvite":d.conv_initiate_type="sys_accepted";break;default:d.conv_initiate_type=null}return e&&e.unmatch_redirect&&(d.conv_initiate_type="bot_redirect_auto"),a.get("docReferrer")&&(d.referrer_url=a.get("docReferrer")),t(it({scheduling:ea=!0,scheduler:!0,hasSendPromotion:!1,groupToken:l})),Hn(a.get("entId"),d,t).finally(function(){t(it({scheduling:ea=!1}))})}function Yn(e){for(var t="",n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],a=0;a<e;a+=1){t+=n[Math.round(Math.random()*(n.length-1))]}return t}var $n={name:"姓名",contact:"联系人",gender:"性别",age:"年龄",tel:"电话",qq:"QQ",weixin:"微信",weibo:"微博",address:"地址",email:"邮箱",comment:"备注"},Jn=function(e,t){var n=[{type:"client_card",body:t.body.content.map(function(e){var t=e.name,n=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Vn(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):Vn(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},e);return $n[t]&&(n.displayName=$n[t]),n})}],a={id:"card-".concat(t.id),agent:{nickname:t.agent_nickname,avatar:t.avatar},from_type:"agent",content_type:"hybrid",card_type:t.body.event_type,content:n,created_on:t.created_on};e(rt(a)),Tn()},Kn=function(o,e){var t=Pe().getState(),n=t.get("config"),a=t.getIn(["smartGuide","templateDetail"]),i=a.id,r=a.name,c=a.nodes;if(c&&o){var l=[{type:"name",content:r}];o.forEach(function(t,n){var e=c.find(function(e){return e.id===t});if(e){var a={type:"message"};e.node_body.forEach(function(e){"message"===e.type?a.content=e.content.replace(/<[\s\S]+?>/g,""):"card"===e.type&&l.push({type:"card",content:e.content})}),o[n+1]&&(e.options.forEach(function(e){e.next===o[n+1]&&(a.answer=e.content)}),l.push(a))}});var s={template_id:i,ent_id:n.get("entId"),track_id:n.get("trackId")},d=e?"<div>".concat(l.map(function(e){return function(e){switch(e.type){case"name":return"<div>顾客通过智能引导【".concat(e.content,"】提交工单</div>");case"message":return"<div><span>问: ".concat(e.content," </span><span>答: ").concat(e.answer,"</span></div>");case"card":var t=(e.content.fields||[]).map(function(e){return $n[e.name]?$n[e.name]:e.name}).join("、");return"<div>获取到访客的".concat(t,"</div>")}return""}(e)}).join(""),"</div>"):u()({type:"smart-guide",record:l});!function(e){fe({url:"/mpush/clue",method:"post",headers:{"content-type":"application/json"},data:e})}(Le()({},s,{visit_id:n.get("visitId"),content:d,create_ticket:!!e}))}},Zn=n(180),Xn=n.n(Zn),ea=!1,ta=!1,na=[],aa=function(t,n){var e=n.get("hasSendPromotion"),a=n.get("promotionMsgs"),o=a.msgs,i=void 0===o?[]:o,r=a.stop_after_talk;n.get("schedulerMsg");ta=r,!e&&i&&0!==i.length&&(i.forEach(function(e){!function(e,t,n){var a=setTimeout(function(){e(rt(t)),Tn()},1e3*(2<arguments.length&&void 0!==n?n:0));na.push(a)}(t,{id:Yn(8),from_type:"agent",content_type:"rich_text",extra:{content:e.content},content:"",type:"message",agent:{nickname:"",avatar:n.getIn(["enterpriseInfo","avatar"])}},e.countdown)}),t(it({hasSendPromotion:!0})))},oa=function(n){var a=ln.dispatch,e=ln.getState(),o=e.get("config"),i=e.get("message"),r=e.getIn(["queue","inQueue"]),c=e.getIn(["survey","showSurvey"]),l=i.get("visitorStatus"),s=i.get("entWelcomeMessage");return new V.a(function(e,t){return c?e():i.get("schedulerAfterClientSendMsg")?(a(it({noMsgFilter:!0})),4!==l&&s&&!r&&(a(rt({id:1*new Date,from_type:"agent",content_type:"text",content:s,type:"message",agent:{nickname:"",avatar:i.getIn(["enterpriseInfo","avatar"])}})),a(it({entWelcomeMessage:""}))),4!==l&&aa(a,i),e()):!i.get("scheduler")&&n?e(Qn()):i.get("scheduler")||i.get("convId")?e():o.get("servability")||4===l?e(Qn()):e()})},ia=(n(212),n(131),n(252),n(3)),ra=n.n(ia);n(254);function ca(e){for(var t=decodeURIComponent(e),n=String.fromCharCode(t.charCodeAt(0)-t.length),a=1;a<t.length;a+=1)n+=String.fromCharCode(t.charCodeAt(a)-n.charCodeAt(a-1));return n}function la(){return da.a.toUnicode(window.parent.document.location.hostname)}var sa=n(456),da=n.n(sa),ua=function(t,n,a){var o,i,r,c,l,s,d,u,p,m,f,h;return On.a.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.widget_settings,i=n.domain_security_config,r=void 0===i?{}:i,c=!1,l=t.entId,s=t.standalone,d=la(),u=r.status,p=r.urls,m="open"===u&&(!!(p&&0<p.length)&&p),!s&&m&&d&&!m.some(function(e){return d.endsWith(e.replace(/\/$/,""))}))return e.abrupt("return",!0);e.next=8;break;case 8:return e.prev=8,e.next=11,On.a.awrap(fe({url:"/static-files/40z3oz40z4lz17z4bz3mz48z4az42z3mz40z51z4l.js",baseURL:S.qcloud,method:"jsonp",callbackParamName:"jsonp_cb",jsonp:"blacklistJsonp",params:{v:"1"}}));case 11:h=e.sent,f=h.data.findIndex(function(e){return ca(e)==="".concat(l)}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),f=-1;case 18:if(-1<f)return e.next=21,On.a.awrap(fe({url:"/v1/throttle/web",method:"get",params:{api_name:"/visit/init",ent_id:l}}));e.next=23;break;case 21:e.sent.data.allowed||(c=!0);case 23:return c&&(a(Ht(o)),a(U(!0))),e.abrupt("return",c);case 25:case"end":return e.stop()}},null,null,[[8,15]])},pa=function(t,n){var a;return On.a.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&/^\S{6,32}$/.test(n))return e.next=3,On.a.awrap(fe({url:"/visit/get_binding",method:"get",params:{dev_client_id:n,ent_id:t}}));e.next=4;break;case 3:a=e.sent;case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}})};function ma(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}var fa=function(e,t,n,a){var o=t.widget_settings,i=t.standalone_window_config,r=t.ticket_config,c=t.survey,l="zh-tw"===e.language?"tw":e.language,s={isInit:!0,entId:e.entId,trackId:n,language:l,standalone:e.standalone,docLocation:e.docLocation,docTitle:e.docTitle,docReferrer:e.docReferrer,fallback:e.fallback,metadata:e.metadata,clientId:e.clientId,disableBrandLink:e.disableBrandLink,getInviting:e.getInviting,withoutBtn:e.withoutBtn,browserFamily:t.browser_family,browserId:t.browser_id,agentOnline:t.agent_online,servability:t.servability,visitId:t.visit_id,visitPageId:t.visit_page_id,visitorStatus:t.visitor_status,visitorStatusAgentToken:t.visitor_status_agent_token};window.parent.meiqia.event.emit("setTrackId",n),window.parent.meiqia.event.emit("setVisitId",t.visit_id),Ze("set","_MEIQIA_LANGUAGE",l||"zh"),Xe("standalone",X.isMobile()?{}:t.standalone_window_config.background),a(Ft(s)),a(U(!0)),a(Vt(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ma(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):ma(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},o,{standalone:i}))),a(Yt(r)),a(Jt(c))};function ha(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function ga(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ha(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):ha(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}function ba(n,a,o,i,r){var c,l,s,d,u,p;return On.a.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.invitation_config,a||!c){e.next=12;break}if("open"===c.facade_status)return l=ga({},o,{entId:r,target:X.isMobile()?"mobile":"pc",currentUrl:i}),e.next=7,On.a.awrap(fe({url:"facade/get_facade_result",method:"get",params:{enterprise_id:(t=l).entId,source_page:t.source_page||"",returning:t.returning,country:t.location,target:t.target,landing_page:t.landing_page||"",keyword:t.keyword||"",search_engine:t.search_engine||"",direct:t.direct,source_type:t.source_type||"",current_url:t.currentUrl||"",v:(new Date).getTime()}}));e.next=11;break;case 7:return s=e.sent,d=s.data,u=d.look_config,p=d.mech_config,c=ga({},c,{},u,{},p),e.abrupt("return",c);case 11:return e.abrupt("return",c);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}var t})}function va(e,t,n,a){if(n&&!e.standalone&&t.servability){sn(e.assign||{}),a(Ot(ga({},n)));var o=n.auto,i=o.status,r=o.countdown;"open"!==i||window.sessionStorage.getItem("MEIQIA_AUTO_INVITE_REJECTED")||setTimeout(function(){a(function(e,t){return a(Mt(e,t,{inviteType:"auto"}))})},1e3*r)}}function _a(t,n){var a;return On.a.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null,t&&"open"===t.status)return e.next=4,On.a.awrap(fe({url:"/client/forms",method:"get",params:{ent_id:n}}));e.next=5;break;case 4:a=e.sent;case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}})}function wa(e,t,n){var a=$.a.get("MEIQIA_HAS_SUBMITTED_FORM"),o=!1,i=null,r=!1,c=!1,l=!1;if("open"===e.status&&t&&(o="open"===e.status,c="open"===(i=t.data).form_def.menus.status,l="open"===i.form_def.inputs.status,a)){for(var s=i.form_def.inputs.fields,d=0,u=0;u<s.length;u+=1)s[u].ignore_returned_customer&&(s[u].ignore=!0,d+=1);d===s.length&&(l=!(r=!0)),"close"===i.form_def.menus.status&&r&&(o=!1)}return n(Jt({showSurvey:o,form:i,categoryEnabled:c,userFormEnabled:l})),null}function ya(e,t,n){var a=e.ent_welcome_message,o=e.enterprise_info,i=e.queueing_settings,r=e.promotion_msgs,c=e.scheduler_after_client_send_msg,l=e.visitor_status,s=e.standalone_window_config,d=e.widget_settings,u=e.send_file_settings,p=void 0===u?{}:u,m=Ze("get","MEIQIA_RING"),f=t.standalone?s.ring:d.ring;n(it({entWelcomeMessage:a,enterpriseInfo:o,queueingSettings:i,schedulerAfterClientSendMsg:c,visitorStatus:l,assign:t.assign||{},promotionMsgs:r||{msgs:[]},unReadPreview:"open"===d[ka].btn.preview,ringEnabled:m?"TRUE"===m:"open"===f,fileEnabled:"open"===p.widget_status}));var h=null;try{var g=et("get");h=JSON.parse(g),nt()(h)&&0===h.length&&(h=null)}catch(e){h=null}h&&(n(ut(h)),t.withoutBtn||n(W(!0)))}function xa(t){var e=ln.dispatch,n=ln.getState().get("message");Ca||(Ca=!0,e(rt({id:1*ce()(),from_type:"redirect_agent"})),Tn(),setTimeout(function(){var e={exclude_agent_tokens:[n.getIn(["agent","token"])]};t&&(e.unmatch_redirect=!0),Qn(e).finally(function(){Ca=!1})},1e3))}var ka=X.isMobile()?"mobile":"desktop",Ea=n(457),Ia=n.n(Ea),Ca=!1,Ta=function(e){var t=ln.getState(),n=ln.dispatch,a=t.get("router"),o=t.getIn(["config","withoutBtn"]);a.get("showWidget")||(n(ut(e)),o||a.get("showBubble")||n(W(!0)),et("set",e))};function Sa(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function ja(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Sa(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):Sa(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}var Na=null,Oa=function(e){var t=ln.getState(),n=t.get("config"),a=t.get("router"),o=ln.dispatch;switch(e.action){case"message":var i=[];/^(text|welcome|photo|file|bot|rich_text|hybrid)$/.test(e.content_type)&&("hybrid"===e.content_type?i.push(ja({},e,{content:JSON.parse(e.content),_renderType:"normal"})):i.push(ja({},e,{_renderType:"normal"})),"photo"===e.content_type&&Sn(e.id)),a.get("showWidget")?o(mt("newMessage")):o(mt("newChat")),function(){var e=Pe().getState(),t=X.isMobile()?"mobile":"desktop",n=e.getIn(["config","standalone"]),a=e.getIn(["message","convId"]),o=e.getIn(["theme",t,"pop"]);a&&!n&&o&&yt(!0)}(),Ta([e]),Gn(e),"redirect"===e.sub_type&&xa({unmatch:!0}),/queueing|manual_redirect/.test(e.sub_type)&&i.push({id:Math.random(),from_type:"redirect_btn"}),"reply"===e.sub_type&&i.push({id:Math.random(),from_type:"redirect_message_board"}),o(rt(i)),e.created_on&&o(it({lastMsgDate:e.created_on})),Tn();break;case"end_conv_timeout":case"end_conv_agent":case"end_conv_client":o(mt("newChat")),Xe("endConversation"),et("remove"),e.body.evaluation&&o(it({evaluationActive:!0})),o(ht(!1)),o(function(e,t){return e(Ie(e,t))});break;case"agent_visit_inviting":n.get("servability")&&(n.get("getInviting")?Xe("getInviting",e.body.token):(sn({agentToken:e.body.token}),o(function(e,t){return o(Dt(e,t,{inviteType:"manual"}))}),o(mt("newChat"))));break;case"agent_redirect":case"timeout_redirect":var r={id:1*new Date,from_type:"redirect",toNickname:e.body.to.nickname};o(rt(r)),Tn(),o(mt("newChat")),o(it({isBot:!1,agent:e.body.to,agentToken:e.body.to.token,convId:e.body.conversation_id,agentInfo:{avatar:e.body.to.avatar,name:e.body.to.nickname,signature:e.body.to.signature,cellphone:e.body.to.public_cellphone,tel:e.body.to.telephone,email:e.body.to.public_email,qq:e.body.to.qq,weixin:e.body.to.weixin}}));break;case"agent_inputting":t.getIn(["config","servability"])&&(clearTimeout(Na),o(it({agentInputing:!0})),Na=setTimeout(function(){o(it({agentInputing:!1}))},4e3));break;case"invite_evaluation":o(mt("newChat")),o(it({evaluationActive:!0}));break;case"visit_black_add":o(mt("newChat")),o(it({blacklist:!0}));break;case"visit_black_del":o(mt("newChat")),o(it({blacklist:!1}));break;case"init_conv":o(mt("newChat")),o(en({inQueue:!1})),o(it({scheduler:!0,chatHasEnd:!1,convId:e.body.id,agentToken:e.body.agent.token,agent:e.body.agent,agentInfo:{avatar:e.body.agent.avatar,name:e.body.agent.nickname,signature:e.body.agent.signature,cellphone:e.body.agent.public_cellphone,tel:e.body.agent.telephone,email:e.body.agent.public_email,qq:e.body.agent.qq,weixin:e.body.agent.weixin}})),Xe("startConversation"),Pn({firstTime:!0,sendFake:!0});break;case"agent_send_card":Jn(o,e);break;case"client_reply_card":!function(e,t){var n=m()(t.body.attrs).map(function(e){return R.a.t($n[e])||e}).join("、"),a={id:"card-".concat(t.id),from_type:"system_msg",content_type:"client_reply_card",content:"".concat(R.a.t("您已成功提交")," ").concat(n),created_on:t.created_on};e(rt(a)),Tn()}(o,e)}},Ma=n(181),Da=n.n(Ma),za=function(e,t){var n=ln.dispatch,a={content:e},o={alertVisible:!0,alertConfig:Le()(a,Da()(t)?{timeout:t}:t)};n(q(o))},Ba=null,Pa=null,Aa=["xhr-streaming","xdr-streaming","xhr-polling","xdr-polling","jsonp-polling"];function qa(o,i,n,a,r){function c(){clearTimeout(Ba),Ba=setTimeout(function(){t._close(1007,"Heartbeat timed out.")},6e4)}function l(e){return new Date(e).getTime()}var e="".concat(S.socket,"?browser_id=").concat(a,"&ent_id=").concat(o,"&track_id=").concat(i,"&visit_id=").concat(n),t=new Ia.a(e,null,{transports:Aa});t.onheartbeat=function(){t.send("h"),c()},t.onopen=function(){var e=ln.getState(),t=e.getIn(["config","isReconnect"]),n=e.get("message");if(t&&n.get("scheduler")&&!n.get("chatHasEnd")){var a=1e3*Math.floor(4*Math.random()+2);clearTimeout(Pa),Pa=setTimeout(function(){n.get("lastMsgDate")&&Bt(o,i,"after",n.get("lastMsgDate")).then(function(e){if(e.data){var t=e.data,n=t.events,a=t.messages,o=n.concat(a);if(o.length){o.sort(function(e,t){return l(e.created_on)>l(t.created_on)?1:l(e.created_on)<l(t.created_on)?-1:0});for(var i=0;i<o.length;i+=1)un(o[i].action+o[i].id)||Oa(o[i])}}})},a)}r(Ft({socket:!0})),c()},t.onmessage=function(e){try{var t=JSON.parse(e.data);un(t.action+t.id)||Oa(t)}catch(e){console.log(e)}},t.onclose=function(){var e=ln.getState().get("config");r(Ft({socket:!1,isReconnect:!0}));var t=1e3*Math.floor(4*Math.random()+4);setTimeout(function(){e.get("stopReconnect")||qa(o,i,n,a,r)},t),setTimeout(function(){e.get("socket")||(r(Ft({stopReconnect:!0})),za(R.a.t("连接已断开，请刷新页面")))},2e4)}}void 0!==window.WebSocket&&(Aa=["websocket"]);function Ra(e,t){if(4===e.visitor_status){var n=Ze("get","MEIQIA_PANEL_VISIBILITY")||"visible";Qn(),"visible"===n&&yt(!0,"chat")}X.isMobile()&&ze("init")}function La(e){var t,n=Object(ue.useState)(null),a=ra()(n,2),o=a[0],i=a[1],r=e.component,c=e.children,l=e.GlobalStyle,s=Object(ue.useRef)(null);return r&&(t=pe.a.createElement(r,Qa()({frameRef:s},e))),Object(ue.useEffect)(function(){var e=s.current.contentDocument;e&&"complete"===e.readyState?i(s.current):s.current.addEventListener("load",function(){i(s.current)})},[]),pe.a.createElement(pe.a.Fragment,null,pe.a.createElement(d.a,{target:window.parent.document.head},t),o&&o.contentWindow&&pe.a.createElement(d.a,{target:o.contentWindow.document.head},pe.a.createElement(pe.a.Fragment,null,l?pe.a.createElement(l,null):null,pe.a.createElement(Ya.a,{node:o.contentWindow.document.body},c))))}var Ua={},Fa=function(v,_,w){var y,x,k,E,I,C,T,S,j,N,O,M,D,z,B,P,A,q,R,L,U,F,W,G;return On.a.async(function(e){for(;;)switch(e.prev=e.next){case 0:return _&&(Ua=_),x=(y=Ua).docLocation,k=y.entId,E=y.clientId,I=y.getInviting,C=y.docTitle,T=y.docReferrer,S=y.fingerprint,j=Ua.trackId,N={},e.prev=4,e.next=7,On.a.awrap(fe({url:"/visit/get_base_config",method:"get",params:{ent_id:k}}));case 7:O=e.sent,N=O.data,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:if(w){e.next=20;break}return e.next=17,On.a.awrap(ua(Ua,N,v));case 17:if(e.sent)return e.abrupt("return",!1);e.next=20;break;case 20:return e.next=22,On.a.awrap(pa(k,E));case 22:return(M=e.sent)&&M.data&&(j=M.data.track_id),e.next=26,On.a.awrap((b=void 0,b={ent_id:k,track_id:j||"",title:C,referrer_url:T,url:x},(g=S)&&(b.fingerprint=g),fe({url:"visit/init",method:"jsonp",callbackParamName:"jsonp_cb",jsonp:"jsonp".concat((new Date).getTime()),params:b})));case 26:if(D=e.sent,z=D.data,D&&!1!==z.success){e.next=30;break}return e.abrupt("return",!1);case 30:return B=z.facade,P=z.track_id,A=z.visit_id,q=z.browser_id,R=z.service_evaluation_config,L=z.survey,P&&(j=P),e.next=34,On.a.awrap(V.a.all([ba(z,I,B,x,k),_a(L,k)]));case 34:return U=e.sent,F=ra()(U,2),W=F[0],G=F[1],fa(Ua,z,j,v),va(Ua,z,W,v),wa(L,G,v),f=v,void 0,h=z.robot_settings,f(nn(h)),v(Zt(R)),ya(z,Ua,v),u=v,void 0,p=(d=z).in_queue,m=d.queueing_settings,u(en({inQueue:p,intro:m.intro})),qa(k,j,A,q,v),Ra(z),a=Ua,o=v,s=void 0,i=(n=z).in_queue,r=n.visitor_status,c=n.visitor_info,l=n.mpush_settings,s={enabled:!0,visitorInfo:c,templates:l},!a.standalone&&l||(s.enabled=!1),4===r||i?o(Ee(s)):(o(Ee(s)),o(function(e,t){return e(Ie(e,t))})),t=z,"function"==typeof Ua.getInviting&&t.servability&&2===t.visitor_status&&Xe("getInviting",t.visitor_status_agent_token),Xe("allSet",t.servability),e.abrupt("return",null);case 50:case"end":return e.stop()}var t,n,a,o,i,r,c,l,s,d,u,p,m,f,h,g,b},null,null,[[4,11]])},Wa=function(o,i){function r(e){a?e():n.push(e)}var e,t=window.parent.meiqia,n=[],a=!1;return t&&(e=t.event,t.manualInit||Fa(o,t),e.on("init",function(){Fa(o,t)}),e.on("showPanel",function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};r(function(){var e=a.agentToken,t=a.groupToken,n=a.greeting;o(bt("click")),o(_t({greeting:n,assign:{agentToken:e,groupToken:t}})),sn({agentToken:e,groupToken:t}),ze("init"),oa(!0).then(function(){yt(!0,"chat")})})}),e.on("hidePanel",function(){r(function(){yt(!1)})}),e.on("assign",function(e){r(function(){o(it({assign:e}))})}),e.on("metadata",function(t){r(function(){var e=i.getState().get("config");e.get("entId")&&he(e.get("entId"),e.get("trackId"),e.get("visitId"),e.get("browserId"),t)})}),e.on("trackEvent",function(n,a){r(function(){if("[object object]"===Object.prototype.toString.call(a).toLowerCase()){var e=i.getState().get("config");if(e.get("entId")){var t=!1;m()(a).forEach(function(e){"object"===p()(a[e])&&(t=!0)}),t||function(e,t,n,a){fe({url:"/client/client_events",method:"post",headers:{"content-type":"application/json"},data:{ent_id:e,track_id:t,name:n,metadata:a}})}(e.get("entId"),e.get("trackId"),n,u()(a))}}})}),e.on("ticket",function(a,o){r(function(){var e=a,t=i.getState().get("config");if(!t.get("entId"))return!1;var n={data:{enterprise_id:t.get("entId"),track_id:t.get("trackId"),visit_id:t.get("visitId"),channel:"widget",content:e.ticketContent}};return delete e.ticketContent,he(t.get("entId"),t.get("trackId"),t.get("visitId"),t.get("browserId"),e),Tt(n).then(function(){"function"==typeof o&&o(!0)},function(){"function"==typeof o&&o(!1,"保存失败")}),!0})}),e.on("closeConversation",function(n){r(function(){var e=i.getState().get("config");(function(e){return fe({url:"/client/end_conversation",method:"post",headers:{"content-type":"application/json"},data:{ent_id:e.entId,track_id:e.trackId}})})({entId:e.get("entId"),trackId:e.get("trackId")}).then(function(e){var t=null;e.data.success||(t=e.data.message||"failed"),"function"==typeof n&&setTimeout(function(){n(t)},500)},function(e){"function"==typeof n&&setTimeout(function(){n(u()(e))},500)})})}),e.on("reopenConversation",function(e){r(function(){"object"===p()(e)&&e&&sn(e),o(it({convType:"newConv",scheduler:!1})),oa(!0)})}),e.on("rejectInvitation",function(){r(function(){t.getInviting&&o(Ct)})}),e.on("allSet",function(){a=!0,n.forEach(function(e){e&&"function"==typeof e&&e()})})),e},Ga=n(45),Va=n.n(Ga),Ha=n(4),Qa=n.n(Ha),Ya=n(804),$a=d.d.iframe.withConfig({displayName:"base-button__BaseFrame",componentId:"sc-10my82n-0"})(["border:none;margin:0;padding:0;overflow-x:visible;overflow-y:visible;overflow-wrap:normal;display:"," !important;position:fixed;z-index:9999999;text-align:center;box-sizing:border-box;"],function(e){return e.visible?"block":"none"}),Ja=pe.a.forwardRef(function(e,t){var n=e.frameRef;return pe.a.createElement($a,Qa()({},e,{name:"button",ref:n}))}),Ka=window.parent.document.body.clientWidth;var Za=function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=Object(ue.useState)(null),n=ra()(e,2),a=n[0],r=n[1];return Object(ue.useEffect)(function(){if(t){var e=new Image;e.src=t,e.onload=function(e){var t=e.target.width,n=e.target.height,a=t,o=n;Ka&&.9*Ka<t&&(o=n*(a=.9*Ka)/t),r({width:"".concat(a+i,"px"),height:"".concat(o+i,"px")})}}},[t,i]),a},Xa=function(e){var t=Object(ue.useState)(!1),n=ra()(t,2),a=n[0],o=n[1],i=e.get("servability"),r=e.get("visitorStatus");return Object(ue.useEffect)(function(){o(!0===i||4===r)},[i,r]),a},eo={},to=function(e,t){var n,a=window.parent.document,o=a.getElementById("_calculateTextWidth");return eo[t]||(o?n=o:((n=a.createElement("span")).id="_calculateTextWidth",n.style.visibility="hidden",n.style.fontSize=e,n.style.fontFamily=a.body.style.fontFamily,n.style.display="inline-block",n.style.position="absolute",n.style.left="-100%",n.style.top="-100%",a.body.appendChild(n)),void 0!==n.textContent?n.textContent=t:n.innerText=t,eo[t]=K()(window.getComputedStyle(n).width||n.clientWidth,10)),eo[t]};function no(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function ao(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?no(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):no(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}function oo(e,t,n){var a=e.getIn(["".concat(t),"btn"]);if(a){var o=a.text,i=void 0===o?{}:o,r=n?i.online:i.offline,c="picture"===a.type?"transparent":"#".concat(a.theme);return ao({},function(e,t,n){var a={},o=(to("16px",n)||270)+80+30;switch(e){case"bottom":a.width="".concat(o,"px"),a.height="".concat(70,"px");break;case"round":a.width="".concat(92,"px"),a.height="".concat(92,"px");break;case"aside":a.width="".concat(70,"px"),a.height="".concat(o,"px");break;case"picture":a.width="0",a.height="0";break;case"call":a.width="".concat(92,"px"),a.height="".concat(92,"px")}if("mobile"===t)switch(e){case"bottom":a.width="100%",a.height="".concat(80,"px")}return a}(a.type,t,r),{},function(e,t,n){var a=e.type,o=e.horizontal,i=e.bottom,r={};switch(r.bottom="bottom"===t?"-".concat(15,"px"):"".concat(i-15,"px"),a){case"right":r.right="".concat(o-15,"px"),"aside"===t&&(r.right="-".concat(15,"px")),"bottom"===t&&"mobile"===n&&(r.right="0");break;case"left":r.left="".concat(o-15,"px"),"aside"===t&&(r.left="-".concat(15,"px")),"bottom"===t&&"mobile"===n&&(r.left="0")}return r}(a.position,a.type,t),{bgColor:c})}return{}}function io(e){var t=e.theme,n=e.config,a=X.isMobile()?"mobile":"desktop",o=co(t,n,a),i=e.frameRef;return pe.a.createElement(lo,Qa()({},o,e,{ref:i}))}function ro(e){return pe.a.createElement(mo,e)}var co=function(t,e,n){var a=Object(ue.useState)(null),o=ra()(a,2),i=o[0],r=o[1],c=Xa(e);Object(ue.useEffect)(function(){var e=oo(t,n,c);r(e)},[n,t,c]);var l=function(e,t,n){var a=e.getIn(["".concat(t),"btn"]);if(a){var o=a.picture;return"picture"!==a.type?null:n?o.online:o.offline}return null}(t,n,c),s=Za(l,30);return s?ao({},i,{},s):i},lo=Object(d.d)(Ja).withConfig({displayName:"chat-button__ChatButtonStyle",componentId:"sc-1j23u9p-0"})(["bottom:",";height:"," !important;width:"," !important;background-color:transparent;"," ",""],function(e){return e.bottom},function(e){return e.height||0},function(e){return e.width||0},function(e){return e.left?"left: ".concat(e.left,";"):""},function(e){return e.right?"right: ".concat(e.right,";"):""}),so=Object(o.b)(function(e){return{theme:e.get("theme"),config:e.get("config")}},function(e){return{dispatch:e}})(function(e){return pe.a.createElement(io,e)}),uo=n(46),po=n.n(uo),mo=d.d.span.withConfig({displayName:"base-icon__Container",componentId:"sc-1ajxhaa-0"})(["vertical-align:middle;padding-right:",";height:",';display:inline-block;background:url("','") no-repeat;background-position:'," ",";background-size:",";"],function(e){return e.width},function(e){return e.height},function(e){return e.image},function(e){return e.position[0]},function(e){return e.position[1]},function(e){return e.bgSize}),fo=n(459),ho=n.n(fo),go=n(460),bo=n.n(go),vo=n(461),_o=n.n(vo);function wo(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}var yo=[{type:"face",info:["-23px","-1px"]},{type:"picture",info:["-23px","-23px"]},{type:"file",info:["-23px","-441px"]},{type:"good",info:["-23px","-45px"]},{type:"hide-white",info:["-23px","-67px"]},{type:"hide-black",info:["-2px","-67px"]},{type:"sound-white",info:["-23px","-89px"]},{type:"sound-black",info:["-2px","-89px"]},{type:"silent-white",info:["-23px","-111px"]},{type:"silent-black",info:["-2px","-111px"]},{type:"close",info:["-2px","-133px"]},{type:"email",info:["-1px","-155px"]},{type:"phone",info:["-1px","-177px"]},{type:"qq",info:["-1px","-199px"]},{type:"tele",info:["-1px","-221px"]},{type:"error",info:["-2px","-244px"]},{type:"wechat",info:["-1px","-287px"]},{type:"eva-good",info:["-2px","-310px"]},{type:"eva-normal",info:["-2px","-354px"]},{type:"eva-bad",info:["-2px","-398px"]},{type:"support",info:["-1px","-265px"]},{type:"cancel",info:["-23px","-507px"]},{type:"file-icon",info:["-1px","-530px"]},{type:"download",info:["-1px","-463px"]},{type:"call",info:["-1px","-573px"]}],xo=[{type:"chat-button-1",info:["0","-3px"]},{type:"chat-button-2",info:["0","-35px"]},{type:"chat-button-3",info:["0","-67px"]},{type:"chat-button-4",info:["0","-99px"]},{type:"chat-button-5",info:["0","-131px"]},{type:"chat-button-6",info:["0","-163px"]},{type:"chat-button-7",info:["0","-227px"]},{type:"chat-button-8",info:["0px","-259px"]},{type:"chat-button-9",info:["0px","-291px"]},{type:"chat-button-10",info:["0px","-323px"]},{type:"chat-button-11",info:["0px","-355px"]},{type:"chat-button-12",info:["0px","-387px"]},{type:"call-button-1",info:["-31px","-3px"]},{type:"call-button-2",info:["-31px","-35px"]},{type:"call-button-3",info:["-31px","-67px"]},{type:"call-button-4",info:["-31px","-99px"]},{type:"call-button-5",info:["-31px","-131px"]},{type:"call-button-6",info:["-31px","-163px"]},{type:"call-button-7",info:["-31px","-227px"]},{type:"call-button-8",info:["-31px","-259px"]},{type:"call-button-9",info:["-31px","-291px"]},{type:"call-button-10",info:["-31px","-323px"]},{type:"call-button-11",info:["-31px","-355px"]},{type:"call-button-12",info:["-31px","-387px"]},{type:"call-callback",info:["-31px","-451px"]}],ko=[{type:"mobile-page-back",info:["-25px","-436px"]}],Eo=d.d.label.withConfig({displayName:"icon__Span",componentId:"sc-5foskt-0"})(["display:inline-block;vertical-align:middle;"]),Io=function(t){var e,n=t.children,a=t.handleClick,o=t.className,i=po()(t,["children","handleClick","className"]),r=yo.find(function(e){return e.type===t.type}),c=ko.find(function(e){return e.type===t.type}),l=xo.find(function(e){return e.type===t.type});if(r&&(e=pe.a.createElement(ro,Qa()({},i,{image:ho.a,position:r.info,bgSize:"44px auto"}))),c&&(e=pe.a.createElement(ro,Qa()({},i,{image:bo.a,position:c.info,bgSize:"44px auto"}))),l){var s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wo(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):wo(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},i,{width:"32px",height:"32px"});e=pe.a.createElement(ro,Qa()({},s,{image:_o.a,position:l.info,bgSize:"64px auto"}))}return pe.a.createElement(Eo,{onClick:a,className:o},e,n||null)},Co=d.d.div.withConfig({displayName:"frame-button-content__Wrapper",componentId:"sc-1td9tx7-0"})(["height:100%;width:100%;background-color:#",";",";",";",";text-align:center;cursor:pointer;label{cursor:pointer;}"],function(e){return e.bgColor},function(e){return e.borderRadius?"border-radius: ".concat(e.borderRadius):""},function(e){return e.boxShadow?"box-shadow: ".concat(e.boxShadow):""},function(e){return e.position?e.position:"position: relative;"}),To=d.d.div.withConfig({displayName:"frame-button-content__BottomLeft",componentId:"sc-1td9tx7-1"})(["float:left;width:40px;height:30px;border-right:1px solid rgba(0,0,0,0.08);padding-top:10px;"]),So=d.d.div.withConfig({displayName:"frame-button-content__ButtonRight",componentId:"sc-1td9tx7-2"})(["line-height:40px;font-size:16px;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:calc(100% - 41px);"]),jo=d.d.div.withConfig({displayName:"frame-button-content__RoundWrapper",componentId:"sc-1td9tx7-3"})(["padding-top:19px;"]),No=d.d.div.withConfig({displayName:"frame-button-content__AsideTop",componentId:"sc-1td9tx7-4"})(["height:30px;width:40px;line-height:40px;padding-top:10px;border-bottom:1px solid rgba(0,0,0,0.08);"]),Oo=Object(d.d)(So).withConfig({displayName:"frame-button-content__AsideBottom",componentId:"sc-1td9tx7-5"})(["float:none;color:#fff;writing-mode:tb-rl;height:calc(100% - 41px);width:40px;"]),Mo=d.d.div.withConfig({displayName:"frame-button-content__MobileBottomLeft",componentId:"sc-1td9tx7-6"})(["height:35px;padding-top:10px;color:#fff;> span{padding-left:10px;line-height:20px;}"]),Do=d.d.div.withConfig({displayName:"frame-button-content__Picture",componentId:"sc-1td9tx7-7"})(["width:100%;height:100%;background:url(",") no-repeat;background-size:cover;"],function(e){return e.selectPicture}),zo=d.d.div.withConfig({displayName:"frame-button-content__Unread",componentId:"sc-1td9tx7-8"})(["height:24px;min-width:24px;line-height:24px;border-radius:50%;font-size:14px;color:#fff;position:absolute;"," top:-8px;background:#f00;"],function(e){return e.styles?e.styles:"left: -8px;"}),Bo=Object(o.b)(function(e){return{theme:e.get("theme"),config:e.get("config"),unReadCount:e.getIn(["message","unReadCount"])}},function(e){return{dispatch:e}})(function(e){var t=e.theme,n=e.config,a=e.unReadCount,o=X.isMobile(),i=o?"mobile":"desktop",r=t.getIn(["".concat(i),"btn"]),c=function(e){var t={};if(e){var n=e.type;switch(t.bgColor=e.theme,t.boxShadow="rgba(0, 0, 0, 0.16) 0 5px 14px",n){case"round":case"call":t.borderRadius="50%";break;case"picture":t.bgColor="transparent",t.boxShadow="";break;case"bottom":X.isMobile()&&(t.position="position:absolute;left:0;right:0;top:15px;")}}return t}(r),l=Xa(n,t),s=t.get("isLimitButton"),d=r&&"round"===r.type,u=Object(ue.useRef)(null);return Object(ue.useEffect)(function(){var e=u.current;return d&&o&&Ke.register(e,"button",o),function(){o&&Ke.unregister(e,!0)}},[d,o]),pe.a.createElement(Co,Qa()({},c,{ref:u}),0<a&&"picture"!==r.type?pe.a.createElement(zo,{styles:function(e){var t="left",n="-10px";return e.position&&(t="right"===e.position.type?"left":"right"),"bottom"===e.type&&X.isMobile()&&(n="0"),"".concat(t,": ").concat(n,";")}(r)},a):null,function(e,t,n,a){var o;if(e){var i=e.type,r=void 0===i?"":i,c=e.text,l=void 0===c?{}:c,s=e.icon,d=void 0===s?{}:s,u=e.picture,p=void 0===u?{}:u,m="",f="",h="";switch(n?(m=l.online,f="chat-button-".concat(d.online),h=p.online,"call"===r&&(f="chat-button-1")):(m=l.offline,f="call-button-".concat(d.offline),h=p.offline,"call"===r&&(f="call-button-1")),a&&(f="chat-button-1"),r){case"bottom":o=[pe.a.createElement(To,{key:"left"},pe.a.createElement(Io,{type:f})),pe.a.createElement(So,{key:"right"},m)];break;case"round":case"call":o=pe.a.createElement(jo,null,pe.a.createElement(Io,{type:f}));break;case"aside":o=[pe.a.createElement(No,{key:"top"},pe.a.createElement(Io,{type:f})),pe.a.createElement(Oo,{key:"bottom"},m)];break;case"picture":o=pe.a.createElement(Do,{selectPicture:h})}if("mobile"===t)switch(r){case"bottom":o=pe.a.createElement(Mo,null,pe.a.createElement(Io,{type:f}),pe.a.createElement("span",null,m))}}return o}(r,i,l,s))});function Po(){var e=Va()(["\n  html,body {\n    height:100%;\n    width:100%;\n    margin:0;\n    padding:0;\n  }\n  body {\n    box-sizing: border-box;\n    /* iframe padding */\n    padding: 15px;\n  }\n"]);return Po=function(){return e},e}function Ao(e,t){function n(e){return K()(e,10)||0}var a={},o=e.getIn([Uo,"btn","type"]),i=e.getIn([Uo,"btn","position","type"]);if("desktop"==Uo)switch(o){case"bottom":a[i]=n(t[i]),a.bottom=n(t.bottom)+n(t.height);break;case"aside":a[i]=n(t[i])+n(t.width),a.bottom=n(t.bottom)+.4*n(t.height);break;case"picture":case"round":case"call":a[i]=n(t[i])+n(t.width),a.bottom=n(t.bottom)+.5*n(t.height),a.transform="translateY(50%)"}else switch(o){case"bottom":a[i]=n(t[i]),a.bottom=n(t.bottom)+n(t.height);break;case"aside":a[i]=n(t[i])+n(t.width),a.bottom=n(t.bottom)+.4*n(t.height);break;case"picture":case"round":a[i]=n(t[i]),a.bottom=n(t.bottom)+n(t.height);break;case"call":a[i]=n(t[i]),a.bottom=n(t.bottom)+2*n(t.height)-20}return a}var qo=Object(d.c)(Po()),Ro=d.d.div.withConfig({displayName:"router-button__Wrapper",componentId:"sc-1xlmfkg-0"})(["width:100%;height:100%;"]),Lo=Object(o.b)(function(e){return{router:e.get("router"),config:e.get("config"),theme:e.get("theme")}},function(e){return{dispatch:e}})(function(e){var t=e.router,n=e.config,a=e.dispatch,o=e.theme.get("isLimitButton");return pe.a.createElement(La,{visible:t.get("showButton")&&!n.get("withoutBtn"),component:so,GlobalStyle:qo,iframeName:"button"},pe.a.createElement(Ro,{onClick:function(){return On.a.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(a(bt("click")),o)return e.next=4,On.a.awrap(Fa(a,null,!0));e.next=4;break;case 4:sn(),oa().then(function(){yt(!0,"chat")});case 6:case"end":return e.stop()}})}},pe.a.createElement(Bo,null)))}),Uo=X.isMobile()?"mobile":"desktop",Fo=d.d.iframe.attrs({allowtransparency:"true"}).withConfig({displayName:"frame-bubble__BubbleFrame",componentId:"ik1xl9-0"})(["width:300px !important;height:140px !important;border:none;margin:0;padding:0;overflow-x:visible;overflow-y:visible;overflow-wrap:normal;position:fixed;z-index:9999999;cursor:pointer;display:"," !important;"," "," "," ",""],function(e){return e.visible?"block":"none"},function(e){return e.left?"left: ".concat(e.left,"px;"):""},function(e){return e.right?"right: ".concat(e.right,"px;"):""},function(e){return"bottom: ".concat(e.bottom,"px;")},function(e){return e.transform?"transform: ".concat(e.transform,";"):""}),Wo=pe.a.forwardRef(function(e,t){var n=e.theme,a=e.config,o=e.frameRef,i=co(n,a,Uo),r=Ao(n,i),c=n.getIn([Uo,"btn","type"]),l=n.getIn([Uo,"btn","position","type"]);return pe.a.createElement(Fo,Qa()({},e,{"data-direction":l,"data-type":c},r,{name:"bubble",ref:o}))}),Go=Object(o.b)(function(e){return{theme:e.get("theme"),config:e.get("config")}})(Wo),Vo=(n(150),d.d.div.withConfig({displayName:"msg-text__Text",componentId:"sc-1jl8p2c-0"})(["color:",";white-space:normal;text-align:left;"],function(e){return e.fontColor})),Ho=pe.a.memo(function(e){return pe.a.createElement(Vo,{fontColor:e.fontColor,dangerouslySetInnerHTML:{__html:e.msg}})}),Qo=(n(201),{BG_COLOR:"#fff",MSG_MARGIN:10}),Yo=d.d.div.withConfig({displayName:"msg-base__Wrapper",componentId:"kwi7by-0"})(["margin-bottom:20px;",";&:after{content:' ';display:table;clear:both;}"],function(e){return"left"===e.direction?"padding-right: ".concat(e.msgMargin):"padding-left: ".concat(e.msgMargin)}),$o=d.d.img.withConfig({displayName:"msg-base__Avatar",componentId:"kwi7by-1"})(["width:36px;height:36px;margin-right:10px;margin-top:16px;vertical-align:top;float:",";"],function(e){return e.direction}),Jo=d.d.div.withConfig({displayName:"msg-base__InfoWrapper",componentId:"kwi7by-2"})(["float:",";text-align:",";max-width:calc(100% - 50px);"],function(e){return e.direction},function(e){return e.direction}),Ko=d.d.div.withConfig({displayName:"msg-base__Name",componentId:"kwi7by-3"})(["color:#b2b2b2;font-size:12px;margin-bottom:2px;"]),Zo=d.d.div.withConfig({displayName:"msg-base__MsgWrapper",componentId:"kwi7by-4"})(["max-width:100%;position:relative;background-color:",";border-radius:3px;border:1px solid #f0f0f0;"," ",""],function(e){return e.themeColor},function(e){return"right"===e.direction?"margin-left: 30px;":""},function(e){return"float: ".concat(e.direction,";")}),Xo=d.d.div.withConfig({displayName:"msg-base__MsgStatus",componentId:"kwi7by-5"})(["position:absolute;top:8px;left:-22px;width:15px;height:100%;"]),ei=d.d.div.withConfig({displayName:"msg-base__MsgBox",componentId:"kwi7by-6"})(["padding:",";border-radius:3px;font-size:13px;word-break:break-word;.emoji{width:20px;height:20px;vertical-align:text-bottom;}"],function(e){return e.padding?e.padding:"10px 15px"}),ti=d.d.div.withConfig({displayName:"msg-base__Arrow",componentId:"kwi7by-7"})(["position:absolute;top:13px;border-top:5px solid transparent;border-bottom:5px solid transparent;"," ",""],function(e){return"left"===e.direction?"left: -6px;":"right: -6px;"},function(e){return"left"===e.direction?"border-right: 6px solid #fff;":"border-left: 6px solid ".concat(e.themeColor,";")}),ni=d.d.div.withConfig({displayName:"msg-base__ArrowBg",componentId:"kwi7by-8"})(["position:absolute;top:12px;border-top:6px solid transparent;border-bottom:6px solid transparent;"," ",""],function(e){return"left"===e.direction?"left: -7px;":"right: -7px;"},function(e){return"left"===e.direction?"border-right: 7px solid #f0f0f0;":"border-left: 7px solid #f0f0f0;"}),ai=d.d.div.withConfig({displayName:"msg-base__Evaluation",componentId:"kwi7by-9"})(["width:100%;height:30px;min-width:150px;line-height:30px;position:relative;border-top:solid 1px #eee;"]),oi=d.d.span.withConfig({displayName:"msg-base__EvaSpan",componentId:"kwi7by-10"})(["width:",";height:100%;display:inline-block;color:",";cursor:pointer;font-size:13px;text-align:center;"],function(e){return e.width},function(e){return e.color}),ii=d.d.div.withConfig({displayName:"msg-base__Split",componentId:"kwi7by-11"})(["position:absolute;left:50%;top:0;bottom:0;width:1px;background:#eee;"]);function ri(e){var t=e.id,n=e.questionId,a=e.question,o=e.arrow,i=void 0!==o&&o,r=e.msgMargin,c=void 0===r?Qo.MSG_MARGIN:r,l=e.themeColor,s=void 0===l?Qo.BG_COLOR:l,d=e.className,u=e.padding,p=e.name,m=e.time,f=e.direction,h=e.avatar,g=e.evaluateStatus,b=e.handleFeedback,v=e.status,_=e.handleMsgClick,w={themeColor:s,direction:f},y=Object(me.c)(),x=ra()(y,1)[0];return pe.a.createElement(Yo,Qa()({},w,{msgMargin:c}),h?pe.a.createElement($o,Qa()({src:h},w)):null,pe.a.createElement(Jo,Qa()({},w,{className:d}),pe.a.createElement(Ko,null,p?"".concat(p," "):null,m||null),pe.a.createElement(Zo,w,"error"===v?pe.a.createElement(Xo,null,pe.a.createElement(Io,{type:"error",width:"18px",height:"18px"})):null,pe.a.createElement(ei,{padding:u,onClick:_},i?pe.a.createElement(ni,w):null,i?pe.a.createElement(ti,w):null,e.children),g&&n?pe.a.createElement(ai,null,"waiting"===g?pe.a.createElement(pe.a.Fragment,null,pe.a.createElement(oi,{width:"50%",color:"#6088e6",onClick:function(){return b(t,n,1,a)}},x("解决")),pe.a.createElement(oi,{width:"50%",color:"#6088e6",onClick:function(){return b(t,n,0,a)}},x("未解决")),pe.a.createElement(ii,null)):null,"finish"===g?pe.a.createElement(oi,{width:"100%",color:"#aaa"},x("已反馈")):null,"submit"===g?pe.a.createElement(oi,{width:"100%",color:"#aaa"},x("提交中")):null):null)))}var ci=d.d.div.withConfig({displayName:"msg-menu__MenuWrapper",componentId:"sc-13vi9i2-0"})(["width:100%;display:inline-block;overflow:hidden;.textBefore{color:#aaa;}"]),li=d.d.div.withConfig({displayName:"msg-menu__Item",componentId:"sc-13vi9i2-1"})(["margin:3px 0;"]),si=d.d.a.withConfig({displayName:"msg-menu__Anchor",componentId:"sc-13vi9i2-2"})(["font-size:13px;color:#6088e6;text-decoration:none;"]),di=d.d.span.withConfig({displayName:"msg-menu__Span",componentId:"sc-13vi9i2-3"})(["font-size:13px;color:#6088e6;cursor:pointer;"]),ui=d.d.p.withConfig({displayName:"msg-menu__Tip",componentId:"sc-13vi9i2-4"})(["color:#aaa;margin-top:1em;font-size:13px;"]);function pi(e){var t,n=e.textBefore,a=e.textAfter,o=e.menuTip,i=e.items,r=e.handleMenuClick,c=void 0===r?function(){}:r;return pe.a.createElement(ci,null,n?pe.a.createElement("p",{className:"textBefore"},n):null,(t=i,pe.a.createElement("div",null,t.map(function(e){return e.link?pe.a.createElement(li,{key:e.value},pe.a.createElement(si,{target:"_blank",href:e.link},e.text)):pe.a.createElement(li,{key:e.value},pe.a.createElement(di,{onClick:function(){return c(e.text.trim().replace(/^\d+\.\s+/,""))}},e.text))}))),a?pe.a.createElement("p",null,a):null,o?pe.a.createElement(ui,null,o):null)}function mi(e){var t=e.content,n=e.handleImagePreview;return pe.a.createElement(hi,{onClick:function(e){"IMG"===e.target.nodeName&&e.target.src&&n(e.target.src)},dangerouslySetInnerHTML:{__html:t}})}function fi(e){return X.isMobile()&&X.isSafari()?[[RegExp("^".concat(e,"$"),"gm"),'<a target="_parent" href="tel:$1">$1</a>'],[RegExp("^".concat(e,"(\\D)"),"gm"),'<a target="_parent" href="tel:$1">$1</a>$2'],[RegExp("(\\D)".concat(e,"$"),"gm"),'$1<a target="_parent" href="tel:$2">$2</a>'],[RegExp("(\\D)".concat(e,"(\\D)"),"gm"),'$1<a target="_parent" href="tel:$2">$2</a>$3']]:[[RegExp("^".concat(e,"$"),"gm"),'<a target="_blank" href="tel:$1">$1</a>'],[RegExp("^".concat(e,"(\\D)"),"gm"),'<a target="_blank" href="tel:$1">$1</a>$2'],[RegExp("(\\D)".concat(e,"$"),"gm"),'$1<a target="_blank" href="tel:$2">$2</a>'],[RegExp("(\\D)".concat(e,"(\\D)"),"gm"),'$1<a target="_blank" href="tel:$2">$2</a>$3']]}var hi=d.d.div.withConfig({displayName:"msg-rich__RichWrapper",componentId:"sc-11bxmta-0"})(["width:100%;display:inline-block;overflow:hidden;"]),gi=pe.a.memo(function(e){var t=e.content,n=e.handleMenuClick,a=e.handleImagePreview,o=nt()(t)?t:[t],i=Object(me.c)(),r=ra()(i,1)[0];return pe.a.createElement("div",null,o.map(function(e,t){return"string"==typeof e?pe.a.createElement("div",{key:t},pe.a.createElement(mi,{content:e,handleImagePreview:a})):"object"===p()(e)&&"menu"===e.type?pe.a.createElement("div",{key:t},pe.a.createElement(pi,{handleMenuClick:n,items:e.items,textBefore:e.textBefore,menuTip:r("点击问题或回复数字查看答案")})):pe.a.createElement("div",{key:t},pe.a.createElement(mi,{content:e}))}))}),bi=n(462),vi=n.n(bi),_i=[];_i=(_i=(_i=(_i=_i.concat(fi("([1]\\d{10})"))).concat(fi("([48]00\\d?-?\\d{3,4}-?\\d{3,4})"))).concat(fi("(0\\d{2,3}-?\\d{7,8})"))).concat(fi("(\\d{8})"));function wi(e,t){var n=document.createElement("div");n.innerHTML=e;for(var a=0,o=n.childNodes.length;a<o;a+=1){var i=n.childNodes[a];if(3===i.nodeType){var r=document.createElement("em");r.appendChild(i.cloneNode(!0));var c=r.innerHTML;r.innerHTML=r.innerHTML.replace(t[0],t[1]),r.innerHTML!==c&&n.replaceChild(r,i)}}return n.innerHTML.replace(/<em>/g,"").replace(/<\/em>/g,"").replace(/&nbsp;/," ")}function yi(e){var t=e;return m()(_i).forEach(function(e){t=wi(t,_i[e])}),t}function xi(e){return e.replace(/\n/g,"<br/>")}function ki(t,e,n,a){var o,i="<img class='".concat(n,"' src='").concat(e,"/").concat(encodeURIComponent(t[1]),".png' "),r=a.attributes;return m()(r).forEach(function(e){o=r[e],i+="".concat(e,"='").concat(o.apply(a,t),"' ")}),"".concat(i,"/>")}var Ei=yi,Ii=xi,Ci={title:function(e,t,n){return null!=n?"".concat(n," (").concat(t,")"):t},alt:function(e){return e}},Ti=/:([a-z0-9_+-]+)(?:\[((?:[^\]]|\][^:])*\]?)\])?:/g,Si=function(e,a,t){var o=t,i=["+1","-1","100","1234","8ball","a","ab","abc","abcd","accept","aerial_tramway","airplane","alarm_clock","alien","ambulance","anchor","angel","anger","angry","anguished","ant","apple","aquarius","aries","arrow_backward","arrow_double_down","arrow_double_up","arrow_down","arrow_down_small","arrow_forward","arrow_heading_down","arrow_heading_up","arrow_left","arrow_lower_left","arrow_lower_right","arrow_right","arrow_right_hook","arrow_up","arrow_up_down","arrow_up_small","arrow_upper_left","arrow_upper_right","arrows_clockwise","arrows_counterclockwise","art","articulated_lorry","astonished","atm","b","baby","baby_bottle","baby_chick","baby_symbol","baggage_claim","balloon","ballot_box_with_check","bamboo","banana","bangbang","bank","bar_chart","barber","baseball","basketball","bath","bathtub","battery","bear","bee","beer","beers","beetle","beginner","bell","bento","bicyclist","bike","bikini","bird","birthday","black_circle","black_joker","black_nib","black_square","black_square_button","blossom","blowfish","blue_book","blue_car","blue_heart","blush","boar","boat","bomb","book","bookmark","bookmark_tabs","books","boom","boot","bouquet","bow","bowling","bowtie","boy","bread","bride_with_veil","bridge_at_night","briefcase","broken_heart","bug","bulb","bullettrain_front","bullettrain_side","bus","busstop","bust_in_silhouette","busts_in_silhouette","cactus","cake","calendar","calling","camel","camera","cancer","candy","capital_abcd","capricorn","car","card_index","carousel_horse","cat","cat2","cd","chart","chart_with_downwards_trend","chart_with_upwards_trend","checkered_flag","cherries","cherry_blossom","chestnut","chicken","children_crossing","chocolate_bar","christmas_tree","church","cinema","circus_tent","city_sunrise","city_sunset","cl","clap","clapper","clipboard","clock1","clock10","clock1030","clock11","clock1130","clock12","clock1230","clock130","clock2","clock230","clock3","clock330","clock4","clock430","clock5","clock530","clock6","clock630","clock7","clock730","clock8","clock830","clock9","clock930","closed_book","closed_lock_with_key","closed_umbrella","cloud","clubs","cn","cocktail","coffee","cold_sweat","collision","computer","confetti_ball","confounded","confused","congratulations","construction","construction_worker","convenience_store","cookie","cool","cop","copyright","corn","couple","couple_with_heart","couplekiss","cow","cow2","credit_card","crocodile","crossed_flags","crown","cry","crying_cat_face","crystal_ball","cupid","curly_loop","currency_exchange","curry","custard","customs","cyclone","dancer","dancers","dango","dart","dash","date","de","deciduous_tree","department_store","diamond_shape_with_a_dot_inside","diamonds","disappointed","disappointed_relieved","dizzy","dizzy_face","do_not_litter","dog","dog2","dollar","dolls","dolphin","donut","door","doughnut","dragon","dragon_face","dress","dromedary_camel","droplet","dvd","e-mail","ear","ear_of_rice","earth_africa","earth_americas","earth_asia","egg","eggplant","eight","eight_pointed_black_star","eight_spoked_asterisk","electric_plug","elephant","email","end","envelope","es","euro","european_castle","european_post_office","evergreen_tree","exclamation","expressionless","eyeglasses","eyes","facepunch","factory","fallen_leaf","family","fast_forward","fax","fearful","feelsgood","feet","ferris_wheel","file_folder","finnadie","fire","fire_engine","fireworks","first_quarter_moon","first_quarter_moon_with_face","fish","fish_cake","fishing_pole_and_fish","fist","five","flags","flashlight","floppy_disk","flower_playing_cards","flushed","foggy","football","fork_and_knife","fountain","four","four_leaf_clover","fr","free","fried_shrimp","fries","frog","frowning","fu","fuelpump","full_moon","full_moon_with_face","game_die","gb","gem","gemini","ghost","gift","gift_heart","girl","globe_with_meridians","goat","goberserk","godmode","golf","grapes","green_apple","green_book","green_heart","grey_exclamation","grey_question","grimacing","grin","grinning","guardsman","guitar","gun","haircut","hamburger","hammer","hamster","hand","handbag","hankey","hash","hatched_chick","hatching_chick","headphones","hear_no_evil","heart","heart_decoration","heart_eyes","heart_eyes_cat","heartbeat","heartpulse","hearts","heavy_check_mark","heavy_division_sign","heavy_dollar_sign","heavy_exclamation_mark","heavy_minus_sign","heavy_multiplication_x","heavy_plus_sign","helicopter","herb","hibiscus","high_brightness","high_heel","hocho","honey_pot","honeybee","horse","horse_racing","hospital","hotel","hotsprings","hourglass","hourglass_flowing_sand","house","house_with_garden","hurtrealbad","hushed","ice_cream","icecream","id","ideograph_advantage","imp","inbox_tray","incoming_envelope","information_desk_person","information_source","innocent","interrobang","iphone","it","izakaya_lantern","jack_o_lantern","japan","japanese_castle","japanese_goblin","japanese_ogre","jeans","joy","joy_cat","jp","key","keycap_ten","kimono","kiss","kissing","kissing_cat","kissing_closed_eyes","kissing_face","kissing_heart","kissing_smiling_eyes","koala","koko","kr","large_blue_circle","large_blue_diamond","large_orange_diamond","last_quarter_moon","last_quarter_moon_with_face","laughing","leaves","ledger","left_luggage","left_right_arrow","leftwards_arrow_with_hook","lemon","leo","leopard","libra","light_rail","link","lips","lipstick","lock","lock_with_ink_pen","lollipop","loop","loudspeaker","love_hotel","love_letter","low_brightness","m","mag","mag_right","mahjong","mailbox","mailbox_closed","mailbox_with_mail","mailbox_with_no_mail","man","man_with_gua_pi_mao","man_with_turban","mans_shoe","maple_leaf","mask","massage","meat_on_bone","mega","melon","memo","mens","metal","metro","microphone","microscope","milky_way","minibus","minidisc","mobile_phone_off","money_with_wings","moneybag","monkey","monkey_face","monorail","moon","mortar_board","mount_fuji","mountain_bicyclist","mountain_cableway","mountain_railway","mouse","mouse2","movie_camera","moyai","muscle","mushroom","musical_keyboard","musical_note","musical_score","mute","nail_care","name_badge","neckbeard","necktie","negative_squared_cross_mark","neutral_face","new","new_moon","new_moon_with_face","newspaper","ng","nine","no_bell","no_bicycles","no_entry","no_entry_sign","no_good","no_mobile_phones","no_mouth","no_pedestrians","no_smoking","non-potable_water","nose","notebook","notebook_with_decorative_cover","notes","nut_and_bolt","o","o2","ocean","octocat","octopus","oden","office","ok","ok_hand","ok_woman","older_man","older_woman","on","oncoming_automobile","oncoming_bus","oncoming_police_car","oncoming_taxi","one","open_file_folder","open_hands","open_mouth","ophiuchus","orange_book","outbox_tray","ox","page_facing_up","page_with_curl","pager","palm_tree","panda_face","paperclip","parking","part_alternation_mark","partly_sunny","passport_control","paw_prints","peach","pear","pencil","pencil2","penguin","pensive","performing_arts","persevere","person_frowning","person_with_blond_hair","person_with_pouting_face","phone","pig","pig2","pig_nose","pill","pineapple","pisces","pizza","plus1","point_down","point_left","point_right","point_up","point_up_2","police_car","poodle","poop","post_office","postal_horn","postbox","potable_water","pouch","poultry_leg","pound","pouting_cat","pray","princess","punch","purple_heart","purse","pushpin","put_litter_in_its_place","question","rabbit","rabbit2","racehorse","radio","radio_button","rage","rage1","rage2","rage3","rage4","railway_car","rainbow","raised_hand","raised_hands","raising_hand","ram","ramen","rat","recycle","red_car","red_circle","registered","relaxed","relieved","repeat","repeat_one","restroom","revolving_hearts","rewind","ribbon","rice","rice_ball","rice_cracker","rice_scene","ring","rocket","roller_coaster","rooster","rose","rotating_light","round_pushpin","rowboat","ru","rugby_football","runner","running","running_shirt_with_sash","sa","sagittarius","sailboat","sake","sandal","santa","satellite","satisfied","saxophone","school","school_satchel","scissors","scorpius","scream","scream_cat","scroll","seat","secret","see_no_evil","seedling","seven","shaved_ice","sheep","shell","ship","shipit","shirt","shit","shoe","shower","signal_strength","six","six_pointed_star","ski","skull","sleeping","sleepy","slot_machine","small_blue_diamond","small_orange_diamond","small_red_triangle","small_red_triangle_down","smile","smile_cat","smiley","smiley_cat","smiling_imp","smirk","smirk_cat","smoking","snail","snake","snowboarder","snowflake","snowman","sob","soccer","soon","sos","sound","space_invader","spades","spaghetti","sparkler","sparkles","sparkling_heart","speak_no_evil","speaker","speech_balloon","speedboat","squirrel","star","star2","stars","station","statue_of_liberty","steam_locomotive","stew","straight_ruler","strawberry","stuck_out_tongue","stuck_out_tongue_closed_eyes","stuck_out_tongue_winking_eye","sun_with_face","sunflower","sunglasses","sunny","sunrise","sunrise_over_mountains","surfer","sushi","suspect","suspension_railway","sweat","sweat_drops","sweat_smile","sweet_potato","swimmer","symbols","syringe","tada","tanabata_tree","tangerine","taurus","taxi","tea","telephone","telephone_receiver","telescope","tennis","tent","thought_balloon","three","thumbsdown","thumbsup","ticket","tiger","tiger2","tired_face","tm","toilet","tokyo_tower","tomato","tongue","top","tophat","tractor","traffic_light","train","train2","tram","triangular_flag_on_post","triangular_ruler","trident","triumph","trolleybus","trollface","trophy","tropical_drink","tropical_fish","truck","trumpet","tshirt","tulip","turtle","tv","twisted_rightwards_arrows","two","two_hearts","two_men_holding_hands","two_women_holding_hands","u5272","u5408","u55b6","u6307","u6708","u6709","u6e80","u7121","u7533","u7981","u7a7a","uk","umbrella","unamused","underage","unlock","up","us","v","vertical_traffic_light","vhs","vibration_mode","video_camera","video_game","violin","virgo","volcano","vs","walking","waning_crescent_moon","waning_gibbous_moon","warning","watch","water_buffalo","watermelon","wave","wavy_dash","waxing_crescent_moon","waxing_gibbous_moon","wc","weary","wedding","whale","whale2","wheelchair","white_check_mark","white_circle","white_flower","white_large_square","white_square_button","wind_chime","wine_glass","wink","wolf","woman","womans_clothes","womans_hat","womens","worried","wrench","x","yellow_heart","yen","yum","zap","zero","zzz"];null==o&&(o={}),"function"==typeof o?o={parser:o}:(null==o.attributes&&(o.attributes=Ci),null==o.parser&&(o.parser=ki));var r=null!=o.classes?o.classes:"emoji";return e.replace(Ti,function(e,t,n){return-1===i.indexOf(t)?e:o.parser([e,t,n],a,r,o)})},ji=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return function(e){var t=e;return n.forEach(function(e){t=e(t)}),t}}(function(e){return vi()(e)},function(e){return Ei(e)},function(e){return Ii(e)},function(e){return Si(e,"".concat(S.public,"emoji"))});return nt()(e)?e.map(function(e){return t(e)}):t(e)};function Ni(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}var Oi=pe.a.memo(function(e){var t=e.content.map(function(e){var t=null;return"text"===e.type?t=e.rich_text||ji(e.text):"menu"!==e.type&&"related"!==e.type||(t={type:"menu",items:e.items.map(function(e){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ni(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):Ni(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},e,{text:ji(e.text)})}),textBefore:e.text_before}),t});return pe.a.createElement(gi,Qa()({},e,{content:t}))}),Mi=d.d.a.withConfig({displayName:"msg-pic__ImgWrapper",componentId:"ii1wvc-0"})(["width:auto;max-width:100%;cursor:pointer;"]),Di=d.d.img.withConfig({displayName:"msg-pic__Img",componentId:"ii1wvc-1"})(["max-width:100%;max-height:",";"],function(e){return e.loadStatus?"280px":"30px"});function zi(e){var t=e.id,n=e.url,a=e.status,o=e.handleOnload,i=void 0===o?function(){}:o,r=e.handleImagePreview,c={},l=Object(ue.useState)(!0),s=ra()(l,2),d=s[0],u=s[1],p=Object(ue.useCallback)(i,[]);return"error"===a||"sending"===a||X.isMobile()?c.href="javascript:void(0);":(c.target="_blank",c.href=n),pe.a.createElement(Mi,c,pe.a.createElement(Di,{src:n,alt:"图片加载失败",loadStatus:d,onClick:function(e){"IMG"===e.target.nodeName&&e.target.src&&r(e.target.src)},onLoad:function(){return p(t)},onError:function(){u(!1),p(t)}}))}var Bi=d.d.div.withConfig({displayName:"msg-file__FileWrapper",componentId:"m3rns3-0"})(["width:100%;position:relative;padding-left:50px;box-sizing:border-box;background:#fff;&:after{content:' ';display:table;clear:both;}"]),Pi=d.d.div.withConfig({displayName:"msg-file__FileIcon",componentId:"m3rns3-1"})(["position:absolute;left:0;top:0;bottom:0;"]),Ai=d.d.div.withConfig({displayName:"msg-file__FileInfo",componentId:"m3rns3-2"})(["width:100%;min-width:130px;height:42px;"]),qi=d.d.div.withConfig({displayName:"msg-file__FileDiv",componentId:"m3rns3-3"})(["text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:12px;text-align:left;"]),Ri=d.d.div.withConfig({displayName:"msg-file__FileTitle",componentId:"m3rns3-4"})(["position:relative;box-sizing:border-box;text-align:left;.name{padding-right:56px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;font-size:12px;color:#333;}.size{position:absolute;top:0;right:0;font-size:12px;color:#777;}"]),Li=Object(d.d)(qi).withConfig({displayName:"msg-file__FileStatus",componentId:"m3rns3-5"})(["color:#777;margin-top:10px;"]),Ui=d.d.div.withConfig({displayName:"msg-file__FileSpeed",componentId:"m3rns3-6"})(["width:70%;font-size:12px;color:#777;text-align:left;margin-top:3px;"]),Fi=d.d.div.withConfig({displayName:"msg-file__Upload",componentId:"m3rns3-7"})(["position:absolute;z-index:10;top:26px;width:70%;padding-right:0;box-sizing:border-box;"]),Wi=d.d.div.withConfig({displayName:"msg-file__UploadHolder",componentId:"m3rns3-8"})(["width:100%;height:3px;background:#f4f4f4;position:relative;"]),Gi=d.d.div.withConfig({displayName:"msg-file__UploadProgress",componentId:"m3rns3-9"})(["width:","%;max-width:100%;height:3px;background:#4ca0ff;position:absolute;left:0;top:0;bottom:0;"],function(e){return e.progress}),Vi=Object(d.d)(Io).withConfig({displayName:"msg-file__UploadCancel",componentId:"m3rns3-10"})(["position:absolute;right:-18px;top:-9px;"]),Hi=Object(d.d)(Io).withConfig({displayName:"msg-file__Download",componentId:"m3rns3-11"})(["cursor:pointer;position:absolute;right:0;bottom:0;vertical-align:middle;& > a{text-decoration:none;font-size:12px;color:#4ca0ff;display:inline-block;vertical-align:middle;}"]);function Qi(e){var t=e.id,n=e.fileName,a=e.fileSize,o=e.fileStatus,i=e.fileUrl,r=e.status,c=e.progress,l=e.speed,s=e.cancelUpload,d=e.disableDownload,u=e.handleFileDownload,p=Object(me.c)(),m=ra()(p,1)[0];return pe.a.createElement(Bi,null,pe.a.createElement(Pi,null,pe.a.createElement(Io,{width:"40px",height:"40px",type:"file-icon"})),pe.a.createElement(Ai,null,pe.a.createElement(Ri,null,pe.a.createElement("div",{className:"name"},n),pe.a.createElement("div",{className:"size"},a)),"uploading"===r?pe.a.createElement(Fi,null,pe.a.createElement(Wi,null,pe.a.createElement(Gi,{progress:c}),pe.a.createElement(Vi,{type:"cancel",width:"19px",height:"19px",onClick:function(){return s(t)}})),pe.a.createElement(Ui,null,"".concat(m("上传中")," ").concat(l))):pe.a.createElement(Li,null,o),"uploading"===r||"cancel"===r||d?null:pe.a.createElement(Hi,{type:"download",width:"20px",height:"20px"},pe.a.createElement("a",{href:i,rel:"noopener noreferrer",target:"_blank",onClick:function(){return u(t)}},m("下载")))))}var Yi=d.d.span.withConfig({displayName:"msg-forward__Name",componentId:"jo8bzh-0"})(["color:#2ac8d1;padding:0 4px;"]);function $i(e){var t=e.name;return pe.a.createElement("span",null,pe.a.createElement(me.a,null,"接下来由",pe.a.createElement(Yi,null,{name:t}),"为您服务"))}var Ji=d.d.span.withConfig({displayName:"msg-evaluation__Assess",componentId:"bhk0uy-0"})(["color:",";padding:0 4px;"],function(e){return 2===e.level?"#00ce7d":1===e.level?"#ffb652":"#ff5c5e"});function Ki(e){var t=e.level,n=e.levelText,a=e.content,o=Object(me.c)(),i=ra()(o,1)[0];return pe.a.createElement("div",null,pe.a.createElement("span",null,i("你给出了"),pe.a.createElement(Ji,{level:t},n)),a?pe.a.createElement("span",null,pe.a.createElement("br",null),a):null)}var Zi=d.d.div.withConfig({displayName:"msg-system__Container",componentId:"sc-1pwbj0o-0"})(["width:100%;color:#999;font-size:12px;text-align:center;margin-bottom:20px;"]),Xi=pe.a.memo(function(e){return pe.a.createElement(Zi,null,e.children)}),er=d.d.span.withConfig({displayName:"msg-link__Name",componentId:"sc-1a5zov3-0"})(["color:#6088e6;padding:0 4px;cursor:pointer;"]);function tr(e){var t=e.handleClick,n=e.children,a=e.prevContent,o=void 0===a?null:a,i=e.afterContent,r=void 0===i?null:i;return pe.a.createElement(Xi,null,o,pe.a.createElement(er,{onClick:t},n),r)}var nr=d.d.a.attrs({href:"javascript:void(0)"}).withConfig({displayName:"button__Anchor",componentId:"sc-1v9a63l-0"})(["width:",";height:",";line-height:",";display:inline-block;vertical-align:middle;font-size:",";border:0;outline:none;border-radius:3px;cursor:pointer;text-align:center;text-decoration:none;opacity:",";color:",";background:",";&:hover{color:",";background:",";opacity:1;}"],function(e){return e.width||"60px"},function(e){return e.height||"30px"},function(e){return e.height||"30px"},function(e){return e.fontSize||"13px"},function(e){return e.opacity||1},function(e){return e.disabled?"#fff":e.fontColor||"#000"},function(e){return e.disabled?"#aaa":e.bgColor||"#fff"},function(e){return e.disabled?"#fff":e.fontHoverColor||e.fontColor},function(e){return e.disabled?"#aaa":e.bgHoverColor||e.bgColor});function ar(e){var t=e.handleClick,n=e.data,a=(e.children,e.disabled),o=po()(e,["handleClick","data","children","disabled"]),i=Object(ue.useCallback)(function(){a||t(n)},[t,n,a]);return pe.a.createElement(nr,Qa()({},o,{disabled:a,onClick:i}),e.children||null)}function or(e){var t=e.name,i=e.multi,n=e.options,a=e.value,r=e.handleChange,o=nt()(a)?a.join(", "):a;return pe.a.createElement(lr,null,pe.a.createElement(sr,{name:t,multiple:i,value:a,onChange:function(e){if(i){for(var t=e.target.options,n=[],a=0,o=t.length;a<o;a+=1)t[a].selected&&n.push(t[a].value);r(n)}else r(e.target.value)}},i?null:pe.a.createElement("option",{disabled:!0,value:!0,selected:!0,style:{display:"none"}}),n.map(function(e){return pe.a.createElement("option",{key:e.value,value:e.value},e.label)})),pe.a.createElement(dr,null,o))}function ir(e){function n(e){var t=e.target,n=t.value,a=t.checked,o=ie()(u);if(a)p(o.concat([n])),l(o.concat([n]));else{var i=o.findIndex(function(e){return e===n});o.splice(i,1),p(o),l(o)}}var t,a,o=e.name,i=e.options,r=e.multi,c=e.value,l=e.handleChange,s=Object(ue.useState)([]),d=ra()(s,2),u=d[0],p=d[1];return r?(a=i,pe.a.createElement(ur,null,a.map(function(e,t){return pe.a.createElement("label",{key:t,className:"item"},pe.a.createElement("input",{name:o,type:"checkbox",value:e.value,onChange:n}),e.label)}))):(t=i,pe.a.createElement(pr,{name:o,value:c,onChange:function(e){return l(e.target.value)}},pe.a.createElement("option",{value:""}," "),t.map(function(e){return pe.a.createElement("option",{key:e.value,value:e.value},e.label)})))}function rr(e){return X.isMobile()?pe.a.createElement(or,e):pe.a.createElement(ir,e)}function cr(e){var t=e.value,n=e.handleChange;return pe.a.createElement(fr,null,pe.a.createElement(hr,null,pe.a.createElement("input",{type:"datetime-local",onChange:function(e){n(new Date(e.target.value.replace(/-/g,"/").replace("T"," ")))}})),pe.a.createElement(gr,null,t?t.toLocaleString():""))}var lr=d.d.div.withConfig({displayName:"mobile-select__Container",componentId:"sc-6uf7qh-0"})(["width:100%;height:28px;position:relative;box-sizing:border-box;"]),sr=d.d.select.withConfig({displayName:"mobile-select__Select",componentId:"sc-6uf7qh-1"})(["opacity:0;width:100%;position:absolute;top:0;bottom:0;left:0;right:0;"]),dr=d.d.div.withConfig({displayName:"mobile-select__Mask",componentId:"sc-6uf7qh-2"})(["width:100%;height:28px;line-height:28px;border-radius:2px;padding:0 5px;box-sizing:border-box;color:#4a4a4a;background-color:#fff;box-shadow:inset 0px 1px 6px 0px rgba(0,0,0,0.1);border:1px solid rgba(199,199,199,1);"]),ur=d.d.div.withConfig({displayName:"pc-select__CheckboxContainer",componentId:"ylovj-0"})(["margin:0;.item{display:block;color:#333333;padding:5px 0;}"]),pr=d.d.select.withConfig({displayName:"pc-select__Select",componentId:"ylovj-1"})(["height:28px;width:100%;display:block;outline:none;background:#fff;box-shadow:inset 0px 1px 6px 0px rgba(0,0,0,0.1);border:1px solid rgba(199,199,199,1);"]),mr=n(477),fr=d.d.div.withConfig({displayName:"mobile-picker__Container",componentId:"qq62kn-0"})(["width:100%;height:28px;position:relative;box-sizing:border-box;"]),hr=d.d.label.withConfig({displayName:"mobile-picker__Label",componentId:"qq62kn-1"})(["opacity:0;position:absolute;top:0;bottom:0;left:0;right:0;"]),gr=d.d.div.withConfig({displayName:"mobile-picker__Mask",componentId:"qq62kn-2"})(["width:100%;height:28px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;line-height:28px;border-radius:2px;padding:0 5px;box-sizing:border-box;color:#4a4a4a;background-color:#fff;box-shadow:inset 0px 1px 6px 0px rgba(0,0,0,0.1);border:1px solid rgba(199,199,199,1);"]),br=n(55),vr=n.n(br),_r=n(56),wr=n.n(_r),yr=n(57),xr=n.n(yr),kr=n(58),Er=n.n(kr),Ir=n(43),Cr=n.n(Ir),Tr=n(59),Sr=n.n(Tr),jr=n(2),Nr=n.n(jr),Or=function(e){function n(e){var t;return vr()(this,n),(t=xr()(this,Er()(n).call(this,e))).updateSelectedDate=t.updateSelectedDate.bind(Cr()(t)),t}return Sr()(n,e),wr()(n,[{key:"render",value:function(){var e=this.renderFooter(),t=this.props.viewDate,n=t.localeData(),a=[pe.a.createElement("thead",{key:"th"},[pe.a.createElement("tr",{key:"h"},[pe.a.createElement("th",{key:"p",className:"rdtPrev",onClick:this.props.subtractTime(1,"months")},pe.a.createElement("span",{},"‹")),pe.a.createElement("th",{key:"s",className:"rdtSwitch",onClick:this.props.showView("months"),colSpan:5,"data-value":this.props.viewDate.month()},"".concat(n.months(t)," ").concat(t.year())),pe.a.createElement("th",{key:"n",className:"rdtNext",onClick:this.props.addTime(1,"months")},pe.a.createElement("span",{},"›"))]),pe.a.createElement("tr",{key:"d"},this.getDaysOfWeek(n).map(function(e,t){return pe.a.createElement("th",{key:e+t,className:"dow"},e)}))]),pe.a.createElement("tbody",{key:"tb"},this.renderDays())];return e&&a.push(e),pe.a.createElement("div",{className:"rdtDays"},pe.a.createElement("table",{},a))}},{key:"getDaysOfWeek",value:function(e){var t=e._weekdaysMin,n=e.firstDayOfWeek(),a=[],o=0;return t.forEach(function(e){a[(7+o-n)%7]=e,o+=1}),a}},{key:"renderDays",value:function(){var e,t,n,a,o=this.props.viewDate,i=this.props.selectedDate&&this.props.selectedDate.clone(),r=o.clone().subtract(1,"months"),c=o.year(),l=o.month(),s=[],d=[],u=this.props.renderDay||this.renderDay,p=this.props.isValidDate||this.alwaysValidDate;r.date(r.daysInMonth()).startOf("week");for(var m=r.clone().add(42,"d");r.isBefore(m);)e="rdtDay",a=r.clone(),r.year()===c&&r.month()<l||r.year()<c?e+=" rdtOld":(r.year()===c&&r.month()>l||r.year()>c)&&(e+=" rdtNew"),i&&r.isSame(i,"day")&&(e+=" rdtActive"),r.isSame(Nr()(),"day")&&(e+=" rdtToday"),(t=!p(a,i))&&(e+=" rdtDisabled"),n={key:r.format("M_D"),"data-value":r.date(),className:e},t||(n.onClick=this.updateSelectedDate),d.push(u(n,a,i)),7===d.length&&(s.push(pe.a.createElement("tr",{key:r.format("M_D")},d)),d=[]),r.add(1,"d");return s}},{key:"updateSelectedDate",value:function(e){this.props.updateSelectedDate(e,!0)}},{key:"renderDay",value:function(e,t){return pe.a.createElement("td",e,t.date())}},{key:"renderFooter",value:function(){if(!this.props.timeFormat)return"";var e=this.props.selectedDate||this.props.viewDate;return pe.a.createElement("tfoot",{key:"tf"},pe.a.createElement("tr",{},pe.a.createElement("td",{onClick:this.props.showView("time"),colSpan:7,className:"rdtTimeToggle"},e.format(this.props.timeFormat))))}},{key:"alwaysValidDate",value:function(){return 1}}]),n}(pe.a.Component),Mr=n(143),Dr=n.n(Mr);var zr=function(e){function t(){return vr()(this,t),xr()(this,Er()(t).apply(this,arguments))}return Sr()(t,e),wr()(t,[{key:"render",value:function(){return pe.a.createElement("div",{className:"rdtMonths"},[pe.a.createElement("table",{key:"a"},pe.a.createElement("thead",{},pe.a.createElement("tr",{},[pe.a.createElement("th",{key:"prev",className:"rdtPrev",onClick:this.props.subtractTime(1,"years")},pe.a.createElement("span",{},"‹")),pe.a.createElement("th",{key:"year",className:"rdtSwitch",onClick:this.props.showView("years"),colSpan:2,"data-value":this.props.viewDate.year()},this.props.viewDate.year()),pe.a.createElement("th",{key:"next",className:"rdtNext",onClick:this.props.addTime(1,"years")},pe.a.createElement("span",{},"›"))]))),pe.a.createElement("table",{key:"months"},pe.a.createElement("tbody",{key:"b"},this.renderMonths()))])}},{key:"renderMonths",value:function(){for(var e,t,n,a,o,i=this.props.selectedDate,r=this.props.viewDate.month(),c=this.props.viewDate.year(),l=[],s=0,d=[],u=(this.props.renderMonth||this.renderMonth).bind(this),p=this.props.isValidDate||this.alwaysValidDate;s<12;)e="rdtMonth",o=(n=this.props.viewDate.clone().set({year:c,month:s,date:1})).endOf("month").format("D"),(a=void 0===Dr()({length:o},function(e,t){return t+1}).find(function(e){var t=n.clone().set("date",e);return p(t)}))&&(e+=" rdtDisabled"),i&&s===i.month()&&c===i.year()&&(e+=" rdtActive"),t={key:s,"data-value":s,className:e},a||(t.onClick="months"===this.props.updateOn?this.updateSelectedMonth:this.props.setDate("month")),d.push(u(t,s,c,i&&i.clone())),4===d.length&&(l.push(pe.a.createElement("tr",{key:"".concat(r,"_").concat(l.length)},d)),d=[]),s+=1;return l}},{key:"updateSelectedMonth",value:function(e){this.props.updateSelectedDate(e)}},{key:"renderMonth",value:function(e,t){var n=this.props.viewDate,a=n.localeData().monthsShort(n.month(t)).substring(0,3);return pe.a.createElement("td",e,function(e){return e.charAt(0).toUpperCase()+e.slice(1)}(a))}},{key:"alwaysValidDate",value:function(){return 1}}]),t}(pe.a.Component),Br=function(e){function t(){return vr()(this,t),xr()(this,Er()(t).apply(this,arguments))}return Sr()(t,e),wr()(t,[{key:"render",value:function(){var e=10*K()(this.props.viewDate.year()/10,10);return pe.a.createElement("div",{className:"rdtYears"},[pe.a.createElement("table",{key:"a"},pe.a.createElement("thead",{},pe.a.createElement("tr",{},[pe.a.createElement("th",{key:"prev",className:"rdtPrev",onClick:this.props.subtractTime(10,"years")},pe.a.createElement("span",{},"‹")),pe.a.createElement("th",{key:"year",className:"rdtSwitch",onClick:this.props.showView("years"),colSpan:2},"".concat(e,"-").concat(9+e)),pe.a.createElement("th",{key:"next",className:"rdtNext",onClick:this.props.addTime(10,"years")},pe.a.createElement("span",{},"›"))]))),pe.a.createElement("table",{key:"years"},pe.a.createElement("tbody",{},this.renderYears(e)))])}},{key:"renderYears",value:function(e){var t,n,a,o,i,r=e,c=[],l=-1,s=[],d=this.props.renderYear||this.renderYear,u=this.props.selectedDate,p=this.props.isValidDate||this.alwaysValidDate;for(r-=1;l<11;)t="rdtYear",i=(a=this.props.viewDate.clone().set({year:r,month:0,date:1})).endOf("year").format("DDD"),(o=void 0===Dr()({length:i},function(e,t){return t+1}).find(function(e){var t=a.clone().dayOfYear(e);return p(t)}))&&(t+=" rdtDisabled"),u&&u.year()===r&&(t+=" rdtActive"),n={key:r,"data-value":r,className:t},o||(n.onClick="years"===this.props.updateOn?this.updateSelectedYear:this.props.setDate("year")),c.push(d(n,r,u&&u.clone())),4===c.length&&(s.push(pe.a.createElement("tr",{key:l},c)),c=[]),r+=1,l+=1;return s}},{key:"updateSelectedYear",value:function(e){this.props.updateSelectedDate(e)}},{key:"renderYear",value:function(e,t){return pe.a.createElement("td",e,t)}},{key:"alwaysValidDate",value:function(){return 1}}]),t}(pe.a.Component),Pr=function(e){function n(e){var t;return vr()(this,n),(t=xr()(this,Er()(n).call(this,e))).mouseUpListener=function(e){return function(){clearTimeout(t.timer),clearInterval(t.increaseTimer),t.props.setTime(e,t.state[e])}},t.padValues={hours:1,minutes:2,seconds:2,milliseconds:3},t.state=t.calculateState(e),t}return Sr()(n,e),wr()(n,[{key:"calculateState",value:function(e){var t=e.selectedDate||e.viewDate,n=e.timeFormat,a=[];-1!==n.toLowerCase().indexOf("h")&&(a.push("hours"),-1!==n.indexOf("m")&&(a.push("minutes"),-1!==n.indexOf("s")&&a.push("seconds")));var o=t.format("H"),i=!1;return null!==this.state&&-1!==this.props.timeFormat.toLowerCase().indexOf(" a")&&(i=-1!==this.props.timeFormat.indexOf(" A")?12<=o?"PM":"AM":12<=o?"pm":"am"),{hours:o,minutes:t.format("mm"),seconds:t.format("ss"),milliseconds:t.format("SSS"),daypart:i,counters:a}}},{key:"renderCounter",value:function(e){if("daypart"===e)return"";var t=this.state[e];return"hours"===e&&-1!==this.props.timeFormat.toLowerCase().indexOf(" a")&&0===(t=(t-1)%12+1)&&(t=12),pe.a.createElement("div",{key:e,className:"rdtCounter"},[pe.a.createElement("span",{key:"up",className:"rdtBtn",onMouseDown:this.onStartClicking("increase",e),onMouseUp:this.mouseUpListener(e),onContextMenu:this.disableContextMenu},"▲"),pe.a.createElement("div",{key:"c",className:"rdtCount"},t),pe.a.createElement("span",{key:"do",className:"rdtBtn",onMouseDown:this.onStartClicking("decrease",e),onMouseUp:this.mouseUpListener(e),onContextMenu:this.disableContextMenu},"▼")])}},{key:"renderDayPart",value:function(){return pe.a.createElement("div",{key:"dayPart",className:"rdtCounter"},[pe.a.createElement("span",{key:"up",className:"rdtBtn",onMouseDown:this.onStartClicking("toggleDayPart","hours"),onMouseUp:this.mouseUpListener("hours"),onContextMenu:this.disableContextMenu},"▲"),pe.a.createElement("div",{key:this.state.daypart,className:"rdtCount"},this.state.daypart),pe.a.createElement("span",{key:"do",className:"rdtBtn",onMouseDown:this.onStartClicking("toggleDayPart","hours"),onMouseUp:this.mouseUpListener("hours"),onContextMenu:this.disableContextMenu},"▼")])}},{key:"render",value:function(){var t=this,n=[];return this.state.counters.forEach(function(e){n.length&&n.push(pe.a.createElement("div",{key:"sep".concat(n.length),className:"rdtCounterSeparator"},":")),n.push(t.renderCounter(e))}),!1!==this.state.daypart&&n.push(t.renderDayPart()),3===this.state.counters.length&&-1!==this.props.timeFormat.indexOf("S")&&(n.push(pe.a.createElement("div",{className:"rdtCounterSeparator",key:"sep5"},":")),n.push(pe.a.createElement("div",{className:"rdtCounter rdtMilli",key:"m"},pe.a.createElement("input",{value:this.state.milliseconds,type:"text",onChange:this.updateMilli})))),pe.a.createElement("div",{className:"rdtTime"},pe.a.createElement("table",{},[this.renderHeader(),pe.a.createElement("tbody",{key:"b"},pe.a.createElement("tr",{},pe.a.createElement("td",{},pe.a.createElement("div",{className:"rdtCounters"},n))))]))}},{key:"componentWillMount",value:function(){var t=this;t.timeConstraints={hours:{min:0,max:23,step:1},minutes:{min:0,max:59,step:1},seconds:{min:0,max:59,step:1},milliseconds:{min:0,max:999,step:1}},["hours","minutes","seconds","milliseconds"].forEach(function(e){Le()(t.timeConstraints[e],t.props.timeConstraints[e])}),this.setState(this.calculateState(this.props))}},{key:"componentWillReceiveProps",value:function(e){this.setState(this.calculateState(e))}},{key:"updateMilli",value:function(e){var t=K()(e.target.value,10);t===e.target.value&&0<=t&&t<1e3&&(this.props.setTime("milliseconds",t),this.setState({milliseconds:t}))}},{key:"renderHeader",value:function(){if(!this.props.dateFormat)return null;var e=this.props.selectedDate||this.props.viewDate;return pe.a.createElement("thead",{key:"h"},pe.a.createElement("tr",{},pe.a.createElement("th",{className:"rdtSwitch",colSpan:4,onClick:this.props.showView("days")},e.format(this.props.dateFormat))))}},{key:"onStartClicking",value:function(t,n){var a=this;return function(){var e={};e[n]=a[t](n),a.setState(e),a.timer=setTimeout(function(){a.increaseTimer=setInterval(function(){e[n]=a[t](n),a.setState(e)},70)},500)}}},{key:"disableContextMenu",value:function(e){return e.preventDefault(),!1}},{key:"toggleDayPart",value:function(e){var t=K()(this.state[e],10)+12;return t>this.timeConstraints[e].max&&(t=this.timeConstraints[e].min+(t-(this.timeConstraints[e].max+1))),this.pad(e,t)}},{key:"increase",value:function(e){var t=K()(this.state[e],10)+this.timeConstraints[e].step;return t>this.timeConstraints[e].max&&(t=this.timeConstraints[e].min+(t-(this.timeConstraints[e].max+1))),this.pad(e,t)}},{key:"decrease",value:function(e){var t=K()(this.state[e],10)-this.timeConstraints[e].step;return t<this.timeConstraints[e].min&&(t=this.timeConstraints[e].max+1-(this.timeConstraints[e].min-t)),this.pad(e,t)}},{key:"pad",value:function(e,t){for(var n="".concat(t);n.length<this.padValues[e];)n="0".concat(n);return n}}]),n}(pe.a.Component),Ar=function(e){function i(){var e,t;vr()(this,i);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=xr()(this,(e=Er()(i)).call.apply(e,[this].concat(a)))).viewComponents={days:Or,months:zr,years:Br,time:Pr},t}return Sr()(i,e),wr()(i,[{key:"render",value:function(){return pe.a.createElement(this.viewComponents[this.props.view],this.props.viewProps)}}]),i}(pe.a.Component),qr="years",Rr="months",Lr="days",Ur="time",Fr=d.d.div.withConfig({displayName:"pc-datetime__Container",componentId:"sc-16sjxpc-0"})([".rdt{font-size:12px;position:relative;}.rdtPicker{display:none;position:absolute;width:180px;padding:4px;font-size:12px;margin-top:1px;z-index:99999 !important;background:#fff;box-shadow:0 7px 10px rgba(0,0,0,0.2);border:1px solid #f9f9f9;}.rdtOpen .rdtPicker{display:block;}.rdtStatic .rdtPicker{box-shadow:none;position:static;}.rdtPicker .rdtTimeToggle{text-align:center;}.rdtPicker table{font-size:12px;width:100%;margin:0;}.rdtPicker td,.rdtPicker th{text-align:center;height:20px;}.rdtPicker td{cursor:pointer;}.rdtPicker td.rdtDay:hover,.rdtPicker td.rdtHour:hover,.rdtPicker td.rdtMinute:hover,.rdtPicker td.rdtSecond:hover,.rdtPicker .rdtTimeToggle:hover{background:#eeeeee;cursor:pointer;}.rdtPicker td.rdtOld,.rdtPicker td.rdtNew{color:#999999;}.rdtPicker td.rdtToday{position:relative;}.rdtPicker td.rdtToday:before{content:'';display:inline-block;border-left:7px solid transparent;border-bottom:7px solid #428bca;border-top-color:rgba(0,0,0,0.2);position:absolute;bottom:4px;right:4px;}.rdtPicker td.rdtActive,.rdtPicker td.rdtActive:hover{background-color:#428bca;color:#fff;text-shadow:0 -1px 0 rgba(0,0,0,0.25);}.rdtPicker td.rdtActive.rdtToday:before{border-bottom-color:#fff;}.rdtPicker td.rdtDisabled,.rdtPicker td.rdtDisabled:hover{background:none;color:#999999;cursor:not-allowed;}.rdtPicker td span.rdtOld{color:#999999;}.rdtPicker td span.rdtDisabled,.rdtPicker td span.rdtDisabled:hover{background:none;color:#999999;cursor:not-allowed;}.rdtPicker th{border-bottom:1px solid #f9f9f9;}.rdtPicker .dow{width:14.2857%;border-bottom:none;cursor:default;}.rdtPicker th.rdtSwitch{width:100px;}.rdtPicker th.rdtNext,.rdtPicker th.rdtPrev{font-size:21px;vertical-align:top;}.rdtPrev span,.rdtNext span{display:block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.rdtPicker th.rdtDisabled,.rdtPicker th.rdtDisabled:hover{background:none;color:#999999;cursor:not-allowed;}.rdtPicker thead tr:first-child th{cursor:pointer;}.rdtPicker thead tr:first-child th:hover{background:#eeeeee;}.rdtPicker tfoot{border-top:1px solid #f9f9f9;}.rdtPicker button{border:none;background:none;cursor:pointer;}.rdtPicker button:hover{background-color:#eee;}.rdtPicker thead button{width:100%;height:100%;}td.rdtMonth,td.rdtYear{height:50px;width:25%;cursor:pointer;}td.rdtMonth:hover,td.rdtYear:hover{background:#eee;}.rdtCounters{display:inline-block;}.rdtCounters > div{float:left;}.rdtCounter{height:100px;}.rdtCounter{width:40px;}.rdtCounterSeparator{line-height:100px;}.rdtCounter .rdtBtn{height:40%;line-height:40px;cursor:pointer;display:block;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.rdtCounter .rdtBtn:hover{background:#eee;}.rdtCounter .rdtCount{height:20%;font-size:1.2em;}.rdtMilli{vertical-align:middle;padding-left:8px;width:48px;}.rdtMilli input{width:100%;font-size:1.2em;margin-top:37px;}.rdtTime td{cursor:default;}"]),Wr=function(e){function a(e){var t;vr()(this,a),(t=xr()(this,Er()(a).call(this,e))).displayName="DateTime",t.allowedSetTime=["hours","minutes","seconds","milliseconds"],t.componentProps={fromProps:["value","isValidDate","renderDay","renderMonth","renderYear","timeConstraints"],fromState:["viewDate","selectedDate","updateOn"],fromThis:["setDate","setTime","showView","addTime","subtractTime","updateSelectedDate","localMoment","handleClickOutside"]},t.checkTZ(e);var n=t.getStateFromProps(e);return void 0===n.open&&(n.open=!e.input),n.currentView=e.dateFormat?e.viewMode||n.updateOn||Lr:Ur,t.state=n,t.openCalendar=t.openCalendar.bind(Cr()(t)),t.onInputChange=t.onInputChange.bind(Cr()(t)),t.updateSelectedDate=t.updateSelectedDate.bind(Cr()(t)),t.showView=t.showView.bind(Cr()(t)),t.addTime=t.addTime.bind(Cr()(t)),t.subtractTime=t.subtractTime.bind(Cr()(t)),t.setDate=t.setDate.bind(Cr()(t)),t.setTime=t.setTime.bind(Cr()(t)),t.localMoment=t.localMoment.bind(Cr()(t)),t.handleClickOutside=t.handleClickOutside.bind(Cr()(t)),t.handleGlobalClick=t.handleGlobalClick.bind(Cr()(t)),t.frameDoc=window.parent.document.querySelector("iframe[name=chat]").contentWindow.document,t}return Sr()(a,e),wr()(a,[{key:"componentDidMount",value:function(){this.ref=pe.a.createRef(null),this.frameDoc.addEventListener("click",this.handleGlobalClick,!0)}},{key:"componentWillUnmount",value:function(){this.frameDoc.removeEventListener("click",this.handleGlobalClick,!0)}},{key:"handleGlobalClick",value:function(e){this.ref.current&&!this.ref.current.contains(e.target)&&this.handleClickOutside()}},{key:"parseDate",value:function(e,t){var n;return e&&"string"==typeof e?n=this.localMoment(e,t.datetime):e&&(n=this.localMoment(e)),n&&!n.isValid()&&(n=null),n}},{key:"getStateFromProps",value:function(e){var t,n,a=this.getFormats(e),o=e.value||e.defaultValue,i=this.parseDate(o,a);t=this.parseDate(e.viewDate,a),t=i?i.clone().startOf("month"):t?t.clone().startOf("month"):this.localMoment().startOf("month");var r=this.getUpdateOn(a);return n=i?i.format(a.datetime):o.isValid&&!o.isValid()?"":o||"",{updateOn:r,inputFormat:a.datetime,viewDate:t,selectedDate:i,inputValue:n,open:e.open}}},{key:"getUpdateOn",value:function(e){return e.date.match(/[lLD]/)?Lr:-1!==e.date.indexOf("M")?Rr:-1!==e.date.indexOf("Y")?qr:Lr}},{key:"getFormats",value:function(e){var t={date:e.dateFormat||"",time:e.timeFormat||""},n=this.localMoment(e.date,null,e).localeData();return!0===t.date?t.date=n.longDateFormat("L"):this.getUpdateOn(t)!==Lr&&(t.time=""),!0===t.time&&(t.time=n.longDateFormat("LT")),t.datetime=t.date&&t.time?"".concat(t.date," ").concat(t.time):t.date||t.time,t}},{key:"componentWillReceiveProps",value:function(e){var t=this.getFormats(e),n={};if(e.value===this.props.value&&t.datetime===this.getFormats(this.props).datetime||(n=this.getStateFromProps(e)),void 0===n.open&&(void 0!==e.open?n.open=e.open:this.props.closeOnSelect&&this.state.currentView!==Ur?n.open=!1:n.open=this.state.open),e.viewMode!==this.props.viewMode&&(n.currentView=e.viewMode),e.locale!==this.props.locale){if(this.state.viewDate){var a=this.state.viewDate.clone().locale(e.locale);n.viewDate=a}if(this.state.selectedDate){var o=this.state.selectedDate.clone().locale(e.locale);n.selectedDate=o,n.inputValue=o.format(t.datetime)}}e.utc===this.props.utc&&e.displayTimeZone===this.props.displayTimeZone||(e.utc?(this.state.viewDate&&(n.viewDate=this.state.viewDate.clone().utc()),this.state.selectedDate&&(n.selectedDate=this.state.selectedDate.clone().utc(),n.inputValue=n.selectedDate.format(t.datetime))):e.displayTimeZone?(this.state.viewDate&&(n.viewDate=this.state.viewDate.clone().tz(e.displayTimeZone)),this.state.selectedDate&&(n.selectedDate=this.state.selectedDate.clone().tz(e.displayTimeZone),n.inputValue=n.selectedDate.tz(e.displayTimeZone).format(t.datetime))):(this.state.viewDate&&(n.viewDate=this.state.viewDate.clone().local()),this.state.selectedDate&&(n.selectedDate=this.state.selectedDate.clone().local(),n.inputValue=n.selectedDate.format(t.datetime)))),e.viewDate!==this.props.viewDate&&(n.viewDate=Nr()(e.viewDate)),this.checkTZ(e),this.setState(n)}},{key:"onInputChange",value:function(e){var t=this,n=null===e.target?e:e.target.value,a=this.localMoment(n,this.state.inputFormat),o={inputValue:n};return a.isValid()&&!this.props.value?(o.selectedDate=a,o.viewDate=a.clone().startOf("month")):o.selectedDate=null,this.setState(o,function(){return t.props.onChange(a.isValid()?a:t.state.inputValue)})}},{key:"onInputKey",value:function(e){9===e.which&&this.props.closeOnTab&&this.closeCalendar()}},{key:"showView",value:function(e){var t=this;return function(){t.state.currentView!==e&&t.props.onViewModeChange(e),t.setState({currentView:e})}}},{key:"setDate",value:function(t){var n=this,a={month:Lr,year:Rr};return function(e){n.setState({viewDate:n.state.viewDate.clone()[t](K()(e.target.getAttribute("data-value"),10)).startOf(t),currentView:a[t]}),n.props.onViewModeChange(a[t])}}},{key:"subtractTime",value:function(e,t,n){var a=this;return function(){a.props.onNavigateBack(e,t),a.updateTime("subtract",e,t,n)}}},{key:"addTime",value:function(e,t,n){var a=this;return function(){a.props.onNavigateForward(e,t),a.updateTime("add",e,t,n)}}},{key:"updateTime",value:function(e,t,n,a){var o={},i=a?"selectedDate":"viewDate";o[i]=this.state[i].clone()[e](t,n),this.setState(o)}},{key:"setTime",value:function(e,t){var n,a=this.allowedSetTime.indexOf(e)+1,o=this.state,i=(o.selectedDate||o.viewDate).clone();for(i[e](t);a<this.allowedSetTime.length;a+=1)i[n=this.allowedSetTime[a]](i[n]());this.props.value||this.setState({selectedDate:i,inputValue:i.format(o.inputFormat)}),this.props.onChange(i)}},{key:"updateSelectedDate",value:function(e,t){var n,a=e.currentTarget,o=0,i=this.state,r=i.viewDate,c=i.inputFormat,l=this.state.selectedDate||r;if(-1!==a.className.indexOf("rdtDay")?(-1!==a.className.indexOf("rdtNew")?o=1:-1!==a.className.indexOf("rdtOld")&&(o=-1),n=r.clone().month(r.month()+o).date(K()(a.getAttribute("data-value"),10))):-1!==a.className.indexOf("rdtMonth")?n=r.clone().month(K()(a.getAttribute("data-value"),10)).date(l.date()):-1!==a.className.indexOf("rdtYear")&&(n=r.clone().month(l.month()).date(l.date()).year(K()(a.getAttribute("data-value"),10))),n.hours(l.hours()).minutes(l.minutes()).seconds(l.seconds()).milliseconds(l.milliseconds()),this.props.value)this.props.closeOnSelect&&t&&this.closeCalendar();else{var s=!(this.props.closeOnSelect&&t);s||this.props.onBlur(n),this.setState({selectedDate:n,viewDate:n.clone().startOf("month"),inputValue:n.format(c),open:s})}this.props.onChange(n)}},{key:"openCalendar",value:function(e){var t=this;this.state.open||this.setState({open:!0},function(){t.props.onFocus(e)})}},{key:"closeCalendar",value:function(){var e=this;this.setState({open:!1},function(){e.props.onBlur(e.state.selectedDate||e.state.inputValue)})}},{key:"handleClickOutside",value:function(){var e=this;this.props.input&&this.state.open&&void 0===this.props.open&&!this.props.disableCloseOnClickOutside&&this.setState({open:!1},function(){e.props.onBlur(e.state.selectedDate||e.state.inputValue)})}},{key:"localMoment",value:function(e,t,n){var a=n||this.props,o=null;return o=a.utc?Nr.a.utc(e,t,a.strictParsing):a.displayTimeZone?Nr.a.tz(e,t,a.displayTimeZone):Nr()(e,t,a.strictParsing),a.locale&&o.locale(a.locale),o}},{key:"checkTZ",value:function(e){var t=console;!e.displayTimeZone||this.tzWarning||Nr.a.tz||(this.tzWarning=!0,t&&t.error('react-datetime: displayTimeZone prop with value "'.concat(e.displayTimeZone,'" is used but moment.js timezone is not loaded.')))}},{key:"getComponentProps",value:function(){var t=this,e=this.getFormats(this.props),n={dateFormat:e.date,timeFormat:e.time};return this.componentProps.fromProps.forEach(function(e){n[e]=t.props[e]}),this.componentProps.fromState.forEach(function(e){n[e]=t.state[e]}),this.componentProps.fromThis.forEach(function(e){n[e]=t[e]}),n}},{key:"overrideEvent",value:function(n,a){if(this.overridenEvents||(this.overridenEvents={}),!this.overridenEvents[n]){var o=this;this.overridenEvents[n]=function(e){var t;o.props.inputProps&&o.props.inputProps[n]&&(t=o.props.inputProps[n](e)),!1!==t&&a(e)}}return this.overridenEvents[n]}},{key:"render",value:function(){var e="rdt".concat(this.props.className?nt()(this.props.className)?" ".concat(this.props.className.join(" ")):" ".concat(this.props.className):""),t=[];if(this.props.input){var n=Le()({type:"text",className:"form-control",value:this.state.inputValue},this.props.inputProps,{onClick:this.overrideEvent("onClick",this.openCalendar),onFocus:this.overrideEvent("onFocus",this.openCalendar),onChange:this.overrideEvent("onChange",this.onInputChange),onKeyDown:this.overrideEvent("onKeyDown",this.onInputKey)});t=this.props.renderInput?[pe.a.createElement("div",{key:"i"},this.props.renderInput(n,this.openCalendar,this.closeCalendar))]:[pe.a.createElement("input",Le()({key:"i"},n))]}else e+=" rdtStatic";return(this.props.open||void 0===this.props.open&&this.state.open)&&(e+=" rdtOpen"),pe.a.createElement(Fr,{ref:this.ref},pe.a.createElement("div",{className:e},t.concat(pe.a.createElement("div",{key:"dt",className:"rdtPicker"},pe.a.createElement(Ar,{view:this.state.currentView,viewProps:this.getComponentProps()})))))}}]),a}(pe.a.Component);Wr.defaultProps={className:"",defaultValue:"",inputProps:{},input:!0,onFocus:function(){},onBlur:function(){},onChange:function(){},onViewModeChange:function(){},onNavigateBack:function(){},onNavigateForward:function(){},timeFormat:!0,timeConstraints:{},dateFormat:!0,strictParsing:!0,closeOnSelect:!1,closeOnTab:!0,utc:!1},Wr.moment=Nr.a;function Gr(e){var t=Ze("get","_MEIQIA_LANGUAGE")||"zh-cn",n=e.handleChange;return pe.a.createElement("div",null,pe.a.createElement(Wr,{locale:Hr[t],onChange:function(e){n(new Date(e))},inputProps:{readOnly:"readonly"}}))}function Vr(e){return X.isMobile()?pe.a.createElement(cr,e):pe.a.createElement(Gr,e)}var Hr={zh:"zh-CN",tw:"zh-TW",en:"en"};function Qr(e){var t=function(e){if(e&&0<e.indexOf("T")){var t=e.split("T")[0].split("-"),n=e.split("T")[1].split(":"),a=new Date(+t[0],+t[1],+t[2],+n[0],+n[1],+n[2]);return a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),a}return new Date}(e),n=0===t.getHours()?"12":12<t.getHours()?t.getHours()-12:t.getHours();n=n<10?"0".concat(n):n;var a=(t.getMinutes()<10?"0":"")+t.getMinutes(),o=t.getHours()<12?"AM":"PM";return"".concat(n,":").concat(a).concat(o)}function Yr(e){return e<10?"0".concat(e):e}function $r(e){var t=e;return t.getUTCFullYear||(t=new Date(t)),"".concat(t.getUTCFullYear(),"-").concat(Yr(t.getUTCMonth()+1),"-").concat(Yr(t.getUTCDate()),"T").concat(Yr(t.getUTCHours()),":").concat(Yr(t.getUTCMinutes()),":").concat(Yr(t.getUTCSeconds()),".").concat((t.getUTCMilliseconds()/1e6).toFixed(6).slice(2))}var Jr=function(e){var t=ce()(),n=new Date(e).getTime()-t;return!(!Da()(n)||n<0)&&(3600<=(n/=1e3)?K()(Math.round(n/3600),10)+R.a.t("小时"):60<=n?K()(n/60,10)+R.a.t("分钟"):n+R.a.t("秒"))};function Kr(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function Zr(e,t,n,a,o){function i(t){return function(e){o(t,e)}}var r=null,c="";switch(e.type){case"text":case"string":c=R.a.t("请输入"),r=pe.a.createElement("input",{type:"text",focus:"true",name:e.name,onChange:a});break;case"number":c=R.a.t("请输入"),r=pe.a.createElement("input",{type:"number",focus:"true",name:e.name,onChange:a});break;case"radio":case"check":case"checkbox":var l="check"===e.type||"checkbox"===e.type,s=e.metainfo.map(function(e){return"object"===p()(e)?{label:e.name,value:e.value}:{label:e,value:e}});c=R.a.t("请选择"),r=pe.a.createElement(rr,{name:e.name,multi:l,options:s,value:t[e.name],handleChange:i(e.name)});break;case"date":case"datetime":c=R.a.t("请选择"),r=pe.a.createElement(Vr,{name:e.name,value:t[e.name],handleChange:i(e.name)})}return pe.a.createElement(pe.a.Fragment,{key:e.id},pe.a.createElement("label",null,"".concat(c," "),R.a.t(e.displayName)||e.name),r,n[e.name]?pe.a.createElement("p",{className:"error-field"},n[e.name]):null)}function Xr(e){var t=e.themeColor,n=e.content,a=e.handleImgOnload,o=e.cardSize;return pe.a.createElement(lc,{themeColor:t,cardSize:o},pe.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n[0].body.target_url},pe.a.createElement("img",{alt:"",src:n[0].body.pic_url,onLoad:a})))}function ec(e,t,n){var a=ln.dispatch;a(st(e,{_evaluateStatus:t})),n&&n.length&&(a(rt(n)),Tn())}function tc(e,t){var n=ln.dispatch;t?n(ct(t,e)):(n(rt(e)),Tn())}function nc(e){var t=ln.getState().getIn(["config","entId"]),n=e.target.files[0];if(5e7<n.size)za(R.a.t("只能发送小于 50MB 的文件哦"),5e3);else{var c=Math.random(),l={id:c,from_type:"client",content_type:"file",status:"sending",file:n,_fileStatus:"uploading",_speed:fc(0),extra:{filename:n.name,size:n.size,type:n.type}};e.target.value="",tc(l),function(e,t){return fe({url:"/upload/policies",method:"post",headers:{"content-type":"application/json"},data:t,params:{ent_id:e}})}(t,{filename:n.name}).then(function(i){if(i.data){var r=ce()(),e={url:i.data.policy.url,method:"post",data:{msg:l,fields:i.data.policy.fields},cancelToken:new mn.a.CancelToken(function(e){l._cancelToken=e}),onUploadProgress:function(e){var t=e.position||e.loaded,n=e.totalSize||e.total,a=(ce()()-r)/1e3,o=fc(a?t/a:0);l._fileStatus="uploading",l._progress=100*t/n,l._speed="".concat(o,"/s"),tc(l,c)}};M(e,"uploadFile").then(function(){var e=ln.getState(),t=ln.dispatch,n=e.get("message"),a=ie()(n.get("fakeMsg")),o={};l._fileStatus="success",l.content=i.data.policy.fields.key,l.extra.expire_at=$r((new Date).setDate((new Date).getDate()+1)),n.get("schedulerAfterClientSendMsg")&&!n.get("scheduler")?(Qn(),a.push(l),o.fakeMsg=a,o.schedulerMsg=!0,o.schedulerAfterClientSendMsg=!1,t(it(o))):n.get("chatHasEnd")?(Qn(),a.push(l),o.fakeMsg=a,o.schedulerMsg=!0,t(it(o))):(tc(l,c),xn(l))},function(e){e&&"cancel"===e.message?console.log(e):(l._fileStatus="fail",tc(l,c))})}})}}function ac(e,t){var n=ln.dispatch;t?n(ct(t,e)):(n(rt(e)),Tn()),Sn(e.id)}function oc(e){var a=e,t=ln.getState(),o=ln.dispatch,i=t.get("message"),n=i.get("convId"),r=i.get("agentToken"),c=t.get("config"),l=c.get("entId"),s=c.get("trackId");ac(a),function(e,t,n,a,o){var i={url:"/upload?ent_id=".concat(e),method:"post",data:{msg:o,entId:e,trackId:t,convId:n,agentToken:a}};return M(i,"uploadImage")}(l,s,n,r,a).then(function(e){var t={},n=ie()(i.get("fakeMsg"));e.data&&e.data.success?(a.media_url=e.data.photo_url,a.content=e.data.photo_key,delete a.status,delete a.file,i.get("schedulerAfterClientSendMsg")&&!i.get("scheduler")?(Qn(),n.push(a),t.fakeMsg=n,t.schedulerMsg=!0,t.schedulerAfterClientSendMsg=!1,o(it(t))):i.get("chatHasEnd")?(Qn(),n.push(a),t.fakeMsg=n,t.schedulerMsg=!0,o(it(t))):(ac(a,a.id),xn(a))):(a.media_url=_c.a,a.status="error",ac(a,a.id))},function(){a.media_url=_c.a,a.status="error",ac(a,a.id)})}var ic=d.d.div.withConfig({displayName:"client-card__Wrapper",componentId:"sc-1kln586-0"})(["max-width:280px;box-sizing:border-box;background:#fff;padding:10px;box-shadow:0px 2px 9px 0px rgba(0,0,0,0.21);border-top:solid 2px ",";"],function(e){return e.themeColor}),rc=d.d.div.withConfig({displayName:"client-card__Form",componentId:"sc-1kln586-1"})(["color:rgb(179,179,179);font-size:14px;text-align:left;margin-bottom:10px;.field{padding:0 0 10px;}label{display:inline-block;padding:10px 0 5px;}input[type='text'],input[type='number']{width:100%;height:28px;border-radius:2px;padding:0 5px;color:#4a4a4a;background-color:#fff;box-shadow:inset 0px 1px 6px 0px rgba(0,0,0,0.1);border:1px solid rgba(199,199,199,1);}.error-field{color:#ff7474;font-size:12px;padding:6px 0;}"]),cc=Object(mr.a)({mapPropsToValues:function(){return{}},validate:function(t){var n={},a=!1;return m()(t).forEach(function(e){void 0!==t[e]&&(a=!0),"tel"===e&&(/^[\d-]{10,18}$/.test(t[e].trim())||(n[e]=R.a.t("请正确填写手机或带区号的座机号码"))),"qq"===e&&(/^[1-9][\d]{4,10}$/.test(t[e].trim())||(n[e]=R.a.t("请正确填写QQ")))}),a||(n.global=R.a.t("请至少填写一项")),n},handleSubmit:function(e,t){var n=t.props,a=n.id,o=n.cardType,i=n.data,r=n.handleCardSubmit,c=t.setSubmitting,l=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kr(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):Kr(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},e),s={};i.forEach(function(e){s[e.name]=e.type}),m()(l).forEach(function(e){l[e]?"date"!==s[e]&&"datetime"!==s[e]||(l[e]=$r(l[e])):delete l[e]}),r(a,o,l).finally(function(){c(!1)})}})(function(e){var t=e.themeColor,n=e.fontColor,a=e.data,o=e.values,i=e.errors,r=e.handleChange,c=e.isSubmitting,l=e.handleSubmit,s=e.setFieldValue,d=Object(me.c)(),u=ra()(d,1)[0];return pe.a.createElement(ic,{themeColor:t},pe.a.createElement(rc,null,a.map(function(e){return Zr(e,o,i,r,s)}),i.global?pe.a.createElement("p",{className:"error-field"},i.global):null),pe.a.createElement("div",null,pe.a.createElement(ar,{bgColor:t,fontColor:n,disabled:c,handleClick:l},u("发送"))))}),lc=d.d.div.withConfig({displayName:"photo-card__Wrapper",componentId:"sc-3bw2yv-0"})(["box-sizing:border-box;background:#fff;padding:10px 10px 10px 10px;box-shadow:0px 2px 9px 0px rgba(0,0,0,0.21);border-top:solid 2px ",";img{width:","px;max-width:","px;}"],function(e){return e.themeColor},function(e){return e.cardSize||300},function(e){return e.cardSize||300}),sc=pe.a.memo(function(e){var t=e.id,n=e.avatar,a=e.arrow,o=e.name,i=e.content,r=e.themeColor,c=e.fontColor,l=e.msgType,s=e.cardSize,d=e.handleCardSubmit,u=e.handleMenuClick,p=e.scrollToBottom,m={},f={themeColor:r,fontColor:c},h=Object(ue.useCallback)(function(){"normal"!==l&&"scheduler"!==l||p()},[p,l]);switch("mobile"===X.isMobile()?(m.avatar=n,m.arrow=a):m.name=o,i[0].type){case"client_card":return pe.a.createElement(cc,Qa()({},f,m,{id:t,cardSize:s,handleCardSubmit:d,data:i[0].body}));case"photo_card":return pe.a.createElement(Xr,Qa()({},f,m,{id:t,cardSize:s,content:i,handleImgOnload:h}));default:var g=i;return"list"===i[0].type&&(g=i[0].body),g=i.map(function(e){switch(e.type){case"text":case"txt":case"rich_text":return e.body;case"choices":return{type:"menu",items:e.body.choices.map(function(e){return{value:e,text:e}})};default:return""}}),pe.a.createElement(gi,{content:g,handleMenuClick:u})}}),dc=d.d.div.withConfig({displayName:"user-options__Container",componentId:"oy6z4k-0"})(["margin-left:",";margin-top:-10px;padding-right:50px;"],function(e){return e.mobile?"46px":"0"}),uc=d.d.div.withConfig({displayName:"user-options__OptionItem",componentId:"oy6z4k-1"})(["display:inline-block;word-break:break-all;margin-right:10px;margin-bottom:8px;line-height:20px;cursor:pointer;background:",";color:",";padding:6px 12px;border-radius:12px;box-shadow:0 2px 20px rgba(0,0,0,0.17);"],function(e){return e.themeColor},function(e){return e.fontColor}),pc=function(e){var n=e.msgId,t=e.content,a=e.handleUserOption,o=e.themeColor,i=e.fontColor,r=X.isMobile(),c={themeColor:o,fontColor:i};return pe.a.createElement(dc,{mobile:r},t.map(function(e,t){return pe.a.createElement(uc,Qa()({},c,{key:t,onClick:function(){return a(n,e.content,e.next)}}),e.content)}))},mc=function(n,e,a,t){var o=ln.getState(),i=o.get("config"),r=o.get("message"),c=i.get("entId"),l=i.get("trackId"),s=r.get("convId");ec(n,"submit"),function(e,t,n,a,o,i){return fe({url:"/knowledge/questions/".concat(a,"/evaluate"),method:"post",headers:{"content-type":"application/json"},data:{ent_id:e,track_id:t,conv_id:n,useful:o,client_question_text:i}})}(c,l,s,e,a,t).then(function(e){var t=[];e.data&&e.data.message&&t.push({id:Math.random(),from_type:"bot",agent:{nickname:""},content_type:"text",content:e.data.message}),0===a&&t.push({id:1*ce()(),from_type:"redirect_btn"}),ec(n,"finish",t)},function(e){var t={};try{t=e.response.data||{}}catch(e){console.log(e)}setTimeout(function(){za(t.message||R.a.t("提交失败，请稍候再试"),2e3)},1e3),ec(n,"waiting")})},fc=function(e,t){if(!e)return"0 B";var n=t+1||2,a=Math.floor(Math.log(e)/Math.log(1e3));return"".concat(qe()((e/Math.pow(1e3,a)).toFixed(n))," ").concat(["B","KB","MB","GB","TB","PB","EB","ZB","YB"][a])},hc=function(t){var e=ln.getState(),n=ln.dispatch,a=e.get("config"),o=e.get("message"),i=o.get("queue"),r=i.findIndex(function(e){return e.id===t}),c=i[r]._cancelToken;c&&c("cancel"),n(st(t,{_fileStatus:"cancel"})),function(e){fe({url:"/client/cancel_upload",method:"post",headers:{"content-type":"application/json"},data:e})}({ent_id:a.get("entId"),track_id:a.get("trackId"),browser_id:a.get("browserId"),conversation_id:o.get("convId")||void 0,type:i[r].extra.type,size:i[r].extra.size,filename:i[r].extra.filename})},gc=n(126),bc=n.n(gc),vc=n(237),_c=n.n(vc);function wc(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function yc(e){var t=e.config,n=e.extra,a=e.children,o=function(e){return"file"===e.content_type&&["width: calc(100% - 30px);","max-width: calc(100% - 30px);"]}(t),i=t.id,r=null,c=Object(ue.useCallback)(function(){xc(i)},[i]);switch(t.from_type){case"bot":case"agent":case"client":r=!1!==t._useWrap?pe.a.createElement(kc,Qa()({styles:o},n,{handleMsgClick:c}),a):a;break;case"redirect":case"evaluation":case"blacklist":r=pe.a.createElement(Xi,null,a);break;default:r=a}return r}var xc=function(t){var e=ln.getState(),n=ln.dispatch,a=e.getIn(["message","queue"]).find(function(e){return e.id===t});if(a&&"client"===a.from_type&&"error"===a.status){var o=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?wc(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):wc(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},a,{id:Math.random()});"text"===a.content_type?(n(rt(o)),xn(o)):"photo"===a.content_type&&(o.status="sending",o.media_url=bc.a,oc(o))}},kc=Object(d.d)(ri).withConfig({displayName:"msg-wrapper__Base",componentId:"sc-19mnsx8-0"})(["",""],function(e){return e.styles?e.styles.join(""):""}),Ec=X.isMobile()?"mobile":"desktop",Ic=d.d.div.withConfig({displayName:"msg-window__Container",componentId:"sc-1y5k7uj-0"})(["width:100%;height:100%;padding:14px;box-sizing:border-box;overflow-y:auto;position:relative;",""],function(e){return e.history?"padding-top: 40px;":""}),Cc=d.d.div.withConfig({displayName:"msg-window__MsgContainer",componentId:"sc-1y5k7uj-1"})(["width:100%;position:relative;"]),Tc=d.d.div.withConfig({displayName:"msg-window__HistoryBtn",componentId:"sc-1y5k7uj-2"})(["position:absolute;top:10px;left:0;right:0;width:100%;height:20px;line-height:20px;text-align:center;font-size:12px;color:#777;cursor:pointer;"]),Sc=d.d.div.withConfig({displayName:"msg-window__Sensitive",componentId:"sc-1y5k7uj-3"})(["position:absolute;text-align:right;font-size:12px;color:#b2b2b2;right:0;bottom:-16px;"]);function jc(e,t){var n=null,a=t.styles,o=t.handleRedirect,i=t.handleRedirectTicket,r={id:e.id,direction:"client"===e.from_type?"right":"left",status:e.status,time:Qr(e.created_on)};switch("evaluate"===e.sub_type&&"normal"===e._renderType&&(r.evaluateStatus=e._evaluateStatus||"waiting",r.questionId=e.question_id,r.question=e.extra.client_msg,r.handleFeedback=mc),e.from_type){case"bot":"mobile"===Ec?(r.avatar=e.agent.avatar,r.arrow=!0):r.name=e.agent.nickname,n=function(e,t,n){var a=null,o=n.styles,i=n.handleImgOnload,r=n.handleImagePreview,c=n.scrollToBottom,l=n.handleMenuClick,s=n.handleCardSubmit,d=n.cardSize,u=n.handleUserOption;switch(e.content_type){case"welcome":a=pe.a.createElement(Ho,Qa()({},t,{msg:ji(e.content)}));break;case"text":case"bot":e.content_robot&&e.content_robot.length?a=pe.a.createElement(Oi,Qa()({},t,{handleMenuClick:l,content:e.content_robot,handleImagePreview:r})):e.content&&(a=pe.a.createElement(Ho,Qa()({},t,{msg:ji(e.content)})));break;case"rich_text":a=pe.a.createElement(gi,Qa()({},t,{content:e.extra.content,handleImagePreview:r}));break;case"photo":Le()(t,{themeColor:"transparent",padding:"0"}),a=pe.a.createElement(zi,Qa()({},t,{url:e.media_url,handleOnload:i,handleImagePreview:r}));break;case"hybrid":var p={themeColor:o.panel.themeColor,fontColor:o.panel.fontColor},m={handleCardSubmit:s,scrollToBottom:c,msgType:e._renderType,cardSize:d};["client_card","photo_card"].includes(e.content[0].type)&&Le()(t,{themeColor:"transparent",padding:"0"}),a=pe.a.createElement(sc,Qa()({},t,p,m,{content:e.content}));break;case"_user_options":Le()(t,{themeColor:o.panel.themeColor,fontColor:o.panel.fontColor}),a=pe.a.createElement(pc,Qa()({},t,{content:e.content,msgId:e.extra.msgId,handleUserOption:u}));break;default:a=null}return a}(e,r,t);break;case"agent":"mobile"===Ec?(r.avatar=e.agent.avatar,r.arrow=!0):r.name=e.agent.nickname,n=function(e,t,n){var a=null,o=n.styles,i=n.handleImgOnload,r=n.handleImagePreview,c=n.scrollToBottom,l=n.handleCardSubmit,s=n.handleFileDownload,d=n.cardSize;switch(e.content_type){case"welcome":case"text":a=pe.a.createElement(Ho,Qa()({},t,{msg:ji(e.content)}));break;case"rich_text":a=pe.a.createElement(gi,Qa()({},t,{content:e.extra.content,handleImagePreview:r}));break;case"photo":Le()(t,{themeColor:"transparent",padding:"0"}),a=pe.a.createElement(zi,Qa()({},t,{url:e.media_url,handleOnload:i,handleImagePreview:r}));break;case"file":var u=Jr(e.extra.expire_at),p="";Le()(t,{themeColor:"#fff"}),p=u?R.a.t("{{expireTime}}后过期",{expireTime:u}):R.a.t("已过期");var m={fileName:e.extra.filename,fileSize:e.extra.convert_size,fileStatus:p,status:e.extra.cancel?"cancel":"",hasExpired:!u,fileUrl:e.media_url,handleFileDownload:s};a=pe.a.createElement(Qi,Qa()({},t,m));break;case"hybrid":var f={themeColor:o.panel.themeColor,fontColor:o.panel.fontColor},h={handleCardSubmit:l,scrollToBottom:c,msgType:e._renderType,cardSize:d};["client_card","photo_card"].includes(e.content[0].type)&&Le()(t,{themeColor:"transparent",padding:"0"}),a=pe.a.createElement(sc,Qa()({},t,f,h,{content:e.content}));break;default:a=null}return a}(e,r,t);break;case"client":r.themeColor=a.panel.themeColor,r.fontColor=a.panel.fontColor,"mobile"===Ec&&(r.arrow=!0),n=function(e,t,n){var a=null,o=n.handleImgOnload,i=n.handleImagePreview;switch(e.content_type){case"text":a=pe.a.createElement(Ho,Qa()({},t,{msg:ji(e.content)}));break;case"photo":Le()(t,{themeColor:"transparent",padding:"0"}),a=pe.a.createElement(zi,Qa()({},t,{url:e.media_url,status:e.status,handleOnload:o,handleImagePreview:i}));break;case"file":var r=Jr(e.extra.expire_at),c="";switch(Le()(t,{themeColor:"#fff"}),e._fileStatus){case"uploading":c=R.a.t("上传中");break;case"fail":c=R.a.t("上传失败");break;case"success":c=R.a.t("上传成功");break;case"cancel":c=R.a.t("取消上传");break;default:c=r?R.a.t("{{expireTime}}后过期",{expireTime:r}):R.a.t("已过期")}var l={id:e.id,fileName:e.extra.filename,fileSize:fc(e.extra.size,0),fileStatus:c,status:e.extra.cancel?"cancel":e._fileStatus,hasExpired:!r,progress:e._progress,speed:e._speed,cancelUpload:hc,disableDownload:!0};a=pe.a.createElement(Qi,Qa()({},t,l));break;default:a=null}return a}(e,r,t);break;case"redirect":n=pe.a.createElement($i,{name:e.toNickname});break;case"evaluation":var c={level:e.level,levelText:e.levelText,content:e.content};n=pe.a.createElement(Ki,c);break;case"blacklist":n=pe.a.createElement("span",null,R.a.t("你被移出了黑名单"));break;case"redirect_agent":n=pe.a.createElement(Xi,null,R.a.t("正在为您转接，请稍候.."));break;case"redirect_btn":n=pe.a.createElement(tr,{handleClick:o},R.a.t("转人工"));break;case"redirect_message_board":n=pe.a.createElement(tr,{handleClick:i,prevContent:R.a.t("抱歉没能理解您的提问，可选择")},R.a.t("留言"));break;case"system_msg":n=pe.a.createElement(Xi,null,e.content);break;default:n=null}return{base:r,component:n}}var Nc=Object(o.b)(function(e){return{showHistoryBtn:e.getIn(["message","showHistoryBtn"]),historyTimes:e.getIn(["message","historyTimes"]),historyLoading:e.getIn(["message","historyLoading"])}},function(e){return{dispatch:e}})(function(c){var e=c.showHistoryBtn,t=c.historyTimes,n=c.historyLoading,a=c.msgs,o=void 0===a?[]:a,i=Object(me.c)(),r=ra()(i,1)[0],l=r(0<t?"加载更多历史消息":"加载历史消息");n&&(l=r("加载中..."));var s=o.map(function(e){var t=jc(e,c),n=t.base,a=t.component;if("hybrid"===e.content_type&&"mini_program_card"===e.content[0].type)return null;var o=e.sensitive,i=e.extra&&e.extra.contains_sensitive_words||!1,r=(e.from_type,o||i);return pe.a.createElement(Cc,{key:e.id,id:e.id},pe.a.createElement(yc,{config:e,extra:n},a),pe.a.createElement(Sc,null,r?"!消息包含不规范用语":""))}),d=Object(ue.useRef)(null);return Object(ue.useEffect)(function(){!function(e){Dn=e}(d.current)},[d]),Object(ue.useEffect)(function(){Tn()},[]),pe.a.createElement(Ic,{history:e,ref:d},e?pe.a.createElement(Tc,{onClick:function(){return Pn({keepPosition:!0})}},pe.a.createElement("span",null,l)):null,s)}),Oc=X.isMobile()?"mobile":"desktop",Mc=d.d.div.withConfig({displayName:"frame-bubble-content__Wrapper",componentId:"lbgrtb-0"})(["width:100%;height:100%;color:#000;padding:10px;border-radius:5px;box-sizing:border-box;position:relative;.close{"," position:absolute;right:0;top:0;z-index:100;font-size:18px;width:30px;height:30px;line-height:30px;text-align:center;background:#fff;color:#999;cursor:pointer;}&:hover .close{display:block;}"],function(e){return"mobile"===e.device?"":"display: none;"}),Dc=d.d.div.withConfig({displayName:"frame-bubble-content__Header",componentId:"lbgrtb-1"})(["height:30px;display:flex;flex-direction:row;img{width:26px;height:26px;vertical-align:middle;}span{font-size:16px;line-height:26px;vertical-align:middle;padding-left:10px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}"]),zc=d.d.div.withConfig({displayName:"frame-bubble-content__Content",componentId:"lbgrtb-2"})(["font-size:14px;height:auto;max-height:60px;overflow:auto;"]),Bc=Object(o.b)(function(e){return{theme:e.get("theme"),unReadMsg:e.getIn(["message","unReadMsg"])}},function(e){return{dispatch:e}})(function(e){var t=e.unReadMsg,n=e.theme,a=e.dispatch;if(t){var o=t.agent,i=o.avatar,r=o.nickname,c=jc(t,{styles:n.get(Oc)}).component;return pe.a.createElement(Mc,Qa()({},e,{device:Oc}),pe.a.createElement("div",{className:"close",onClick:function(e){e.stopPropagation(),a(W(!1))}},"✕"),pe.a.createElement(Dc,null,pe.a.createElement("img",{alt:"Meiqia",src:i}),pe.a.createElement("span",null,r)),pe.a.createElement(zc,null,c))}return pe.a.createElement(Mc,e)}),Pc=X.isMobile()?"mobile":"desktop",Ac=d.d.div.withConfig({displayName:"bubble-arrow__Arrow",componentId:"sc-3uxf0p-0"})(["width:0;height:0;position:absolute;z-index:10;border:8px solid transparent;"," "," "," "," "," "," "," ",""],function(e){return e.left?"left: ".concat(e.left,";"):""},function(e){return e.right?"right: ".concat(e.right,";"):""},function(e){return e.top?"top: ".concat(e.top,";"):""},function(e){return e.bottom?"bottom: ".concat(e.bottom,";"):""},function(e){return e.transform?"transform: ".concat(e.transform,";"):""},function(e){return e["border-left"]?"border-left: ".concat(e["border-left"],";"):""},function(e){return e["border-right"]?"border-right: ".concat(e["border-right"],";"):""},function(e){return e["border-top"]?"border-top: ".concat(e["border-top"],";"):""}),qc=Object(o.b)(function(e){return{theme:e.get("theme")}})(function(e){var t=e.theme,n=function(e,t){var n,a,o={},i="left"===t?"right":"left";if("desktop"==Pc)switch(e){case"bottom":Le()(o,T()({bottom:"0","border-top":"9px solid #fff"},t,"40px"));break;default:Le()(o,(n={},T()(n,t,"0"),T()(n,"border-".concat(i),"9px solid #fff"),T()(n,"top","50%"),T()(n,"transform","translateY(-50%)"),n))}else switch(e){case"bottom":Le()(o,T()({bottom:"0","border-top":"9px solid #fff"},t,"40px"));break;case"aside":Le()(o,(a={},T()(a,t,"0"),T()(a,"border-".concat(i),"9px solid #fff"),T()(a,"top","50%"),T()(a,"transform","translateY(-50%)"),a))}return o}(t.getIn([Pc,"btn","type"]),t.getIn([Pc,"btn","position","type"]));return pe.a.createElement(Ac,n)});function Rc(){var e=Va()(["\n    html,body {\n        height:100%;\n        width:100%;\n        margin:0;\n        padding:0;\n    }\n    body {\n        padding: 16px;\n        box-sizing: border-box;\n    }\n"]);return Rc=function(){return e},e}var Lc=Object(d.c)(Rc()),Uc=d.d.div.withConfig({displayName:"router-bubble__Wrapper",componentId:"k6dy4k-0"})(["width:100%;height:100%;overflow:hidden;border-radius:5px;background:#fff;border:solid 1px #f7f7f7;box-shadow:0 0 14px 0 rgba(0,0,0,0.16);"]),Fc=Object(o.b)(function(e){return{router:e.get("router"),msg:e.get("message")}},null)(function(e){var t=e.msg,n=e.router;return pe.a.createElement(La,{visible:t.get("unReadPreview")&&n.get("showBubble"),component:Go,GlobalStyle:Lc,iframeName:"bubble"},pe.a.createElement(qc,null),pe.a.createElement(Uc,{onClick:function(){yt(!0,"chat"),Tn()}},pe.a.createElement(Bc,null)))}),Wc=X.isMobile();function Gc(e){switch(e){case"desktop.mondeo":case"desktop.fusion":return"standard";case"desktop.fiesta":case"desktop.focus":return"mini";case"desktop.edge":return"edge";case"desktop.customer":return"custom";case"mobile.fiesta":case"mobile.mustang":return"full";case"mobile.kuga":return"half";default:return"standard"}}function Vc(e,t){var n=Wc?"mobile":"desktop";if(t){var a=e.getIn(["standalone",n]);return a?{device:n,panel:{type:Gc("".concat(n,".").concat(a.type)),themeColor:"#".concat(a.theme[0]),fontColor:a.theme[1],profileBgColor:"#".concat(a.theme[2])}}:null}var o=e.getIn([n,"panel"]),i=e.getIn([n,"btn"]);return o&&i?{device:n,panel:{type:Gc("".concat(n,".").concat(o.type)),position:o.position,themeColor:"#".concat(o.theme[0]),fontColor:o.theme[1],profileBgColor:"#".concat(o.theme[2])},btn:{type:function(e){return e}(i.type),position:i.position,themeColor:"#".concat(i.theme)}}:null}function Hc(e,t){var n=e;m()(t).forEach(function(e){n.style[e]=t[e]})}function Qc(){var e=window.parent.document.querySelector("iframe[name=chat]").contentWindow.document.getElementById("_MEIQIA_IMAGE_PREVIEW_");e&&(e.style.display="none")}function Yc(){var e=window.parent.document.querySelector("iframe[name=chat]").contentWindow.document,t=e.getElementById("_MEIQIA_IMAGE_PREVIEW_");return t||function(e){var t=document.createElement("div"),n=document.createElement("div"),a=document.createElement("img");return t.id="_MEIQIA_IMAGE_PREVIEW_",Hc(t,{display:"none"}),Hc(n,{position:"absolute",textAlign:"center",top:0,bottom:0,right:0,left:0,zIndex:5,width:"100%",height:"auto",minHeight:"100%",backgroundColor:"rgba(0, 0, 0, 1)",fontSize:0,overflow:"auto"}),Hc(a,{width:"100%",height:"auto"}),n.appendChild(a),t.appendChild(n),e.body.appendChild(t),t}(e)}function $c(e){if(X.isMobile()){var t=Yc();!function(e){e.removeEventListener("click",Qc),e.addEventListener("click",Qc)}(t);try{t.getElementsByTagName("img")[0].src=e,t.style.display="block"}catch(e){console.log(e)}}}var Jc=d.d.iframe.withConfig({displayName:"frame-chat__FrameMain",componentId:"jge1pb-0"})(["border:none;margin:0;padding:0;overflow-x:visible;overflow-y:visible;overflow-wrap:normal;box-shadow:rgba(0,0,0,0.16) 0 5px 40px;border-radius:8px;position:fixed;z-index:9999999;",""],function(e){return e.styles?e.styles.join(""):""}),Kc=d.d.iframe.withConfig({displayName:"frame-chat__FrameMobile",componentId:"jge1pb-1"})(["border:none;margin:0;position:fixed;z-index:9999999;top:0;bottom:0;left:0;right:0;height:100% !important;overflow:hidden;box-sizing:border-box;",""],function(e){return e.styles?e.styles.join(""):""}),Zc=pe.a.forwardRef(function(e,t){var n,a=e.frameRef,o=e.customTheme,i=e.visible,r=e.theme,c=e.standalone,l=Vc(o,c),s=X.isMobile();return n=c?function(e){var t=["top: 50%;","left: 50%;","transform: translateX(-50%) translateY(-50%);"];if(!e)return["display: none !important;"];if(t.push(["display: block !important;"]),X.isMobile()){var n=window.parent.document.body.clientWidth;t.push("width: ".concat(n,"px !important;"))}else switch(e.type){case"standard":case"custom":t.push.apply(t,["width: 688px;","height: 540px;","min-height:250px;","max-height:700px;"]);break;case"mini":t.push.apply(t,["width: 500px;","height: 540px;"])}return t}(l?l.panel:r.panel):function(e,t){var n=[];if(!e)return["display: none !important;"];if(n.push(["display: block !important;"]),X.isMobile()){var a=window.parent.document.body.clientWidth;switch(n.push("width: ".concat(a,"px !important; max-width: 100% !important;")),t.type){case"half":n.push("padding-top: 60px;")}}else{var o=t.position,i=o.type,r=o.bottom,c=o.horizontal;switch(t.type){case"standard":case"custom":n.push.apply(n,["width: 688px !important;","height: 540px !important;","min-height:250px;","max-height:700px;"]),"center"===i?n.push.apply(n,["top: 50%;","left: 50%;","transform: translateX(-50%) translateY(-50%);"]):n.push.apply(n,["bottom: ".concat(r,"px;"),"".concat(i,": ").concat(c,"px;")]);break;case"edge":n.push.apply(n,["width: 320px !important;","height: 100% !important;","top:0;","bottom: 0;","".concat(i,":0;")]);break;case"mini":n.push.apply(n,["width: 320px !important;","height: 480px !important;","bottom: 0;","".concat(i,": ").concat(c,"px;")])}}return n}(i,l?l.panel:r.panel),s?pe.a.createElement(Kc,{name:"chat",frameborder:"0",scrolling:"no",styles:n,ref:a}):pe.a.createElement(Jc,{name:"chat",frameborder:"0",scrolling:"no",styles:n,ref:a})}),Xc=Object(d.e)(Object(o.b)(function(e){return{standalone:e.getIn(["config","standalone"]),customTheme:e.get("theme")}},function(e){return{dispatch:e}})(Zc));function el(e){return pe.a.createElement(ar,Le()({},e,{width:"auto",height:"auto"}))}var tl=d.d.div.withConfig({displayName:"title-bar__Header",componentId:"sc-1tx1lhu-0"})(["width:100%;height:60px;padding:10px 10px;display:flex;justify-content:center;align-items:center;font-size:14px;box-sizing:border-box;color:",";background:",";"],function(e){return e.fontColor},function(e){return e.themeColor}),nl=d.d.div.withConfig({displayName:"title-bar__HeaderLeft",componentId:"sc-1tx1lhu-1"})(["height:40px;flex:10 1 auto;overflow:hidden;position:relative;"," .avatar{","}"],function(e){return e.hasAvatar?"padding-left: 46px;":""},function(e){return e.hasAvatar?"\n                    position: absolute;\n                    left: 0;\n                    top: 0;\n                    height: 40px;\n                    border-radius: 50%;\n                ":"display: none;"}),al=d.d.div.withConfig({displayName:"title-bar__HeaderRight",componentId:"sc-1tx1lhu-2"})(["flex:1 1 auto;text-align:right;white-space:nowrap;padding:10px 0 10px 10px;"]),ol=d.d.div.withConfig({displayName:"title-bar__LeftWrap",componentId:"sc-1tx1lhu-3"})(["width:100%;display:inline-block;vertical-align:middle;.name{font-size:14px;}.signature{font-size:12px;}.name,.signature{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;width:100%;}.title{font-size:14px;line-height:40px;}"]),il=Object(d.d)(Io).withConfig({displayName:"title-bar__IconBtn",componentId:"sc-1tx1lhu-4"})(["vertical-align:middle;margin-left:5px;cursor:pointer;opacity:0.8;&:hover{opacity:1;}"]),rl=function(){window.parent.history.back()};function cl(e){var t=e.avatar,n=e.name,a=e.tel,o=e.signature,i=e.showBack,r=e.connecting,c=e.ringEnabled,l=e.closeEnabled,s=e.closeText,d=e.showSwitch,u=e.themeColor,p=e.fontColor,m=e.handleClose,f=e.handleRedirect,h=e.handleRing,g=X.isMobile(),b=void 0!==c&&!g,v=g&&a,_=Object(me.c)(),w=ra()(_,1)[0],y=Object(ue.useCallback)(function(){h(!c)},[h,c]);return pe.a.createElement(tl,{themeColor:u,fontColor:p},i?pe.a.createElement(il,{type:"mobile-page-back",width:"24px",height:"30px",handleClick:rl}):null,pe.a.createElement(nl,{hasAvatar:t},r?pe.a.createElement(ol,null,pe.a.createElement("div",{className:"title"},w("连接中..."))):pe.a.createElement(pe.a.Fragment,null,t?pe.a.createElement("img",{className:"avatar",alt:"#",src:t}):pe.a.createElement("span",{className:"avatar"}),pe.a.createElement(ol,null,n?pe.a.createElement("div",{className:o?"name":"title"},n):null,o?pe.a.createElement("div",{className:"signature"},o):null))),pe.a.createElement(al,null,d?pe.a.createElement(el,{fontColor:p,bgColor:"transparent",opacity:.8,handleClick:f},pe.a.createElement("span",null,w("转人工"))):null,b?pe.a.createElement(il,{type:c?"sound-white":"silent-white",width:"20px",height:"20px",handleClick:y}):null,v?pe.a.createElement("a",{href:"tel:".concat(a),target:"_parent"},pe.a.createElement(il,{type:"call",width:"20px",height:"20px"})):null,l?pe.a.createElement(il,{type:"hide-white",width:"20px",height:"20px",handleClick:m},s):null))}var ll=d.d.div.withConfig({displayName:"user-info__Container",componentId:"sc-8wgbg-0"})([""]),sl=d.d.img.withConfig({displayName:"user-info__Avatar",componentId:"sc-8wgbg-1"})(["width:100%;height:auto;"]),dl=d.d.div.withConfig({displayName:"user-info__Name",componentId:"sc-8wgbg-2"})(["padding:14px 0 14px 10px;word-break:break-all;font-size:15px;color:#646464;"]),ul=d.d.div.withConfig({displayName:"user-info__Item",componentId:"sc-8wgbg-3"})(["width:100%;line-height:22px;font-size:12px;word-break:break-all;padding:6px 0;.info{color:#abaaac;display:inline-block;vertical-align:middle;padding-left:10px;}"]);function pl(e){var t=e.name,n=e.avatar,a=e.tel,o=e.cellphone,i=e.email,r=e.qq,c=e.weixin;return pe.a.createElement(ll,null,pe.a.createElement(sl,{src:n}),pe.a.createElement(dl,null,t||""),a?pe.a.createElement(ul,null,pe.a.createElement(Io,{type:"tele",width:"20px",height:"20px"}),pe.a.createElement("span",{className:"info"},a)):null,o?pe.a.createElement(ul,null,pe.a.createElement(Io,{type:"phone",width:"20px",height:"20px"}),pe.a.createElement("span",{className:"info"},o)):null,i?pe.a.createElement(ul,null,pe.a.createElement(Io,{type:"email",width:"20px",height:"20px"}),pe.a.createElement("span",{className:"info"},i)):null,r?pe.a.createElement(ul,null,pe.a.createElement(Io,{type:"qq",width:"20px",height:"20px"}),pe.a.createElement("span",{className:"info"},r)):null,c?pe.a.createElement(ul,null,pe.a.createElement(Io,{type:"wechat",width:"20px",height:"20px"}),pe.a.createElement("span",{className:"info"},c)):null)}var ml=d.d.a.withConfig({displayName:"support__Container",componentId:"lrhi0c-0"})(["display:flex;flex-wrap:nowrap;align-items:center;justify-content:center;width:100%;height:30px;line-height:30px;text-align:center;font-size:12px;color:#b7bac2;background-color:#f4f4f4;border-top:#ededed;text-decoration:none;"]),fl=d.d.span.withConfig({displayName:"support__Text",componentId:"lrhi0c-1"})(["display:inline-block;vertical-align:middle;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;"]);function hl(e){var t=Object(me.c)(),n=(0,ra()(t,1)[0])("客服软件由美洽提供");return pe.a.createElement(ml,{target:"_blank",href:e.link},pe.a.createElement(Io,{type:"support",width:"20px",height:"20px"}),pe.a.createElement(fl,{title:n},n))}var gl=d.d.div.withConfig({displayName:"side-panel__Container",componentId:"sc-1tvj7eq-0"})(["width:100%;height:100%;position:relative;box-sizing:border-box;",";"],function(e){return e.bgColor?"background:".concat(e.bgColor,";"):""}),bl=d.d.div.withConfig({displayName:"side-panel__Content",componentId:"sc-1tvj7eq-1"})(["width:100%;height:100%;padding:10px;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;padding-bottom:",";"],function(e){return e.showSupport?"30px":0}),vl=d.d.div.withConfig({displayName:"side-panel__Custom",componentId:"sc-1tvj7eq-2"})(["ul,ol{list-style:none;padding:5px 0;}"]),_l=d.d.div.withConfig({displayName:"side-panel__Support",componentId:"sc-1tvj7eq-3"})(["position:absolute;left:0;right:0;bottom:0;width:100%;height:30px;"]);function wl(e){var t=e.showSupport,n=e.supportLink,a=e.bgColor,o=e.userInfo,i=e.custom,r=e.showAvatar,c=void 0===r||r;return pe.a.createElement(gl,{bgColor:a},pe.a.createElement(bl,{showSupport:t},c?pe.a.createElement(pl,o):null,i?pe.a.createElement(vl,{dangerouslySetInnerHTML:{__html:i}}):null),t?pe.a.createElement(_l,null,pe.a.createElement(hl,{link:n})):null)}var yl=30,xl=d.d.div.withConfig({displayName:"action-tooltip__Container",componentId:"sc-12tnxr9-0"})(["position:relative;height:","px;padding:5px 10px 5px 14px;box-sizing:border-box;display:flex;flex-direction:row;&:after{content:' ';display:table;clear:both;}"],function(e){return e.tHeight}),kl=d.d.div.withConfig({displayName:"action-tooltip__BtnsWrap",componentId:"sc-12tnxr9-1"})(["display:flex;align-items:center;flex-grow:0;flex-wrap:nowrap;height:100%;"]),El=d.d.div.withConfig({displayName:"action-tooltip__Btns",componentId:"sc-12tnxr9-2"})(["height:20px;display:flex;flex-wrap:nowrap;"]),Il=d.d.div.withConfig({displayName:"action-tooltip__Custom",componentId:"sc-12tnxr9-3"})(["flex-grow:1;width:100%;text-align:right;"]),Cl=Object(d.d)(Io).withConfig({displayName:"action-tooltip__IconBtn",componentId:"sc-12tnxr9-4"})(["vertical-align:middle;margin-right:6px;cursor:pointer;opacity:0.8;&:hover{opacity:1;}"]),Tl=d.d.span.withConfig({displayName:"action-tooltip__InputSpan",componentId:"sc-12tnxr9-5"})(["visibility:hidden;position:absolute;"]);function Sl(e){var t=e.height,n=void 0===t?yl:t,a=e.toggleEmojiPanel,o=e.showEvaluation,i=e.className,r=e.showEva,c=e.showFile,l=e.sendImage,s=e.uploadFile,d=e.clickImage,u=e.clickFile,p=Object(me.c)(),m=ra()(p,1)[0];return pe.a.createElement(xl,{tHeight:n,className:i},pe.a.createElement(kl,null,pe.a.createElement(El,null,pe.a.createElement(Cl,{title:m("表情"),type:"face",width:"20px",height:"20px",handleClick:a}),pe.a.createElement(Cl,{title:m("发送图片"),type:"picture",width:"20px",height:"20px"},pe.a.createElement(Tl,null,pe.a.createElement("input",{id:"photoFile",type:"file",accept:"image/*",onClick:d,onChange:l}))),c?pe.a.createElement(Cl,{title:m("发送文件"),type:"file",width:"20px",height:"20px"},pe.a.createElement(Tl,null,pe.a.createElement("input",{id:"uploadFile",type:"file",onClick:u,onChange:s}))):null,r?pe.a.createElement(Cl,{title:m("评价"),type:"good",width:"20px",height:"20px",handleClick:o}):null)),pe.a.createElement(Il,null,e.children))}var jl,Nl,Ol,Ml,Dl=n(466),zl=n.n(Dl),Bl=["smile","laughing","blush","heart_eyes","smirk","flushed","grin","kissing_smiling_eyes","wink","kissing_closed_eyes","stuck_out_tongue_winking_eye","sleeping","worried","sweat_smile","cold_sweat","joy","sob","angry","mask","scream","sunglasses","thumbsup","clap","ok_hand"],Pl=d.d.label.withConfig({displayName:"emoji-panel__Span",componentId:"sc-6f4l8l-0"})(["display:inline-block;vertical-align:middle;max-height:200px;overflow-y:auto;"]),Al=d.d.span.withConfig({displayName:"emoji-panel__IconWrap",componentId:"sc-6f4l8l-1"})(["display:inline-block;vertical-align:middle;margin:10px;cursor:pointer;"]),ql=pe.a.forwardRef(function(e,t){var n=e.children,a=e.handleClick,o=e.className,i=Bl.map(function(e,t){var n=["0","".concat(-25*t,"px")];return pe.a.createElement(Al,{key:e,onClick:function(){return a(e)}},pe.a.createElement(ro,{width:"25px",height:"25px",image:zl.a,position:n,bgSize:"25px auto"}))});return pe.a.createElement(Pl,{className:o,ref:t},i,n||null)}),Rl=(jl=function(e){var t=ln.getState(),n=ln.dispatch,a=t.get("message"),o=1*new Date,i=a.get("schedulerAfterClientSendMsg"),r={id:o,from_type:"client",content_type:"text",status:"sending",content:e,type:"text"},c={id:o,content_type:"text",content:e};ta&&(na.forEach(function(e){return clearTimeout(e)}),na=[]),a.get("convId")?a.get("chatHasEnd")?(Qn(),n(dt(c)),n(it({schedulerMsg:!0}))):(n(rt(r)),xn(r)):(i&&!a.get("scheduler")&&(Qn(),n(it({schedulerAfterClientSendMsg:!1,schedulerMsg:!0,queue:[]}))),n(dt(c))),Tn()},Nl=300,Ol=!0,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=Ol&&!Ml;clearTimeout(Ml),Ml=setTimeout(function(){Ml=null,Ol||jl.apply(void 0,t)},Nl),a&&jl.apply(void 0,t)});n(262);function Ll(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function Ul(e,t){var n=ln.getState().get("config");try{var a="unsentMsg-".concat(n.get("entId"),"-").concat(n.get("trackId"));if("get"===e)return Ze("get",a);if("set"===e)return Ze("set",a,t),!0;if("remove"===e)return Ze("remove",a),!0}catch(e){return!1}return!1}var Fl=d.d.div.withConfig({displayName:"action-textarea__Container",componentId:"m7qpvj-0"})(["height:100%;width:100%;box-sizing:border-box;"]),Wl=d.d.textarea.withConfig({displayName:"action-textarea__Textarea",componentId:"m7qpvj-1"})(["display:block;width:100%;height:100%;resize:none;padding:8px 10px;outline:0;background:#fff;border:none;font-size:13px;line-height:",";"],function(e){return e.lineHeight||"15px"}),Gl=d.d.input.withConfig({displayName:"action-textarea__Input",componentId:"m7qpvj-2"})(["display:block;width:100%;height:100%;padding:8px 10px;outline:0;background:#fff;border:none;font-size:13px;line-height:",";"],function(e){return e.lineHeight||"15px"}),Vl=pe.a.forwardRef(function(e,t){var n=e.value,a=e.handleKeyDown,o=e.handleInput,i=e.handleKeyUp,r=e.handleFocus,c=e.handleBlur,l=e.handlePaste,s=po()(e,["value","handleKeyDown","handleInput","handleKeyUp","handleFocus","handleBlur","handlePaste"]),d=Object(me.c)(),u=ra()(d,1)[0],p=X.isMobile(),m=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ll(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):Ll(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},s,{ref:t,value:n,placeholder:u("请输入"),onClick:o,onChange:o,onKeyUp:i,onKeyDown:a,onFocus:r,onBlur:c,onPaste:l});return pe.a.createElement(Fl,null,p?pe.a.createElement("form",{action:"javascript:void(0);"},pe.a.createElement(Gl,Qa()({},m,{type:"text",autoComplete:"off"}))):pe.a.createElement(Wl,m))}),Hl=function(e){if(e.clipboardData.items)for(var t=e.clipboardData.items,n=0,a=t.length;n<a;n+=1)if(t[n].type.match(/^image\//)){var o=t[n].getAsFile(),i={id:Math.random(),from_type:"client",content_type:"photo",status:"sending",media_url:bc.a,file:o};oc(i)}},Ql=!1,Yl="",$l=function t(e){var n=ln.getState(),a=n.get("config"),o=a.get("entId"),i=a.get("trackId"),r=n.getIn(["message","agent"]),c=n.getIn(["message","chatHasEnd"]),l=n.getIn(["message","scheduler"]);if(Yl=e,!Ql&&l&&!c&&r){var s={ent_id:o,agent_id:r?r.id:null,track_id:i,content:e};Ql=!0,function(e){return fe({url:"/client/inputting",method:"post",headers:{"content-type":"application/json"},data:e})}(s).then(function(e){setTimeout(function(){Ql=!1,s.content!==Yl&&t(Yl)},3e3)},function(){setTimeout(function(){Ql=!1},3e3)})}},Jl=X.isMobile()?"mobile":"desktop",Kl=d.d.div.withConfig({displayName:"chat-textarea__Container",componentId:"catw5r-0"})(["width:100%;height:100%;position:relative;"]),Zl=d.d.div.withConfig({displayName:"chat-textarea__AutoFit",componentId:"catw5r-1"})(["position:absolute;top:0;width:100%;z-index:300;box-sizing:border-box;padding:10px 13px 5px 10px;transform:translateY(-100%);ul{background:#fff;box-shadow:0 0 12px 1px rgba(0,0,0,0.2);}li{list-style:none;color:#888;border-top:solid 1px #eee;& > a{display:block;padding:10px;em{color:#6088e6;}}&:hover,&.selected{color:#fff;cursor:pointer;background:",";& > a em{color:#fff;}}}"],function(e){return"#".concat(e.themeColor)}),Xl=Object(o.b)(function(e){return{autoFit:e.getIn(["message","autoFit"]),autoFitSelected:e.getIn(["message","autoFitSelected"]),themeColor:e.getIn(["theme",Jl,"panel","theme"])}},function(e){return{dispatch:e}})(function(e){var t,n,a=e.autoFit,o=e.autoFitSelected,i=e.sendMsg,r=e.setPos,c=e.setContent,l=e.content,s=e.lineHeight,d=e.themeColor,u=e.inputRef,p=(t=a,n=o,pe.a.createElement("ul",null,t.map(function(e,t){return pe.a.createElement("li",{key:e.question_id,className:n===t?"selected":""},pe.a.createElement("a",{onClick:function(){return function(e){i(e.replace(/<em>|<\/em>/g,""))}(e.question)},dangerouslySetInnerHTML:{__html:e.question}}))})));return Object(ue.useEffect)(function(){return function(){ge.wxScroll()}},[]),pe.a.createElement(Kl,null,a&&0<a.length?pe.a.createElement(Zl,{themeColor:d&&d[0]},p):null,pe.a.createElement(Vl,{id:"_MEIQIA_INPUT",value:l,handleInput:function(e){var t=e.target.value,n=e.target.selectionStart,a=e.target.selectionEnd;c(t),r({start:n,end:a})},handleKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),i());var t="";38===e.keyCode?t=_n.select("prev"):40===e.keyCode&&(t=_n.select("next")),t&&c(t)},handleKeyUp:function(e){var t=e.target.value.trim();2048<t.length&&(c(t.substr(0,2048)),za("最多只能发送 2048 个字符哦",3e3)),$l(t);var n=e.which||e.keyCode;38!==n&&40!==n&&_n.search(t)},handleFocus:function(){"hoist"===ge.fixInput()&&e.dispatch(vt(!0))},handleBlur:function(){ge.wxScroll(),setTimeout(function(){e.dispatch(vt(!1)),_n.remove()},100)},handlePaste:function(e){Hl(e)},lineHeight:s,ref:u}))}),es=d.d.div.withConfig({displayName:"action-box__Container",componentId:"sc-13hjnnn-0"})(["height:100%;width:100%;border-top:1px solid #ededed;position:relative;padding-bottom:40px;box-sizing:border-box;"]),ts=d.d.div.withConfig({displayName:"action-box__FinishTip",componentId:"sc-13hjnnn-1"})(["width:100%;height:100%;position:absolute;z-index:2;left:0;right:0;top:0;bottom:0;text-align:center;background:#fff;display:table;span{display:table-cell;vertical-align:middle;word-break:break-word;padding:0 20px;}"]),ns=d.d.div.withConfig({displayName:"action-box__EmojiPanelWrap",componentId:"sc-13hjnnn-2"})(["position:absolute;top:-","px;background:#fff;border-top:1px solid #ddd;z-index:2;left:1px;right:1px;box-sizing:border-box;visibility:",";"],function(e){return e.emojiHeight+2},function(e){return e.visible?"visible":"hidden"}),as=d.d.a.withConfig({displayName:"action-box__Link",componentId:"sc-13hjnnn-3"})(["color:#4ca0ff;padding:0 5px;cursor:pointer;"]),os=Object(o.b)(function(e){return{socket:e.getIn(["config","socket"])}},function(e){return{dispatch:e}})(function(e){function n(e){T(e),e?Ul("set",e):Ul("remove")}function t(e){var t=e?e.trim():C.trim();t&&!m&&(a||za("服务连接中，请稍候…",3e3),Rl(t),n(""),_n.remove(),O({start:0,end:0}))}var a=e.socket,o=e.themeColor,i=e.fontColor,r=e.finish,c=e.showEvaluation,l=e.showEva,s=e.sendImage,d=e.fileEnabled,u=e.uploadFile,p=e.checkSocket,m=e.blacklist,f=e.newConversation,h=e.toMessageBoard,g=Object(ue.useState)(0),b=ra()(g,2),v=b[0],_=b[1],w=Object(ue.useState)(!1),y=ra()(w,2),x=y[0],k=y[1],E=Object(ue.useState)(function(){return Ul("get")||""}),I=ra()(E,2),C=I[0],T=I[1],S=Object(ue.useState)({start:0,end:0}),j=ra()(S,2),N=j[0],O=j[1],M=Object(ue.useRef)(null),D=Object(ue.useRef)(null),z=Object(me.c)(),B=ra()(z,1)[0],P=Object(ue.useCallback)(function(){return k(!x)},[k,x]);return Object(ue.useEffect)(function(){_(M.current.offsetHeight)},[]),pe.a.createElement(es,null,pe.a.createElement(Xl,{sendMsg:t,setPos:O,setContent:n,content:C,inputRef:D}),pe.a.createElement(Sl,{height:40,clickImage:p,clickFile:p,sendImage:s,uploadFile:u,showEva:l,showFile:d,toggleEmojiPanel:P,showEvaluation:c},pe.a.createElement(ar,{bgColor:o,fontColor:i,handleClick:function(){return t()}},pe.a.createElement("span",null,B("发送")))),pe.a.createElement(ns,{emojiHeight:v,visible:x},pe.a.createElement(ql,{ref:M,handleClick:function(e){var t=e.length+2;k(!1),n("".concat(C.slice(0,N.start),":").concat(e,":").concat(C.slice(N.end))),O({start:N.start+t,end:N.start+t}),setTimeout(function(){var e=D.current.value;D.current.focus(),D.current.selectionStart=N.start+t,D.current.selectionEnd=N.start+t,2048<e.length&&(n(e.substr(0,2048)),za("最多只能发送 2048 个字符哦",3e3))},0)}})),r?pe.a.createElement(ts,null,pe.a.createElement("span",null,pe.a.createElement(me.a,null,"对话已结束，您可以",pe.a.createElement(as,{onClick:f},"开始新的对话"),"或",pe.a.createElement(as,{onClick:h},"留言")))):null,m?pe.a.createElement(ts,null,pe.a.createElement("span",null,B("抱歉，客服系统暂时无法使用"))):null)});function is(e){return pe.a.createElement(ar,Le()({},e,{width:"100%"}))}var rs=d.d.div.withConfig({displayName:"evaluation__Container",componentId:"sc-4mk0t7-0"})(["position:relative;width:100%;height:100%;"]),cs=d.d.div.withConfig({displayName:"evaluation__CloseBtn",componentId:"sc-4mk0t7-1"})(["position:absolute;right:10px;top:10px;width:20px;height:20px;"]),ls=d.d.div.withConfig({displayName:"evaluation__Header",componentId:"sc-4mk0t7-2"})(["padding:10px 30px 0;box-sizing:border-box;width:100%;text-align:center;font-size:14px;color:#666;"]),ss=d.d.div.withConfig({displayName:"evaluation__Btns",componentId:"sc-4mk0t7-3"})(["text-align:center;margin-top:10px;"]),ds=d.d.div.withConfig({displayName:"evaluation__Btn",componentId:"sc-4mk0t7-4"})(["display:inline-block;width:60px;height:70px;margin:0 5px;border:1px solid #fff;cursor:pointer;color:#666;padding-top:10px;&:hover,&.selected{color:",";background-color:#f0f0f0;border-color:#f0f0f0;border-radius:3px;}p{padding-top:5px;}"],function(e){return e.color}),us=d.d.div.withConfig({displayName:"evaluation__Content",componentId:"sc-4mk0t7-5"})(["padding:10px 20px 15px;"]),ps=d.d.textarea.withConfig({displayName:"evaluation__Textarea",componentId:"sc-4mk0t7-6"})(["width:100%;height:60px;padding:10px;box-sizing:border-box;overflow-y:auto;resize:none;outline:none;border:1px solid #ededed;"]),ms=Object(d.d)(is).withConfig({displayName:"evaluation__Submit",componentId:"sc-4mk0t7-7"})(["margin-top:10px;"]),fs=Object(d.d)(Io).withConfig({displayName:"evaluation__Icon",componentId:"sc-4mk0t7-8"})(["cursor:pointer;"]),hs={height:"35px",fontColor:"#fff",bgColor:"#007aff"};function gs(e){var t=e.handleClose,n=e.handleSubmit,a=e.promptText,o=void 0===a?"":a,i=e.themeColor,r=e.fontColor,c=Object(ue.useState)(""),l=ra()(c,2),s=l[0],d=l[1],u=Object(ue.useState)(null),p=ra()(u,2),m=p[0],f=p[1],h=Object(me.c)(),g=ra()(h,1)[0];return pe.a.createElement(rs,null,pe.a.createElement(cs,null,pe.a.createElement(fs,{handleClick:t,type:"close",width:"20px",height:"20px"})),pe.a.createElement(ls,null,o),pe.a.createElement(ss,null,pe.a.createElement(ds,{color:"#00ce7d",onClick:function(){return f(2)},className:2===m?"selected":""},pe.a.createElement(fs,{type:"eva-good",width:"40px",height:"40px"}),pe.a.createElement("p",null,g("好评"))),pe.a.createElement(ds,{color:"#ffb652",onClick:function(){return f(1)},className:1===m?"selected":""},pe.a.createElement(fs,{type:"eva-normal",width:"40px",height:"40px"}),pe.a.createElement("p",null,g("中评"))),pe.a.createElement(ds,{color:"#ff5c5e",onClick:function(){return f(0)},className:0===m?"selected":""},pe.a.createElement(fs,{type:"eva-bad",width:"40px",height:"40px"}),pe.a.createElement("p",null,g("差评")))),pe.a.createElement(us,null,pe.a.createElement(ps,{placeholder:g("请填写评价内容（选填）"),value:s,onBlur:ge.wxScroll,onChange:function(e){return d(e.target.value)}}),pe.a.createElement(ms,Qa()({},hs,{handleClick:function(){[0,1,2].includes(m)?30<s.length?za("最多只能发送 30 个字符哦",3e3):n({level:m,content:s.trim()}):za("请选择评价等级",3e3)},bgColor:i,fontColor:r}),pe.a.createElement("span",null,g("提交")))))}var bs=d.d.div.withConfig({displayName:"evaluation__Mask",componentId:"sc-17nztew-0"})(["width:100%;height:100%;background:rgba(0,0,0,0.35);"]),vs=d.d.div.withConfig({displayName:"evaluation__EvaPanel",componentId:"sc-17nztew-1"})(["position:absolute;background:#fff;min-height:254px;max-height:300px;z-index:600;"," ",""],function(e){return"fixed"===e.width?"width:320px;":"width:100%;"},function(e){return"center"===e.position?"top:50%;left:50%;margin:-125px 0 0 -160px;":"top:0;"});var _s=Object(o.b)(function(e){return{message:e.get("message")}},function(e){return{dispatch:e}})(function(o){var e=o.closeEvaluation,t=po()(o,["closeEvaluation"]),n=Object(me.c)(),i=ra()(n,1)[0];return pe.a.createElement(bs,null,pe.a.createElement(vs,o,pe.a.createElement(gs,Qa()({},t,{handleClose:e,handleSubmit:function(a){(function(e,t){return fe({url:"/conversation/".concat(e,"/evaluation"),method:"post",headers:{"content-type":"application/json"},data:t})})(o.message.get("convId"),a).then(function(e){if(e.data.success){var t=i("好评");0===a.level?t=i("差评"):1===a.level&&(t=i("中评"));var n={id:1*new Date,from_type:"evaluation",level:a.level,levelText:t,content:a.content};o.dispatch(rt(n)),Tn()}else za("评价失败，请稍后重试",2e3)},function(){za("评价失败，请稍后重试",2e3)}).finally(function(){e()})}}))))});function ws(e,t){return Le()({themeColor:e.themeColor,fontColor:e.fontColor},t)}var ys={getTitleBar:function(e){return ws(e,{})},getMsgText:function(e){return ws(e,{})},getActionBox:function(e){return ws(e,{})},getEvaluation:function(e){return ws(e,{})}};function xs(n,e){var a={};return e.forEach(function(e){var t=ys["get".concat(e)];ys["get".concat(e)]&&(a[e]=t(n))}),a}var ks=d.d.div.withConfig({displayName:"chat-desktop-standard__Base",componentId:"sc-1a5eik6-0"})(["width:100%;height:100%;box-sizing:border-box;"]),Es=Object(d.d)(ks).withConfig({displayName:"chat-desktop-standard__MainContainer",componentId:"sc-1a5eik6-1"})(["overflow:hidden;padding-top:60px;position:relative;background:#fcfcfc;"]),Is=Object(d.d)(ks).withConfig({displayName:"chat-desktop-standard__Container",componentId:"sc-1a5eik6-2"})(["position:relative;background:#fcfcfc;padding-right:200px;"]),Cs=d.d.div.withConfig({displayName:"chat-desktop-standard__EvaPanel",componentId:"sc-1a5eik6-3"})(["position:absolute;z-index:100;left:0;right:0;bottom:0;top:0;"]),Ts=d.d.div.withConfig({displayName:"chat-desktop-standard__TitleWrap",componentId:"sc-1a5eik6-4"})(["position:absolute;top:0;width:100%;"]),Ss=Object(d.d)(ks).withConfig({displayName:"chat-desktop-standard__MainPanel",componentId:"sc-1a5eik6-5"})(["padding-bottom:100px;position:relative;"]),js=d.d.div.withConfig({displayName:"chat-desktop-standard__SidePanelWrap",componentId:"sc-1a5eik6-6"})(["width:200px;position:absolute;right:0;top:0;bottom:0;border-left:1px solid #e8e8e8;"]),Ns=Object(d.d)(ks).withConfig({displayName:"chat-desktop-standard__MsgWindowWrap",componentId:"sc-1a5eik6-7"})([""]),Os=d.d.div.withConfig({displayName:"chat-desktop-standard__InputWrap",componentId:"sc-1a5eik6-8"})(["width:100%;height:100px;background:#fcfcfc;position:absolute;bottom:0;"]);function Ms(e){var t=e.titleBar,n=e.evaluation,a=n.enable,o=n.promptText,i=n.setEvaluation,r=e.msgWindow,c=e.agentInfo,l=e.actionTooltip,s=xs(e.styles.panel,["TitleBar","ActionBox","Evaluation"]),d=Object(ue.useCallback)(function(){i(!1)},[i]),u=Object(ue.useCallback)(function(){i(!0)},[i]);return Object(ue.useEffect)(function(){Ke.updatePosition()},[]),pe.a.createElement(Es,null,pe.a.createElement(Ts,null,pe.a.createElement(cl,Qa()({},s.TitleBar,c,t,{avatar:""}))),pe.a.createElement(Is,null,a?pe.a.createElement(Cs,null,pe.a.createElement(_s,Qa()({},s.Evaluation,{position:"center",width:"fixed",promptText:o,closeEvaluation:d}))):null,pe.a.createElement(Ss,null,pe.a.createElement(Ns,null,pe.a.createElement(Nc,Qa()({styles:e.styles},r))),pe.a.createElement(Os,null,pe.a.createElement(os,Qa()({},s.ActionBox,l,{showEvaluation:u})))),pe.a.createElement(js,null,pe.a.createElement(wl,Qa()({userInfo:c},e.support)))))}var Ds=d.d.div.withConfig({displayName:"chat-desktop-mini__Base",componentId:"sc-1mdwt15-0"})(["width:100%;height:100%;box-sizing:border-box;"]),zs=Object(d.d)(Ds).withConfig({displayName:"chat-desktop-mini__MainContainer",componentId:"sc-1mdwt15-1"})(["position:relative;background:#fcfcfc;box-sizing:border-box;overflow:hidden;padding-top:60px;"]),Bs=Object(d.d)(Ds).withConfig({displayName:"chat-desktop-mini__Container",componentId:"sc-1mdwt15-2"})(["position:relative;background:#fcfcfc;padding-bottom:","px;"],function(e){return e.showSupport?130:100}),Ps=d.d.div.withConfig({displayName:"chat-desktop-mini__EvaPanel",componentId:"sc-1mdwt15-3"})(["position:absolute;z-index:100;left:0;right:0;bottom:0;top:0;"]),As=d.d.div.withConfig({displayName:"chat-desktop-mini__TitleWrap",componentId:"sc-1mdwt15-4"})(["position:absolute;top:0;width:100%;"]),qs=Object(d.d)(Ds).withConfig({displayName:"chat-desktop-mini__MsgWindowWrap",componentId:"sc-1mdwt15-5"})([""]),Rs=d.d.div.withConfig({displayName:"chat-desktop-mini__InputWrap",componentId:"sc-1mdwt15-6"})(["width:100%;height:100px;background:#fcfcfc;"]),Ls=d.d.div.withConfig({displayName:"chat-desktop-mini__Support",componentId:"sc-1mdwt15-7"})(["width:100%;height:30px;"]);function Us(e){var t=e.standalone,n=e.titleBar,a=e.evaluation,o=a.enable,i=a.promptText,r=a.setEvaluation,c=e.msgWindow,l=e.agentInfo,s=e.actionTooltip,d=xs(e.styles.panel,["TitleBar","ActionBox","Evaluation"]),u=Object(ue.useCallback)(function(){r(!1)},[r]),p=Object(ue.useCallback)(function(){r(!0)},[r]);return pe.a.createElement(zs,null,pe.a.createElement(As,null,pe.a.createElement(cl,Qa()({},d.TitleBar,l,n))),pe.a.createElement(Bs,{showSupport:e.support.showSupport,standalone:t},o?pe.a.createElement(Ps,null,pe.a.createElement(_s,Qa()({},d.Evaluation,{position:"top",width:"auto",promptText:i,closeEvaluation:u}))):null,pe.a.createElement(qs,null,pe.a.createElement(Nc,Qa()({styles:e.styles},c))),pe.a.createElement(Rs,null,pe.a.createElement(os,Qa()({},d.ActionBox,s,{showEvaluation:p}))),e.support.showSupport?pe.a.createElement(Ls,null,pe.a.createElement(hl,{link:e.support.supportLink})):null))}var Fs=d.d.div.withConfig({displayName:"chat-desktop-edge__Base",componentId:"sc-1otnyex-0"})(["width:100%;height:100%;box-sizing:border-box;"]),Ws=Object(d.d)(Fs).withConfig({displayName:"chat-desktop-edge__MainContainer",componentId:"sc-1otnyex-1"})(["box-sizing:border-box;overflow:hidden;padding-top:60px;position:relative;background:#fcfcfc;"]),Gs=Object(d.d)(Fs).withConfig({displayName:"chat-desktop-edge__Container",componentId:"sc-1otnyex-2"})(["position:relative;background:#fcfcfc;padding-bottom:","px;"],function(e){return e.showSupport?130:100}),Vs=d.d.div.withConfig({displayName:"chat-desktop-edge__EvaPanel",componentId:"sc-1otnyex-3"})(["position:absolute;z-index:100;left:0;right:0;bottom:0;top:0;"]),Hs=d.d.div.withConfig({displayName:"chat-desktop-edge__TitleWrap",componentId:"sc-1otnyex-4"})(["position:absolute;top:0;width:100%;"]),Qs=Object(d.d)(Fs).withConfig({displayName:"chat-desktop-edge__MsgWindowWrap",componentId:"sc-1otnyex-5"})([""]),Ys=d.d.div.withConfig({displayName:"chat-desktop-edge__BottomWrap",componentId:"sc-1otnyex-6"})(["width:100%;position:absolute;left:0;right:0;bottom:0;"]),$s=d.d.div.withConfig({displayName:"chat-desktop-edge__InputWrap",componentId:"sc-1otnyex-7"})(["width:100%;height:100px;background:#fcfcfc;"]),Js=d.d.div.withConfig({displayName:"chat-desktop-edge__Support",componentId:"sc-1otnyex-8"})(["width:100%;height:30px;"]);function Ks(e){var t=e.titleBar,n=e.evaluation,a=n.enable,o=n.promptText,i=n.setEvaluation,r=e.msgWindow,c=e.agentInfo,l=e.actionTooltip,s=xs(e.styles.panel,["TitleBar","ActionBox","Evaluation"]),d=Object(ue.useCallback)(function(){i(!1)},[i]),u=Object(ue.useCallback)(function(){i(!0)},[i]);return pe.a.createElement(Ws,null,pe.a.createElement(Hs,null,pe.a.createElement(cl,Qa()({},s.TitleBar,c,t))),pe.a.createElement(Gs,{showSupport:e.support.showSupport},a?pe.a.createElement(Vs,null,pe.a.createElement(_s,Qa()({},s.Evaluation,{position:"center",width:"auto",promptText:o,closeEvaluation:d}))):null,pe.a.createElement(Qs,null,pe.a.createElement(Nc,Qa()({styles:e.styles},r))),pe.a.createElement(Ys,null,pe.a.createElement($s,null,pe.a.createElement(os,Qa()({},s.ActionBox,l,{showEvaluation:u}))),e.support.showSupport?pe.a.createElement(Js,null,pe.a.createElement(hl,{link:e.support.supportLink})):null)))}var Zs=d.d.div.withConfig({displayName:"chat-desktop-custom__Base",componentId:"sc-1ayd97u-0"})(["width:100%;height:100%;box-sizing:border-box;"]),Xs=Object(d.d)(Zs).withConfig({displayName:"chat-desktop-custom__MainContainer",componentId:"sc-1ayd97u-1"})(["overflow:hidden;padding-top:60px;position:relative;background:#fcfcfc;"]),ed=Object(d.d)(Zs).withConfig({displayName:"chat-desktop-custom__Container",componentId:"sc-1ayd97u-2"})(["position:relative;background:#fcfcfc;padding-right:200px;"]),td=d.d.div.withConfig({displayName:"chat-desktop-custom__EvaPanel",componentId:"sc-1ayd97u-3"})(["position:absolute;z-index:100;left:0;right:0;bottom:0;top:0;"]),nd=d.d.div.withConfig({displayName:"chat-desktop-custom__TitleWrap",componentId:"sc-1ayd97u-4"})(["position:absolute;top:0;width:100%;"]),ad=Object(d.d)(Zs).withConfig({displayName:"chat-desktop-custom__MainPanel",componentId:"sc-1ayd97u-5"})(["padding-bottom:100px;position:relative;"]),od=d.d.div.withConfig({displayName:"chat-desktop-custom__SidePanelWrap",componentId:"sc-1ayd97u-6"})(["width:200px;position:absolute;right:0;top:0;bottom:0;border-left:1px solid #e8e8e8;"]),id=Object(d.d)(Zs).withConfig({displayName:"chat-desktop-custom__MsgWindowWrap",componentId:"sc-1ayd97u-7"})([""]),rd=d.d.div.withConfig({displayName:"chat-desktop-custom__InputWrap",componentId:"sc-1ayd97u-8"})(["width:100%;height:100px;background:#fcfcfc;position:absolute;bottom:0;"]);function cd(e){var t=e.titleBar,n=e.evaluation,a=n.enable,o=n.promptText,i=n.setEvaluation,r=e.msgWindow,c=e.agentInfo,l=e.actionTooltip,s=xs(e.styles.panel,["TitleBar","ActionBox","Evaluation"]),d=e.panel,u=d.customer_content,p=d.customer_photo_type,m=Object(ue.useCallback)(function(){i(!1)},[i]),f=Object(ue.useCallback)(function(){i(!0)},[i]);return Object(ue.useEffect)(function(){Ke.updatePosition()},[]),pe.a.createElement(Xs,null,pe.a.createElement(nd,null,pe.a.createElement(cl,Qa()({},s.TitleBar,c,t,{avatar:"small"===p?c.avatar:""}))),pe.a.createElement(ed,null,a?pe.a.createElement(td,null,pe.a.createElement(_s,Qa()({},s.Evaluation,{position:"center",width:"fixed",promptText:o,closeEvaluation:m}))):null,pe.a.createElement(ad,null,pe.a.createElement(id,null,pe.a.createElement(Nc,Qa()({styles:e.styles},r))),pe.a.createElement(rd,null,pe.a.createElement(os,Qa()({},s.ActionBox,l,{showEvaluation:f})))),pe.a.createElement(od,null,pe.a.createElement(wl,Qa()({userInfo:{avatar:c.avatar,name:c.name},showAvatar:"big"===p,custom:u,bgColor:e.styles.panel.profileBgColor},e.support)))))}var ld=d.d.div.withConfig({displayName:"action-box-mobile__Container",componentId:"erl9tf-0"})(["height:100%;width:100%;border-top:1px solid #ededed;position:relative;box-sizing:border-box;"]),sd=d.d.div.withConfig({displayName:"action-box-mobile__FinishTip",componentId:"erl9tf-1"})(["width:100%;height:100%;position:absolute;z-index:2;left:0;right:0;top:0;bottom:0;text-align:center;background:#fff;display:table;span{display:table-cell;vertical-align:middle;word-break:break-word;padding:0 20px;}"]),dd=d.d.div.withConfig({displayName:"action-box-mobile__TooltipWrap",componentId:"erl9tf-2"})(["width:100%;height:100%;padding-right:40px;box-sizing:border-box;position:relative;"]),ud=d.d.div.withConfig({displayName:"action-box-mobile__ButtonWrap",componentId:"erl9tf-3"})(["display:inline-block;height:40px;width:40px;line-height:40px;text-align:center;position:absolute;right:0;top:0;bottom:0;"]),pd=d.d.div.withConfig({displayName:"action-box-mobile__TextareaWrap",componentId:"erl9tf-4"})(["width:100%;height:100%;"]),md=d.d.div.withConfig({displayName:"action-box-mobile__EmojiPanelWrap",componentId:"erl9tf-5"})(["position:absolute;top:-","px;background:#fff;border-top:1px solid #ddd;z-index:2;left:1px;right:1px;box-sizing:border-box;visibility:",";"],function(e){return e.emojiHeight+2},function(e){return e.visible?"visible":"hidden"}),fd=d.d.a.withConfig({displayName:"action-box-mobile__Link",componentId:"erl9tf-6"})(["color:#4ca0ff;padding:0 5px;cursor:pointer;"]),hd=Object(o.b)(function(e){return{socket:e.getIn(["config","socket"])}},function(e){return{dispatch:e}})(function(e){function n(e){C(e),e?Ul("set",e):Ul("remove")}function t(e){var t=e?e.trim():I.trim();t&&!p&&(a||za("服务连接中，请稍候…",3e3),Rl(t),n(""),_n.remove(),N({start:0,end:0}))}var a=e.socket,o=e.themeColor,i=e.finish,r=e.showEvaluation,c=e.showEva,l=e.sendImage,s=e.fileEnabled,d=e.uploadFile,u=e.checkSocket,p=e.blacklist,m=e.newConversation,f=e.toMessageBoard,h=Object(ue.useState)(0),g=ra()(h,2),b=g[0],v=g[1],_=Object(ue.useState)(!1),w=ra()(_,2),y=w[0],x=w[1],k=Object(ue.useState)(""),E=ra()(k,2),I=E[0],C=E[1],T=Object(ue.useState)({start:0,end:0}),S=ra()(T,2),j=S[0],N=S[1],O=Object(ue.useRef)(null),M=Object(ue.useRef)(null),D=Object(me.c)(),z=ra()(D,1)[0],B=Object(ue.useCallback)(function(){return x(!y)},[x,y]);return Object(ue.useEffect)(function(){v(O.current.offsetHeight)},[]),pe.a.createElement(ld,null,pe.a.createElement(Sl,{height:50,clickImage:u,clickFile:u,sendImage:l,uploadFile:d,showEva:c,showFile:s,toggleEmojiPanel:B,showEvaluation:r},pe.a.createElement(dd,null,pe.a.createElement(pd,null,pe.a.createElement(Xl,{lineHeight:"20px",sendMsg:t,setPos:N,setContent:n,content:I,inputRef:M})),pe.a.createElement(ud,null,pe.a.createElement(el,{fontColor:o,fontSize:"14px",handleClick:function(){return t()}},pe.a.createElement("span",null,z("发送")))))),pe.a.createElement(md,{emojiHeight:b,visible:y},pe.a.createElement(ql,{ref:O,handleClick:function(e){var t=e.length+2;x(!1),n("".concat(I.slice(0,j.start),":").concat(e,":").concat(I.slice(j.end))),N({start:j.start+t,end:j.start+t}),M.current.focus(),setTimeout(function(){var e=M.current.value;M.current.selectionStart=j.start+t,M.current.selectionEnd=j.start+t,2048<e.length&&(n(e.substr(0,2048)),Ul("set",I),za("最多只能发送 2048 个字符哦",3e3))},0)}})),i?pe.a.createElement(sd,null,pe.a.createElement("span",null,pe.a.createElement(me.a,null,"对话已结束，您可以",pe.a.createElement(fd,{onClick:m},"开始新的对话"),"或",pe.a.createElement(fd,{onClick:f},"留言")))):null,p?pe.a.createElement(sd,null,pe.a.createElement("span",null,z("抱歉，客服系统暂时无法使用"))):null)}),gd=d.d.div.withConfig({displayName:"chat-mobile-half__Container",componentId:"sc-1uz9xds-0"})(["height:100%;width:100%;position:relative;background:#fcfcfc;"]),bd=d.d.div.withConfig({displayName:"chat-mobile-half__EvaPanel",componentId:"sc-1uz9xds-1"})(["position:absolute;z-index:100;left:0;right:0;bottom:0;top:0;"]),vd=Object(d.d)(gd).withConfig({displayName:"chat-mobile-half__MainContainer",componentId:"sc-1uz9xds-2"})(["box-sizing:border-box;overflow:hidden;padding-top:60px;"]),_d=d.d.div.withConfig({displayName:"chat-mobile-half__TitleWrap",componentId:"sc-1uz9xds-3"})(["position:absolute;top:0;width:100%;"]),wd=d.d.div.withConfig({displayName:"chat-mobile-half__MsgWindowWrap",componentId:"sc-1uz9xds-4"})(["width:100%;height:100%;box-sizing:border-box;padding-bottom:","px;"],function(e){var t=e.inputting?30:0;return(e.styles.brand?80:50)+t}),yd=d.d.div.withConfig({displayName:"chat-mobile-half__BottomWrap",componentId:"sc-1uz9xds-5"})(["width:100%;position:absolute;left:0;right:0;bottom:",";"],function(e){return e.inputting?"30px":0}),xd=d.d.div.withConfig({displayName:"chat-mobile-half__InputWrap",componentId:"sc-1uz9xds-6"})(["width:100%;height:50px;background:#fcfcfc;"]),kd=d.d.div.withConfig({displayName:"chat-mobile-half__Support",componentId:"sc-1uz9xds-7"})(["width:100%;height:30px;"]);function Ed(e){var t=e.inputting,n=e.titleBar,a=e.evaluation,o=a.enable,i=a.promptText,r=a.setEvaluation,c=e.msgWindow,l=e.agentInfo,s=e.actionTooltip,d=xs(e.styles.panel,["TitleBar","ActionBox","Evaluation"]),u=Object(ue.useCallback)(function(){r(!1)},[r]),p=Object(ue.useCallback)(function(){r(!0)},[r]),m=l.cellphone||l.tel;return pe.a.createElement(vd,null,pe.a.createElement(_d,null,pe.a.createElement(cl,Qa()({},d.TitleBar,n,{name:l.name,tel:m,signature:l.signature}))),pe.a.createElement(gd,null,o?pe.a.createElement(bd,null,pe.a.createElement(_s,Qa()({},d.Evaluation,{position:"top",width:"auto",promptText:i,closeEvaluation:u}))):null,pe.a.createElement(wd,{styles:e.styles,inputting:t},pe.a.createElement(Nc,Qa()({styles:e.styles},c))),pe.a.createElement(yd,{inputting:t},pe.a.createElement(xd,null,pe.a.createElement(hd,Qa()({},s,d.ActionBox,{showEvaluation:p}))),e.styles.brand?pe.a.createElement(kd,null,pe.a.createElement(hl,{link:e.support.supportLink})):null)))}var Id=d.d.div.withConfig({displayName:"chat-mobile-full__Container",componentId:"vt8krw-0"})(["height:100%;width:100%;position:relative;background:#fcfcfc;"]),Cd=d.d.div.withConfig({displayName:"chat-mobile-full__EvaPanel",componentId:"vt8krw-1"})(["position:absolute;z-index:100;left:0;right:0;bottom:0;top:0;"]),Td=Object(d.d)(Id).withConfig({displayName:"chat-mobile-full__MainContainer",componentId:"vt8krw-2"})(["box-sizing:border-box;overflow:hidden;padding-top:60px;"]),Sd=d.d.div.withConfig({displayName:"chat-mobile-full__TitleWrap",componentId:"vt8krw-3"})(["position:absolute;top:0;width:100%;"]),jd=d.d.div.withConfig({displayName:"chat-mobile-full__MsgWindowWrap",componentId:"vt8krw-4"})(["width:100%;height:100%;box-sizing:border-box;padding-bottom:","px;"],function(e){var t=e.inputting?30:0;return(e.styles.brand?80:50)+t}),Nd=d.d.div.withConfig({displayName:"chat-mobile-full__BottomWrap",componentId:"vt8krw-5"})(["width:100%;position:absolute;left:0;right:0;bottom:",";"],function(e){return e.inputting?"30px":0}),Od=d.d.div.withConfig({displayName:"chat-mobile-full__InputWrap",componentId:"vt8krw-6"})(["width:100%;height:50px;background:#fcfcfc;"]),Md=d.d.div.withConfig({displayName:"chat-mobile-full__Support",componentId:"vt8krw-7"})(["width:100%;height:30px;"]);function Dd(e){var t=e.inputting,n=e.titleBar,a=e.evaluation,o=a.enable,i=a.promptText,r=a.setEvaluation,c=e.msgWindow,l=e.agentInfo,s=e.actionTooltip,d=xs(e.styles.panel,["TitleBar","ActionBox","Evaluation"]),u=Object(ue.useCallback)(function(){r(!1)},[r]),p=Object(ue.useCallback)(function(){r(!0)},[r]),m=l.cellphone||l.tel;return pe.a.createElement(Td,null,pe.a.createElement(Sd,null,pe.a.createElement(cl,Qa()({},d.TitleBar,n,{name:l.name,tel:m,signature:l.signature}))),pe.a.createElement(Id,null,o?pe.a.createElement(Cd,null,pe.a.createElement(_s,Qa()({},d.Evaluation,{position:"top",width:"auto",promptText:i,closeEvaluation:u}))):null,pe.a.createElement(jd,{styles:e.styles,inputting:t},pe.a.createElement(Nc,Qa()({styles:e.styles},c))),pe.a.createElement(Nd,{inputting:t},pe.a.createElement(Od,null,pe.a.createElement(hd,Qa()({},s,d.ActionBox,{showEvaluation:p}))),e.styles.brand?pe.a.createElement(Md,null,pe.a.createElement(hl,{link:e.support.supportLink})):null)))}function zd(e){switch(e){case"desktop.standard":return 240;case"desktop.mini":case"desktop.edge":return 150;case"desktop.custom":return 240;default:return 200}}var Bd=function(t,n,e){return function(e,t,n,a,o){var i=3<arguments.length&&void 0!==a?a:"client_card",r=4<arguments.length?o:void 0;return fe({url:"/client/".concat(t,"/reply_card"),method:"post",data:{visit_id:e,conv_id:n,card_type:i,attrs:r}})}(e.visitId,e.trackId,e.convId,e.cardType,e.data).then(function(e){e.data.success&&n(lt(t))})};var Pd=Object(d.e)(Object(o.b)(function(e){return{convId:e.getIn(["message","convId"]),queue:e.getIn(["message","queue"]),scheduling:e.getIn(["message","scheduling"]),noMsgFilter:e.getIn(["message","noMsgFilter"]),enterpriseInfo:e.getIn(["message","enterpriseInfo"]),agentInfo:e.getIn(["message","agentInfo"]),agentInputing:e.getIn(["message","agentInputing"]),inputting:e.getIn(["message","inputting"]),blacklist:e.getIn(["message","blacklist"]),chatHasEnd:e.getIn(["message","chatHasEnd"]),evaluationActive:e.getIn(["message","evaluationActive"]),ringEnabled:e.getIn(["message","ringEnabled"]),fileEnabled:e.getIn(["message","fileEnabled"]),chatEndStatus:"open"===e.getIn(["message","enterpriseInfo","prompt_status"]),entId:e.getIn(["config","entId"]),visitId:e.getIn(["config","visitId"]),trackId:e.getIn(["config","trackId"]),socket:e.getIn(["config","socket"]),standalone:e.getIn(["config","standalone"]),disableBrandLink:e.getIn(["config","disableBrandLink"]),showSwitch:e.getIn(["robot","show_switch"]),custom:e.get("theme"),evaConfig:e.get("evaluation")}},function(e){return{dispatch:e}})(function(a){var o=a.convId,e=a.queue,t=a.scheduling,n=a.noMsgFilter,i=a.enterpriseInfo,r=a.agentInfo,c=a.agentInputing,l=a.inputting,s=a.blacklist,d=a.chatHasEnd,u=a.evaluationActive,p=a.ringEnabled,m=a.fileEnabled,f=a.chatEndStatus,h=a.entId,g=a.visitId,b=a.trackId,v=a.socket,_=a.standalone,w=a.disableBrandLink,y=a.showSwitch,x=a.theme,k=a.custom,E=_?a.custom.getIn(["standalone","desktop"]):a.custom.getIn(["desktop","panel"]),I=Object(ue.useMemo)(function(){return Object(L.mergeDeep)({},x,Vc(k,_))},[x,k,_]),C=Object(ue.useMemo)(function(){return e},[e]),T=Object(ue.useState)({}),S=ra()(T,2),j=S[0],N=S[1],O=Object(me.c)(),M=ra()(O,1)[0],D=Object(ue.useCallback)(function(e,t,n){return Bd(e,a.dispatch,{convId:o,visitId:g,trackId:b,cardType:t,data:n})},[o,a.dispatch,b,g]),z=Object(ue.useCallback)(function(e){Rl(e)},[]),B=Object(ue.useCallback)(function(e){!function(e){fe({url:"/client/file_downloaded",method:"POST",headers:{"content-type":"application/json"},data:e})}({ent_id:h,track_id:b,conversation_id:o,msg_id:e})},[o,h,b]),P=c?"".concat(M("对方输入消息中...")):"",A=_?"close"===k.getIn(["standalone","removeBrand"]):"close"===k.get("removeBrand"),q={standalone:_,styles:I,inputting:l,support:{showSupport:"overseas"!==i.location&&A,supportLink:w?"javascript:void(0);":"".concat("http://static.meiqia.com/dist/standalone.html?eid=89239&utm_source=widget-badge&utm_term=").concat(h)},evaluation:{enable:!1,setEvaluation:function(e){a.dispatch(it({evaluationActive:e}))},promptText:a.evaConfig.get("prompt_text")},agentInfo:n?{name:i.public_nickname,avatar:i.avatar||Xn.a,signature:i.public_signature,tel:i.public_telephone,cellphone:i.public_cellphone,email:i.public_email,qq:i.public_qq,weixin:i.public_weixin}:{},actionTooltip:{fileEnabled:m,checkSocket:function(e){v||(e.preventDefault(),za(M("服务连接中，请稍候…"),5e3))},sendImage:function(e){e.target.value&&function(e){var t=e.target.value.split(".");if(t=t[t.length-1].toLowerCase(),["png","jpg","jpeg","gif"].includes(t)){var n={id:Math.random(),from_type:"client",content_type:"photo",status:"sending",media_url:bc.a,file:e.target.files[0]};e.target.value="",oc(n)}else za("".concat(R.a.t("只能发送图片哦"),"（png/jpg/jpeg/gif）"),5e3)}(e)},uploadFile:function(e){e.target.value&&nc(e)},newConversation:function(){a.dispatch(bt("newConv")),Qn()},toMessageBoard:function(){a.dispatch(Yt({showTicket:!0}))}},msgWindow:{msgs:[],handleRedirect:xa,handleImgOnload:jn,handleRedirectTicket:function(){a.dispatch(Yt({showTicket:!0}))},scrollToBottom:Tn,handleImagePreview:$c,handleMenuClick:z,handleCardSubmit:D,handleFileDownload:B,cardSize:zd(a.type)},titleBar:{connecting:t,showBack:X.isMobile()&&!!_,showSwitch:y,ringEnabled:p,closeEnabled:!_,closeText:X.isMobile()?M("关闭"):null,handleClose:function(){yt(!1)},handleRing:function(e){a.dispatch(ft(!!e)),Ze("set","MEIQIA_RING",e?"TRUE":"FALSE")},handleRedirect:xa}};return Object(ue.useEffect)(function(){var e={evaluation:{enable:u},msgWindow:{msgs:C},actionTooltip:{blacklist:s,finish:d&&f,showEva:!r.isBot},titleBar:{showSwitch:y&&(!r||r.isBot)}};r.name&&(e.agentInfo={name:"".concat(P||r.name),avatar:r.avatar,signature:r.signature,artificial:r.isBot,tel:r.tel,cellphone:r.cellphone,email:r.email,qq:r.qq,weixin:r.weixin}),N(e)},[u,C,r,P,s,d,f,y]),function(e){var t=Object(L.mergeDeep)({},q,j);switch(e){case"desktop.standard":return pe.a.createElement(Ms,t);case"desktop.mini":return pe.a.createElement(Us,t);case"desktop.edge":return pe.a.createElement(Ks,t);case"desktop.custom":return pe.a.createElement(cd,Qa()({panel:E},t));case"mobile.full":return pe.a.createElement(Dd,t);case"mobile.half":return pe.a.createElement(Ed,t);default:return pe.a.createElement(Ms,t)}}(a.type)})),Ad=d.d.div.withConfig({displayName:"captcha__Container",componentId:"sc-1vo1t5l-0"})(["width:",";height:",";"],function(e){return e.width},function(e){return e.height}),qd=d.d.img.withConfig({displayName:"captcha__Img",componentId:"sc-1vo1t5l-1"})(["display:inline-block;width:100%;height:100%;"]);function Rd(e){var t=e.imgUrl,n=e.className,a=e.handleClick,o=po()(e,["imgUrl","className","handleClick"]);return pe.a.createElement(Ad,Qa()({},o,{className:n,onClick:a}),pe.a.createElement(qd,{src:t}))}function Ld(){return fe({url:"/captchas?v=".concat(ce()()),method:"post"}).then(function(e){return e},function(){za("获取验证码失败",3e3)})}function Ud(e){var t=e.handleToken,n=e.refreshToken,a=po()(e,["handleToken","refreshToken"]),o=Object(ue.useState)(""),i=ra()(o,2),r=i[0],c=i[1],l=Object(ue.useCallback)(function(){Ld().then(function(e){c(S.defaults+e.data.captcha_image_url),t&&t(e.data.captcha_token)})},[t]);return Object(ue.useEffect)(function(){Ld().then(function(e){c(S.defaults+e.data.captcha_image_url),t&&t(e.data.captcha_token)})},[t,n]),pe.a.createElement(Rd,Qa()({width:"80px",height:"40px"},a,{imgUrl:r,handleClick:l}))}var Fd=n(467),Wd=n.n(Fd),Gd=function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},Vd=function(e){return!(Wd()(+e)||e.length<6)},Hd=function(e){return/^\d+$/.test(e)},Qd=function(e){return/^(0[1-9]\d[1-9]\d{7}|0[1-9]\d{2}[1-9]\d{6,7}|1\d{10})$/.test(e)},Yd=d.d.div.withConfig({displayName:"callback__Container",componentId:"sc-10w0clj-0"})(["width:100%;height:100%;box-sizing:border-box;position:relative;background:#fff;overflow-y:auto;padding:0 20px;"]),$d=Object(d.d)(Yd).withConfig({displayName:"callback__MainContainer",componentId:"sc-10w0clj-1"})(["overflow:hidden;padding:0;padding-top:60px;"]),Jd=d.d.div.withConfig({displayName:"callback__TitleWrap",componentId:"sc-10w0clj-2"})(["position:absolute;top:0;left:0;right:0;width:100%;"]),Kd=d.d.p.withConfig({displayName:"callback__P",componentId:"sc-10w0clj-3"})(["margin:30px 0 10px;font-size:13px;color:#555;text-align:center;"]),Zd=d.d.div.withConfig({displayName:"callback__InputWrap",componentId:"sc-10w0clj-4"})(["margin:24px 0;border-bottom:1px solid #555;input{width:100%;height:auto;padding:12px;border:0;color:#000;background-color:#fff;font-size:14px;letter-spacing:16px;}input::placeholder{letter-spacing:normal;}"]),Xd=Object(d.d)(Zd).withConfig({displayName:"callback__CaptchaWrap",componentId:"sc-10w0clj-5"})(["box-sizing:border-box;padding-right:70px;position:relative;"]),eu=d.d.div.withConfig({displayName:"callback__CaptchaBox",componentId:"sc-10w0clj-6"})(["width:70px;height:100%;position:absolute;right:0;top:0;bottom:0;"]),tu=d.d.div.withConfig({displayName:"callback__Btn",componentId:"sc-10w0clj-7"})(["margin-top:20px;text-align:center;a{width:60px;height:60px;display:inline-block;border-radius:30px;position:relative;background:#c8c8c8;cursor:pointer;&.active{background:",";}}.text{margin-top:16px;font-size:13px;color:#007aff;}"],function(e){return e.themeColor}),nu=Object(d.d)(tu).withConfig({displayName:"callback__SuccessBtn",componentId:"sc-10w0clj-8"})(["margin-top:100px;a{background:",";margin-bottom:20px;cursor:default;}label{cursor:default;}p{margin:0 0 8px;text-align:center;font-size:12px;color:#999;}"],function(e){return e.themeColor}),au=Object(d.d)(Io).withConfig({displayName:"callback__Icon",componentId:"sc-10w0clj-9"})(["position:absolute;top:50%;left:50%;cursor:pointer;margin:-10px 0 0 -10px;"]);var ou=Object(d.e)(Object(o.b)(function(e){return{customTheme:e.get("theme"),config:e.get("config"),ticket:e.get("ticket")}},function(e){return{dispatch:e}})(function(e){var t=Vc(e.customTheme,e.config.get("standalone")),n=t&&t.panel||e.customTheme,a=Object(ue.useState)(""),o=ra()(a,2),i=o[0],r=o[1],c=Object(ue.useState)("open"===e.ticket.get("captcha")),l=ra()(c,2),s=l[0],d=(l[1],Object(ue.useState)("")),u=ra()(d,2),p=u[0],m=u[1],f=Object(ue.useState)(""),h=ra()(f,2),g=(h[0],h[1]),b=Object(ue.useState)(!1),v=ra()(b,2),_=v[0],w=v[1],y=Object(ue.useState)(!1),x=ra()(y,2),k=x[0],E=(x[1],Object(me.c)()),I=ra()(E,1)[0],C={name:I("免费通话"),fontColor:n.fontColor,themeColor:n.themeColor,closeEnabled:!e.config.get("standalone"),handleClose:function(){yt(!1)}};return Object(ue.useEffect)(function(){var e=!0;(!Qd(i)||s&&p)&&(e=!1),w(!!e)},[i,s,p]),pe.a.createElement($d,null,pe.a.createElement(Jd,null,pe.a.createElement(cl,C)),k?pe.a.createElement(Yd,null,pe.a.createElement(nu,{themeColor:n.themeColor},pe.a.createElement("a",{href:"javascript:void(0);"},pe.a.createElement(au,{type:"call",width:"20px",height:"20px"})),pe.a.createElement("p",null,I("请保持电话畅通，客服人员即将致电")),pe.a.createElement("p",null,I("你将接到「010-52729285」的来电")))):pe.a.createElement(Yd,null,pe.a.createElement(Kd,null,I("欢迎使用完全免费的网页回呼与我们通话")),pe.a.createElement(Zd,null,pe.a.createElement("input",{type:"tel",value:i,placeholder:I("请输入你的电话号码"),onChange:function(e){return r(e.target.value)}})),s?pe.a.createElement(Xd,null,pe.a.createElement("input",{type:"text",value:p,placeholder:I("验证码"),onChange:function(e){return m(e.target.value)}}),pe.a.createElement(eu,null,pe.a.createElement(Ud,{width:"80px",height:"40px",refreshToken:s,handleToken:g}))):null,pe.a.createElement(tu,{themeColor:n.themeColor},pe.a.createElement("a",{href:"javascript:void(0);",className:_?"active":"",onClick:function(){}},pe.a.createElement(au,{type:"call",width:"20px",height:"20px"})),pe.a.createElement("div",{className:"text"},I("开始免费通话")))))})),iu=d.d.div.withConfig({displayName:"category__Container",componentId:"qhan5i-0"})(["width:100%;height:100%;overflow-y:auto;"]),ru=d.d.div.withConfig({displayName:"category__Title",componentId:"qhan5i-1"})(["padding:16px;font-size:12px;color:#666;word-break:break-all;"]),cu=d.d.ul.withConfig({displayName:"category__List",componentId:"qhan5i-2"})(["list-style:none;background:#fff;li{padding:14px;margin:0;box-shadow:0 -1px 0 0 rgba(0,0,0,0.04);}"]);function lu(e){var t=e.title,n=e.assignments,a=e.handleCategory;return pe.a.createElement(iu,null,pe.a.createElement(ru,null,t),pe.a.createElement(cu,null,n.map(function(e,t){return pe.a.createElement("li",{key:e.target+t},pe.a.createElement(el,{fontColor:"#6088e6",data:e,handleClick:a},pe.a.createElement("span",null,e.description)))})))}function su(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function du(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?su(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):su(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}var uu=d.d.div.withConfig({displayName:"user-form__Container",componentId:"sc-163y00h-0"})(["width:100%;height:100%;overflow-y:auto;"]),pu=d.d.div.withConfig({displayName:"user-form__Title",componentId:"sc-163y00h-1"})(["padding:16px;font-size:12px;color:#666;word-break:break-all;"]),mu=d.d.ul.withConfig({displayName:"user-form__List",componentId:"sc-163y00h-2"})(["list-style:none;li{margin-bottom:16px;}.name{padding:0 0 6px 16px;color:#444;font-size:12px;span{padding:0 3px;color:#ff5c5e;}}"]),fu=d.d.input.withConfig({displayName:"user-form__Input",componentId:"sc-163y00h-3"})(["width:100%;height:auto;padding:12px;border:none;"]),hu=d.d.div.withConfig({displayName:"user-form__CaptchaWrap",componentId:"sc-163y00h-4"})(["width:100%;padding-right:80px;margin-bottom:16px;box-sizing:border-box;position:relative;"]),gu=Object(d.d)(Ud).withConfig({displayName:"user-form__CaptchaImg",componentId:"sc-163y00h-5"})(["position:absolute;right:0;top:0;bottom:0;"]),bu=d.d.div.withConfig({displayName:"user-form__BtnWrap",componentId:"sc-163y00h-6"})(["padding:0 20px 20px;"]),vu=d.d.label.withConfig({displayName:"user-form__InputItem",componentId:"sc-163y00h-7"})(["display:block;box-sizing:border-box;width:100%;height:auto;padding:12px;background:#fff;box-shadow:0 -1px 0 0 rgba(0,0,0,0.04);cursor:pointer;input{margin-right:10px;}"]);function _u(e){function n(e){var t=e.target,n=t.type,a=t.checked,o=t.name,i=t.value,r=du({},p);if("radio"===n&&a)r[o]=i;else if("checkbox"===n)if(r[o]=r[o]||[],a)r[o].push(i);else{var c=r[o].findIndex(function(e){return e===i});r[o].splice(c,1)}m(r)}var t=e.title,a=e.captcha,o=e.fields,i=e.handleUserForm,r=e.fontColor,c=e.bgColor,l=Object(me.c)(),s=ra()(l,1)[0],d=Object(ue.useState)({}),u=ra()(d,2),p=u[0],m=u[1],f=Object(ue.useState)(""),h=ra()(f,2),g=h[0],b=h[1],v=Object(ue.useState)(""),_=ra()(v,2),w=_[0],y=_[1],x=Object(ue.useCallback)(function(){return i(p,{captchaToken:g,captchaValue:w})},[i,p,g,w]);function k(t){switch(t.type){case"text":return pe.a.createElement(fu,{type:"text",placeholder:s("请输入"),name:t.field_name,onBlur:ge.wxScroll,onChange:function(e){return function(e,t){var n=du({},p);n[e]=t,m(n)}(t.field_name,e.target.value)}});case"single_choice":return pe.a.createElement("div",null,t.choices.map(function(e){return pe.a.createElement(vu,{key:e},pe.a.createElement("input",{type:"radio",name:t.field_name,value:e,onChange:n}),e)}));case"multiple_choice":return pe.a.createElement("div",null,t.choices.map(function(e){return pe.a.createElement(vu,{key:e},pe.a.createElement("input",{type:"checkbox",name:t.field_name,value:e,onChange:n}),e)}));default:return pe.a.createElement("div",null)}}return pe.a.createElement(uu,null,pe.a.createElement(pu,null,t),pe.a.createElement(mu,null,o.map(function(e){return pe.a.createElement("li",{key:e.field_name},pe.a.createElement("div",{className:"name"},e.display_name,!e.optional&&pe.a.createElement("span",null,"*")),k(e))}),a?pe.a.createElement("li",{key:"captcha"},pe.a.createElement("div",{className:"name"},s("验证码"),pe.a.createElement("span",null,"*")),pe.a.createElement(hu,null,pe.a.createElement(fu,{type:"text",name:"captcha",autoComplete:"false",value:w||"",onBlur:ge.wxScroll,onChange:function(e){return y(e.target.value)}}),pe.a.createElement(gu,{width:"80px",height:"40px",refreshToken:a,handleToken:b}))):null),pe.a.createElement(bu,null,pe.a.createElement(is,{height:"40px",bgColor:c,fontColor:r,handleClick:x},pe.a.createElement("span",null,s("提交")))))}var wu=d.d.div.withConfig({displayName:"pre-form__Container",componentId:"sc-1abxvm2-0"})(["width:100%;height:100%;box-sizing:border-box;position:relative;background:#f2f3f5;"]),yu=Object(d.d)(wu).withConfig({displayName:"pre-form__MainContainer",componentId:"sc-1abxvm2-1"})(["overflow:hidden;padding-top:60px;"]),xu=d.d.div.withConfig({displayName:"pre-form__TitleWrap",componentId:"sc-1abxvm2-2"})(["position:absolute;top:0;width:100%;"]);var ku=Object(d.e)(Object(o.b)(function(e){return{customTheme:e.get("theme"),config:e.get("config"),captchaStatus:e.getIn(["survey","form","form_def","captcha"]),formDef:e.getIn(["survey","form","form_def"]),categoryEnabled:e.getIn(["survey","categoryEnabled"]),userFormEnabled:e.getIn(["survey","userFormEnabled"])}},function(e){return{dispatch:e}})(function(e){var l=e.config,t=e.theme,n=e.customTheme,a=e.captchaStatus,o=e.formDef,i=e.categoryEnabled,r=e.userFormEnabled,c=e.dispatch,s=Object(L.merge)({},t,Vc(n,l.get("standalone"))),d=Object(me.c)(),u=ra()(d,1)[0],p=u("询前表单"),m={assignments:[]},f={fields:[]};i||r||c(Jt({showSurvey:!1}));var h=Object(ue.useState)(a),g=ra()(h,2),b=g[0],v=g[1],_=Object(ue.useState)(i?"category":"user"),w=ra()(_,2),y=w[0],x=w[1];o&&(m=o.get("menus").toJS(),(f=o.get("inputs").toJS()).fields=f.fields.filter(function(e){return!e.ignore}));var k={name:p,showBack:X.isMobile()&&!!l.get("standalone"),fontColor:s.panel.fontColor,themeColor:s.panel.themeColor,closeEnabled:!l.get("standalone"),closeText:X.isMobile()?u("关闭"):null,handleClose:function(){yt(!1)}};return Object(ue.useEffect)(function(){Ke.updatePosition()},[]),pe.a.createElement(yu,null,pe.a.createElement(xu,null,pe.a.createElement(cl,k)),pe.a.createElement(wu,null,"category"===y?pe.a.createElement(lu,Qa()({},m,{handleCategory:function(e){var t={},n={};"agent"===e.target_kind?t.agentToken=e.target:"group"===e.target_kind&&(t.groupToken=e.target,t.agentToken=null),n.surveyMsg={id:1*new Date,content_type:"text",content:e.description},sn(t),c(it(n)),r?x("user"):c(Jt({showSurvey:!1}))}})):pe.a.createElement(_u,Qa()({},f,{captcha:b,fontColor:s.panel.fontColor,bgColor:s.panel.themeColor,handleUserForm:function(e,t){!function(e){for(var t=0,n=f.fields.length;t<n;t+=1){var a=f.fields[t];if(!a.ignore){var o=a.field_name,i=a.display_name,r=e[o],c="";switch(c="en"===l.get("language")?o:i,a.type){case"text":if(r){if(0===r.length||100<r.length)return za("".concat(u("请控制"),"「").concat(c,"」").concat(u("在1到100个字符")),3e3),!1}else if(!a.optional)return za("".concat(u("请填写必填字段"),"「").concat(c,"」"),3e3),!1;break;case"single_choice":case"multiple_choice":if(!(a.optional||r&&0!==r.length))return za("".concat(u("请选择"),"「").concat(c,"」"),3e3),!1}}}return!0}(e)||(!a||t.captchaValue?function(e,t){return fe({url:"/client/forms",method:"post",headers:Le()({"content-type":"application/json"},t),data:e})}({ent_id:l.get("entId"),track_id:l.get("trackId"),data:e},{"Captcha-Value":t.captchaValue,"Captcha-Token":t.captchaToken}).then(function(e){$.a.set("MEIQIA_HAS_SUBMITTED_FORM","TRUE",{expires:1/0}),c(Jt({showSurvey:!1}))},function(t){var e={};try{e=t.response.data||{}}catch(e){console.log(t)}za(e.message||u("提交失败，请稍候再试"),3e3),e.captcha_needed&&v(Math.random())}):za(u("请输入验证码"),3e3))}}))))})),Eu=d.d.input.withConfig({displayName:"user-input__Input",componentId:"sc-18asqqn-0"})(["width:100%;height:auto;padding:12px;border:none;"]),Iu=d.d.li.withConfig({displayName:"user-input__Li",componentId:"sc-18asqqn-1"})(["margin-bottom:16px;.name{padding:0 0 6px 16px;color:#444;font-size:12px;span{padding:0 3px;color:#ff5c5e;}}"]);function Cu(e){var t=e.title,n=e.field,a=e.value,o=e.handler,i=e.rule,r=Object(me.c)(),c=ra()(r,1)[0];return pe.a.createElement(Iu,null,pe.a.createElement("div",{className:"name"},t,"multi"===i?pe.a.createElement("span",null,"*"):null),pe.a.createElement(Eu,{type:"text",placeholder:c("请输入"),name:n,value:a,onBlur:ge.wxScroll,onChange:function(e){return o(e.target.value)}}))}var Tu=d.d.div.withConfig({displayName:"category__Container",componentId:"sc-1qze3l4-0"})(["width:100%;"]),Su=d.d.label.withConfig({displayName:"category__InputItem",componentId:"sc-1qze3l4-1"})(["display:block;box-sizing:border-box;width:100%;height:auto;padding:12px;background:#fff;box-shadow:0 -1px 0 0 rgba(0,0,0,0.04);cursor:pointer;input{margin-right:10px;}"]);function ju(e){var t=e.category,n=e.handleChange;return pe.a.createElement(Tu,null,e.list.map(function(e){return pe.a.createElement(Su,{key:e.id},pe.a.createElement("input",{type:"radio",name:"category",value:e.id,checked:t===e.id,onChange:function(){return n(e.id)}}),e.name)}))}var Nu=d.d.div.withConfig({displayName:"message-form__Container",componentId:"we4f09-0"})(["width:100%;height:100%;box-sizing:border-box;position:relative;"]),Ou=d.d.div.withConfig({displayName:"message-form__Title",componentId:"we4f09-1"})(["padding:16px;font-size:12px;color:#666;word-break:break-all;"]),Mu=d.d.ul.withConfig({displayName:"message-form__List",componentId:"we4f09-2"})(["list-style:none;li{margin-bottom:16px;}.name{padding:0 0 6px 16px;color:#444;font-size:12px;span{padding:0 3px;color:#ff5c5e;}}"]),Du=d.d.input.withConfig({displayName:"message-form__Input",componentId:"we4f09-3"})(["width:100%;height:auto;padding:12px;border:none;"]),zu=d.d.textarea.withConfig({displayName:"message-form__Textarea",componentId:"we4f09-4"})(["display:block;width:100%;height:90px;padding:12px 16px;overflow-x:hidden;overflow-y:auto;resize:none;outline:0;background-color:#fff;border:none;word-break:break-all;font-size:12px;-webkit-appearance:none;"]),Bu=d.d.div.withConfig({displayName:"message-form__CaptchaWrap",componentId:"we4f09-5"})(["width:100%;padding-right:80px;margin-bottom:16px;box-sizing:border-box;position:relative;"]),Pu=Object(d.d)(Ud).withConfig({displayName:"message-form__CaptchaImg",componentId:"we4f09-6"})(["position:absolute;right:0;top:0;bottom:0;"]),Au=d.d.div.withConfig({displayName:"message-form__BtnWrap",componentId:"we4f09-7"})(["padding:0 20px 20px;"]);var qu=Object(d.e)(Object(o.b)(function(e){return{config:e.get("config"),customTheme:e.get("theme"),msgData:e.get("message"),ticket:e.get("ticket")}},function(e){return{dispatch:e}})(function(o){var i=o.config,e=o.ticket,r=o.msgData,t=Vc(o.customTheme,i.get("standalone")),n=t&&t.panel||o.customTheme,a="open"===e.get("defaultTemplate")?e.get("defaultTemplateContent"):"",c=e.get("contactRule"),l="open"===e.get("category"),s="open"===e.get("name"),d="open"===e.get("tel"),u="open"===e.get("email"),p="open"===e.get("wechat"),m="open"===e.get("qq"),f="open"===e.get("captcha"),h=Object(me.c)(),g=ra()(h,1)[0],b=Object(ue.useState)([]),v=ra()(b,2),_=v[0],w=v[1],y=Object(ue.useState)(null),x=ra()(y,2),k=x[0],E=x[1],I=Object(ue.useState)(""),C=ra()(I,2),T=C[0],S=C[1],j=Object(ue.useState)(""),N=ra()(j,2),O=N[0],M=N[1],D=Object(ue.useState)(""),z=ra()(D,2),B=z[0],P=z[1],A=Object(ue.useState)(""),q=ra()(A,2),R=q[0],L=q[1],U=Object(ue.useState)(""),F=ra()(U,2),W=F[0],G=F[1],V=Object(ue.useState)(a),H=ra()(V,2),Q=H[0],Y=H[1],$=Object(ue.useState)(f),J=ra()($,2),K=J[0],Z=J[1],X=Object(ue.useState)(""),ee=ra()(X,2),te=ee[0],ne=ee[1],ae=Object(ue.useState)(""),oe=ra()(ae,2),ie=oe[0],re=oe[1],ce=Object(ue.useState)(!1),le=ra()(ce,2),se=le[0],de=le[1];return Object(ue.useEffect)(function(){"open"===e.get("category")&&function(e){return fe({url:"/client/tickets_v2/categories",method:"get",params:{enterprise_id:e}})}(i.get("entId")).then(function(e){w(e.data.categories)})},[i,e]),pe.a.createElement(Nu,null,pe.a.createElement(Ou,null,e.get("intro")),l?pe.a.createElement(Mu,null,pe.a.createElement("li",null,pe.a.createElement("div",{className:"name"},g("分类"),pe.a.createElement("span",null,"*")),pe.a.createElement(ju,{list:_,category:k,handleChange:function(e){return E(e)}}))):null,pe.a.createElement(Mu,null,s?pe.a.createElement(Cu,{title:g("姓名"),field:"name",value:T,handler:S,rule:c}):null,d?pe.a.createElement(Cu,{title:g("手机"),field:"tel",value:O,handler:M,rule:c}):null,u?pe.a.createElement(Cu,{title:g("邮箱"),field:"email",value:B,handler:P,rule:c}):null,p?pe.a.createElement(Cu,{title:g("微信"),field:"wechat",value:R,handler:L,rule:c}):null,m?pe.a.createElement(Cu,{title:g("QQ"),field:"qq",value:W,handler:G,rule:c}):null,pe.a.createElement("li",null,pe.a.createElement("div",{className:"name"},g("留言内容"),pe.a.createElement("span",null,"*")),pe.a.createElement(zu,{placeholder:g("请输入"),name:"content",value:Q,onBlur:ge.wxScroll,onChange:function(e){return Y(e.target.value)}})),f?pe.a.createElement("li",{key:"captcha"},pe.a.createElement("div",{className:"name"},g("验证码"),pe.a.createElement("span",null,"*")),pe.a.createElement(Bu,null,pe.a.createElement(Du,{type:"text",name:"captcha",value:ie,onBlur:ge.wxScroll,onChange:function(e){return re(e.target.value)}}),pe.a.createElement(Pu,{width:"80px",height:"40px",refreshToken:K,handleToken:ne}))):null),pe.a.createElement(Au,null,pe.a.createElement(is,{height:"40px",bgColor:n.themeColor,fontColor:n.fontColor,handleClick:function(){var e={},t={enterprise_id:i.get("entId"),track_id:i.get("trackId"),visit_id:i.get("visitId"),channel:"widget"};if(l&&0<_.length){if(!k)return za(g("请选择分类"),2e3),!1;t.category_id=k}if(s&&T){if(!(T.length<=50))return za(g("请正确填写姓名"),2e3),!1;e.name=T}if(d&&O){if(!Vd(O))return za(g("请正确填写手机号"),2e3),!1;e.tel=O}if(u&&B){if(!Gd(B))return za(g("请正确填写联系邮箱"),2e3),!1;e.email=B}if(p&&R){if(!(R.length<=50))return za(g("请正确填写微信"),2e3),!1;e.weixin=R}if(m&&W){if(!Hd(W))return za(g("请正确填写QQ"),2e3),!1;e.qq=W}if("single"===c){if(!(e.name||e.tel||e.email||e.weixin||e.qq))return za(g("请至少填写一项联系方式"),2e3),!1}else if("multi"===c){if(s&&!e.name)return za(g("请正确填写姓名"),2e3),!1;if(d&&!e.tel)return za(g("请正确填写手机号"),2e3),!1;if(u&&!e.email)return za(g("请正确填写联系邮箱"),2e3),!1;if(p&&!e.weixin)return za(g("请正确填写微信"),2e3),!1;if(m&&!e.qq)return za(g("请正确填写QQ"),2e3),!1}he(i.get("entId"),i.get("trackId"),i.get("visitId"),i.get("browserId"),e);var n=Q.trim();if(n.length<1||1024<n.length)return za(g("请保持留言内容在 1～1024 字符内"),2e3),!1;t.content=Q;var a={"content-type":"application/json"};if(f){if(!ie)return za(g("请输入验证码"),2e3),!1;Le()(a,{"Captcha-Needed":"true","Captcha-Value":ie,"Captcha-Token":te})}return de(!0),se||(t.client_info=e,-1<[75507,42961,72508,16,14986].indexOf(i.get("entId"))&&(t.agent_token=r.get("agentToken")||""),t.reserve_token=r.get("reserveToken"),Tt({data:t,headers:a}).then(function(e){de(!1),o.afterSubmit()},function(e){var t={};try{t=e.response.data||{}}catch(e){console.log(e)}za(t.message||g("留言失败，请稍候再试"),3e3),de(!1),t.captcha_needed&&Z(Math.random())})),null}},pe.a.createElement("span",null,g("提交")))))})),Ru=d.d.div.withConfig({displayName:"message-success__Container",componentId:"sc-1b3erm3-0"})(["width:100%;height:100%;background:#fff;overflow:hidden;"]),Lu=d.d.div.withConfig({displayName:"message-success__BtnWrap",componentId:"sc-1b3erm3-1"})(["width:150px;margin:0 auto;"]),Uu=d.d.h2.withConfig({displayName:"message-success__H2",componentId:"sc-1b3erm3-2"})(["text-align:center;"]),Fu=d.d.p.withConfig({displayName:"message-success__P",componentId:"sc-1b3erm3-3"})(["font-size:14px;margin:20px 0;text-align:center;"]),Wu=Object(d.d)(el).withConfig({displayName:"message-success__AnchorButton",componentId:"sc-1b3erm3-4"})(["text-decoration:underline;"]),Gu=Object(o.b)(null,function(e){return{dispatch:e}})(function(e){var t=e.dispatch,n=Object(me.c)(),a=ra()(n,1)[0],o=Object(ue.useCallback)(function(){t(Yt({showTicket:!1})),yt(!1)},[t]);return pe.a.createElement(Ru,null,pe.a.createElement(Uu,null,a("留言成功")),pe.a.createElement(Fu,null,a("我们会尽快联系你")),pe.a.createElement(Lu,null,pe.a.createElement(is,{bgColor:e.themeColor,fontColor:e.fontColor,handleClick:o},pe.a.createElement("span",null,a("关闭")))),pe.a.createElement(Fu,null,pe.a.createElement(Wu,{handleClick:e.showForm},pe.a.createElement("span",null,a("再次留言")))))}),Vu=d.d.div.withConfig({displayName:"message-board__Container",componentId:"yp1ztc-0"})(["width:100%;height:100%;box-sizing:border-box;position:relative;background:#f2f3f5;overflow-y:auto;"]),Hu=Object(d.d)(Vu).withConfig({displayName:"message-board__MainContainer",componentId:"yp1ztc-1"})(["overflow:hidden;padding-top:60px;"]),Qu=d.d.div.withConfig({displayName:"message-board__TitleWrap",componentId:"yp1ztc-2"})(["position:absolute;top:0;width:100%;"]);function Yu(o,i){clearTimeout(Ju),function(e,t){return fe({url:"/client/queue/position",method:"get",params:{ent_id:e,track_id:t}})}(o,i).then(function(e){var t=e.data,n=ln.getState(),a=ln.dispatch;n.get("message").get("convId")?clearTimeout(Ju):!1===t.in_queue?a(en({inQueue:!1,status:"fail"})):(t.position&&a(en({position:t.position})),Ju=setTimeout(function(){Yu(o,i)},15e3))})}var $u=Object(d.e)(Object(o.b)(function(e){return{standalone:e.getIn(["config","standalone"]),customTheme:e.get("theme")}},function(e){return{dispatch:e}})(function(e){var t=Vc(e.customTheme,e.standalone),n=t&&t.panel||e.customTheme,a=Object(ue.useState)(!0),o=ra()(a,2),i=o[0],r=o[1],c=Object(me.c)(),l=ra()(c,1)[0],s={name:l("给我们留言"),showBack:X.isMobile()&&!!e.standalone,fontColor:n.fontColor,themeColor:n.themeColor,closeEnabled:!e.standalone,closeText:X.isMobile()?l("关闭"):null,handleClose:function(){yt(!1)}},d=Object(ue.useCallback)(function(){return r(!1)},[r]),u=Object(ue.useCallback)(function(){return r(!0)},[r]);return Object(ue.useEffect)(function(){Ke.updatePosition()},[]),pe.a.createElement(Hu,null,pe.a.createElement(Qu,null,pe.a.createElement(cl,s)),pe.a.createElement(Vu,null,i?pe.a.createElement(qu,{afterSubmit:d}):pe.a.createElement(Gu,{themeColor:n.themeColor,fontColor:n.fontColor,showForm:u})))})),Ju=null;function Ku(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}var Zu=d.d.div.withConfig({displayName:"queue__Container",componentId:"q5cskn-0"})(["width:100%;height:100%;box-sizing:border-box;position:relative;"]),Xu=Object(d.d)(Zu).withConfig({displayName:"queue__MainContainer",componentId:"q5cskn-1"})(["overflow:hidden;padding-top:60px;background:#fff;"]),ep=d.d.div.withConfig({displayName:"queue__TitleWrap",componentId:"q5cskn-2"})(["position:absolute;top:0;width:100%;"]),tp=d.d.div.withConfig({displayName:"queue__Intro",componentId:"q5cskn-3"})(["line-height:22px;color:#666;padding:20px 20px 30px;"]),np=d.d.div.withConfig({displayName:"queue__Position",componentId:"q5cskn-4"})(["position:relative;width:100%;height:160px;background-color:#fefefe;box-shadow:inset 0 -1px 0 0 rgba(0,0,0,0.04),inset 0 1px 0 0 rgba(0,0,0,0.04);text-align:center;color:",";@keyframes jump{0%{transform:translateY(0);text-shadow:0 30px 36px;}100%{transform:translateY(-6px);text-shadow:0 40px 40px;}}.text{padding-top:32px;padding-bottom:10px;}.pos{position:absolute;top:48px;left:50%;width:40px;margin-left:-20px;font-size:48px;text-shadow:0 30px 36px;animation:jump 0.3s ease-in-out infinite alternate;}"],function(e){return e.themeColor?e.themeColor:"#000"}),ap=d.d.div.withConfig({displayName:"queue__Message",componentId:"q5cskn-5"})(["color:#666;margin-top:30px;text-align:center;padding:0 26px;.text{padding:20px 0;}a{width:268px;}"]),op=Object(d.e)(Object(o.b)(function(e){return{standalone:e.getIn(["config","standalone"]),entId:e.getIn(["config","entId"]),trackId:e.getIn(["config","trackId"]),customTheme:e.get("theme"),queue:e.get("queue")}},function(e){return{dispatch:e}})(function(e){var t=e.customTheme,n=e.queue,a=e.standalone,o=e.entId,i=e.trackId,r=Object(me.c)(),c=ra()(r,1)[0],l=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ku(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):Ku(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},e.theme),s=Object(L.merge)({},l,Vc(t,a)),d=n.get("intro"),u=n.get("status"),p=n.get("position"),m={name:c("排队等待中..."),showBack:X.isMobile()&&!!a,fontColor:s.panel.fontColor,themeColor:s.panel.themeColor,closeEnabled:!a,closeText:X.isMobile()?c("关闭"):null,handleClose:function(){yt(!1)}};return Object(ue.useEffect)(function(){Ke.updatePosition()},[]),Object(ue.useEffect)(function(){return Yu(o,i),function(){clearTimeout(Ju)}},[o,i]),pe.a.createElement(Xu,null,pe.a.createElement(ep,null,pe.a.createElement(cl,m)),"normal"===u?pe.a.createElement(Zu,null,pe.a.createElement(tp,null,d),pe.a.createElement(np,{themeColor:s.panel.themeColor},pe.a.createElement("div",{className:"text"},c("当前等待人数")),pe.a.createElement("div",{className:"pos"},p)),pe.a.createElement(ap,null,pe.a.createElement("div",{className:"text"},c("如果等不及，可以选择")),pe.a.createElement(is,{height:"35px",bgColor:s.panel.themeColor,fontColor:"#fff",handleClick:function(){e.dispatch(Yt({showTicket:!0}))}},pe.a.createElement("span",null,c("给我们留言"))))):pe.a.createElement(Zu,null,pe.a.createElement(ap,null,c("排队失败，请刷新重试"))))})),ip=function(e,t){var n=Pe().getState(),a=n.get("config"),o=n.getIn(["smartGuide","templateDetail"]).id,i=e.find(function(e){return"tag"===e.type}),r=e.find(function(e){return"agent"===e.type});if(i){var c={template_id:o,ent_id:a.get("entId"),track_id:a.get("trackId")};!function(e){fe({url:"/mpush/client_tags",method:"post",headers:{"content-type":"application/json"},data:e})}(Le()({},c,{tag_ids:function(e){return e.content.tag_ids||[]}(i)}))}r?function(e,n,a){sn({agentToken:e.agent_token,groupToken:e.group_token}),Qn().then(function(e){if(e.data.success)Pe().dispatch(q({buttonActived:"chat"})),It("chatBox"),Kn(n,!1);else if("queueing"===e.data.result){var t=Pe();t.dispatch(Ee({submitData:{nodePath:n,tag:a}})),t.dispatch(q({buttonActived:"chat"})),It("queue")}else Kn(n,!0)},function(e){console.log(e)})}(r.content,t,i):Kn(t,!0)};function rp(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function cp(e){return{id:Yn(8),from_type:"system_msg",content:e}}function lp(e,t,n){return{id:Yn(8),agent:{nickname:e,avatar:t},from_type:"bot",content_type:"hybrid",content:[{type:"client_card",body:n.fields.map(function(e){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rp(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):rp(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}({},e,{displayName:$n[e.name]})})}]}}function sp(e){function t(){r&&(p(!1),l&&l())}var n=e.className,a=e.content,o=e.visible,i=e.closeOnClick,r=void 0===i||i,c=e.timeout,l=e.onClose,s=Object(ue.useState)(!1),d=ra()(s,2),u=d[0],p=d[1];return Object(ue.useEffect)(function(){c&&setTimeout(function(){p(!1),l&&l()},c)},[c,l]),Object(ue.useEffect)(function(){p(o)},[o,a]),u&&a?pe.a.createElement(pe.a.Fragment,null,pe.a.createElement(gp,{onClick:t}),pe.a.createElement(hp,{onClick:t,className:n},a)):null}var dp=d.d.div.withConfig({displayName:"smart-window__Container",componentId:"sc-4s9rs2-0"})(["width:100%;height:100%;box-sizing:border-box;position:relative;background:#f2f3f5;overflow-y:auto;"]),up=Object(d.d)(dp).withConfig({displayName:"smart-window__MainContainer",componentId:"sc-4s9rs2-1"})(["overflow:hidden;padding-top:60px;"]),pp=d.d.div.withConfig({displayName:"smart-window__TitleWrap",componentId:"sc-4s9rs2-2"})(["position:absolute;top:0;width:100%;"]),mp=Object(d.e)(Object(o.b)(function(e){return{standalone:e.getIn(["config","standalone"]),entId:e.getIn(["config","entId"]),visitId:e.getIn(["config","visitId"]),trackId:e.getIn(["config","trackId"]),browserId:e.getIn(["config","browserId"]),customTheme:e.get("theme"),avatar:e.getIn(["smartGuide","templateDetail","avatar"]),agentName:e.getIn(["smartGuide","templateDetail","agentName"]),queue:e.getIn(["smartGuide","queue"])}},function(e){return{dispatch:e}})(function(e){var t=e.type,a=e.entId,o=e.visitId,i=e.trackId,r=e.browserId,n=e.avatar,c=e.agentName,l=e.customTheme,s=e.standalone,d=e.queue,u=e.dispatch,p=e.handleUserOption,m=e.triggerProcess,f=e.pushMsg,h=e.templateId,g=Vc(l,s),b=g&&g.panel||l,v=Object(me.c)(),_=ra()(v,1)[0],w={name:c,avatar:n,showBack:X.isMobile()&&!!e.standalone,fontColor:b.fontColor,themeColor:b.themeColor,closeEnabled:!e.standalone,closeText:X.isMobile()?_("关闭"):null,handleClose:function(){yt(!1)}};X.isMobile()&&delete w.avatar;var y=Object(ue.useCallback)(function(e,t,n){return function(t,n,e){var a=e.entId,o=e.trackId,i=e.visitId,r=e.browserId,c=e.templateId,l=e.data;return he(a,o,i,r,l,{source:"mpush",template_id:c}).then(function(e){return!!e.data.success&&(n(je(t)),!0)})}(e,u,{entId:a,trackId:i,visitId:o,browserId:r,templateId:h,data:n}).then(function(e){e&&(f(cp(_("您已成功提交"))),m(),function(e){fe({url:"/mpush/stats",method:"post",headers:{"content-type":"application/json"},data:e})}({ent_id:a,track_id:i,template_id:h,type:"mpush_clue"}))})},[m,u,a,i,o,r,h,f,_]),x={msgs:d,handleImgOnload:jn,handleRedirectTicket:function(){u(Yt({showTicket:!0}))},scrollToBottom:Tn,handleImagePreview:$c,handleCardSubmit:y,handleUserOption:p,cardSize:zd(t)};return pe.a.createElement(up,null,pe.a.createElement(pp,null,pe.a.createElement(cl,w)),pe.a.createElement(dp,null,pe.a.createElement(Nc,Qa()({},x,{styles:g}))))})),fp=Object(o.b)(function(e){return{detail:e.getIn(["smartGuide","templateDetail"])}},function(e){return{dispatch:e}})(function(e){function a(e){setTimeout(function(){_(-1),k([].concat(ie()(x),[e])),h(e),_(0)},1e3)}var t=Object(me.c)(),n=ra()(t,1)[0],o=e.detail,i=o.id,r=o.avatar,c=o.agentName,l=o.nodes,s=o.html,d=e.dispatch,u=c,p=Object(ue.useState)(null),m=ra()(p,2),f=m[0],h=m[1],g=Object(ue.useState)(-1),b=ra()(g,2),v=b[0],_=b[1],w=Object(ue.useState)([]),y=ra()(w,2),x=y[0],k=y[1],E=function(e,t,n){return{id:Yn(8),agent:{nickname:e,avatar:t},from_type:"bot",content_type:"rich_text",content:n,extra:{content:n}}}.bind(null,u,r),I=lp.bind(null,u,r),C=function(e,t,n){var a=Yn(8);return{id:a,agent:{nickname:e,avatar:t},from_type:"bot",content_type:"_user_options",content:n,_useWrap:!1,extra:{msgId:a}}}.bind(null,u,r),T=Object(ue.useCallback)(function(){_(v+1)},[v]),S=Object(ue.useCallback)(function(e){d(Se(e))},[d]);return Object(ue.useEffect)(function(){var e=E(s);d(Se(e,!0)),l&&0!==l.length&&a(l[0].id)},[]),Object(ue.useEffect)(function(){if(f&&-1!==v){var e=l.find(function(e){return e.id===f});if(e){var t=e.node_body[v];t?("message"===t.type?(d(Se(E(t.content))),setTimeout(T,1e3)):"card"===t.type&&d(Se(I(t.content))),Tn()):"option"===e.node_type?(d(Se(C(e.options))),Tn()):"action"===e.node_type&&(ip(e.actions,x),d(Se(cp(n("对话已结束")))),Tn())}}},[f,v,l,d,C,E,I,T,x,n]),pe.a.createElement(mp,{handleUserOption:function(e,t,n){d(je(e)),d(Se(function(e){return{id:Yn(8),from_type:"client",content_type:"text",content:e}}(t))),Tn(),a(n)},triggerProcess:T,pushMsg:S,templateId:i})}),hp=d.d.div.withConfig({displayName:"bubble__Container",componentId:"hpi5ch-0"})(["position:absolute;left:50%;top:50%;z-index:999;max-width:80%;background:rgba(20,20,20,0.3);transform:translateX(-50%) translateY(-50%);padding:10px;border-radius:5px;color:#fff;background:rgba(0,0,0,0.5);"]),gp=d.d.div.withConfig({displayName:"bubble__Mask",componentId:"hpi5ch-1"})(["position:absolute;top:0;bottom:0;left:0;right:0;opacity:0;background:rgba(255,255,255,0);"]),bp=d.d.div.withConfig({displayName:"frame-chat-content__Content",componentId:"smb4c1-0"})(["width:100%;height:100%;position:relative;"]);var vp=Object(d.e)(Object(o.b)(function(e){return{standalone:e.getIn(["config","standalone"]),customTheme:e.get("theme"),widgetContent:e.getIn(["router","widgetContent"]),alertVisible:e.getIn(["router","alertVisible"]),alertConfig:e.getIn(["router","alertConfig"])}},function(e){return{dispatch:e}})(function(e){var t=e.standalone,n=e.widgetContent,a=e.alertVisible,o=e.alertConfig,i=Vc(e.customTheme,t),r=X.isMobile()?"mobile":"desktop",c=i&&i.panel.type||e.theme.panel.type,l="".concat(r,".").concat(c),s=!t&&("desktop.standard"===l||"desktop.custom"===l);return Object(ue.useEffect)(function(){return s&&Ke.register(!0,"chat",!1),function(){Ke.unregister(!0,!1)}},[l,s]),pe.a.createElement(bp,null,function(){switch(n){case"chatBox":return pe.a.createElement(Pd,{type:l});case"preForm":return pe.a.createElement(ku,null);case"messageBoard":return pe.a.createElement($u,null);case"callback":return pe.a.createElement(ou,null);case"queue":return pe.a.createElement(op,null);case"smart-guide":return pe.a.createElement(fp,{type:"".concat(r,".").concat(c)});default:return null}}(),pe.a.createElement(sp,Qa()({visible:a},o,{onClose:function(){e.dispatch(q({alertVisible:!1,alertConfig:{content:""}}))}})))})),_p=n(468),wp=n.n(_p),yp=n(469),xp=n.n(yp),kp=n(470),Ep=n.n(kp),Ip=n(471),Cp=n.n(Ip),Tp=n(472),Sp=n.n(Tp),jp=n(473),Np=n.n(jp),Op=d.d.div.withConfig({displayName:"audio__AudioContainer",componentId:"kbmlz9-0"})(["display:none;"]),Mp=Object(o.b)(function(e){return{message:e.get("message")}},function(e){return{dispatch:e}})(function(e){var t=e.message,n=e.dispatch,a=t.get("ringing"),o=t.get("ringType"),i=t.get("ringEnabled"),r=X.isMobile(),c=Object(ue.useRef)(null),l=Object(ue.useRef)(null),s=Object(ue.useRef)(null);return Object(ue.useEffect)(function(){if(i&&a&&o&&!r)try{switch(o){case"newChat":c.current.play().then(function(){},function(){console.log("Sound not allow")});break;case"newMessage":l.current.play().then(function(){},function(){console.log("Sound not allow")});break;case"sentMessage":s.current.play().then(function(){},function(){console.log("Sound not allow")})}}catch(e){console.log(e)}n(it({ringing:!1,ringType:""}))},[n,i,a,o,r]),pe.a.createElement(Op,null,pe.a.createElement("audio",{ref:c,preload:"preload"},pe.a.createElement("track",{kind:"captions"}),pe.a.createElement("source",{src:wp.a,type:"audio/ogg"}),pe.a.createElement("source",{src:xp.a,type:"audio/mpeg"})),pe.a.createElement("audio",{ref:l,preload:"preload"},pe.a.createElement("track",{kind:"captions"}),pe.a.createElement("source",{src:Ep.a,type:"audio/ogg"}),pe.a.createElement("source",{src:Cp.a,type:"audio/mpeg"})),pe.a.createElement("audio",{ref:s,preload:"preload"},pe.a.createElement("track",{kind:"captions"}),pe.a.createElement("source",{src:Sp.a,type:"audio/ogg"}),pe.a.createElement("source",{src:Np.a,type:"audio/mpeg"})))});function Dp(){var e=Va()(["\n    html,body {\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n        font-size: 13px;\n        font-family: 'Helvetica Neue',Helvetica,Arial,'Hiragino Sans GB','Microsoft YaHei',sans-serif;\n    }\n    html, body, div, span, ul, ol, li, p, label {\n        margin:0;\n        padding:0;\n    }\n    body {\n        transform: translateY(0px);\n        zoom: 1;\n    }\n    input {\n        outline: none;\n    }\n"]);return Dp=function(){return e},e}var zp=Object(d.c)(Dp()),Bp=Object(o.b)(function(e){return{showWidget:e.getIn(["router","showWidget"]),buttonActived:e.getIn(["router","buttonActived"]),servability:e.getIn(["config","servability"]),visitorStatus:e.getIn(["config","visitorStatus"]),showSurvey:e.getIn(["survey","showSurvey"]),scheduler:e.getIn(["message","scheduler"]),convId:e.getIn(["message","convId"]),unableToServe:e.getIn(["message","unableToServe"]),showTicket:e.getIn(["ticket","showTicket"]),inQueue:e.getIn(["queue","inQueue"]),templateDetail:e.getIn(["smartGuide","templateDetail"])}},null)(function(e){var t=e.showWidget,n=e.buttonActived,a=e.servability,o=e.visitorStatus,i=e.showSurvey,r=e.scheduler,c=e.convId,l=e.unableToServe,s=e.showTicket,d=e.inQueue,u=e.templateDetail;return Object(ue.useEffect)(function(){if(t){if("smart-guide"===n&&void 0!==u.type&&"welcoming"!==u.type)return void It("smart-guide");"chat"===n||"invite"===n||"smart-guide"===n?4===o?It("chatBox"):a?i&&4!==o?It("preForm"):(r||c||oa(),l||s?It("messageBoard"):d?(Xe("convClickCallback","queue"),It("queue")):It("chatBox")):(Xe("convClickCallback","ticket"),It("messageBoard")):"callback"===n&&It("callback")}},[t,n,i,a,r,c,l,s,d,o,u.type]),pe.a.createElement(La,{component:Xc,GlobalStyle:zp,visible:t},pe.a.createElement(vp,null),pe.a.createElement(Mp,null))}),Pp=d.d.iframe.withConfig({displayName:"base-invite__BaseFrame",componentId:"hnth0k-0"})(["border:none;padding:0;overflow-x:visible;overflow-y:visible;overflow-wrap:normal;position:fixed;z-index:9999999;cursor:pointer;text-align:center;display:"," !important;"],function(e){return e.visible?"block":"none"}),Ap=pe.a.forwardRef(function(e,t){var n=e.frameRef;return pe.a.createElement(Pp,Qa()({},e,{name:"invite",ref:n}))});function qp(t,e){var n=m()(t);if(I.a){var a=I()(t);e&&(a=a.filter(function(e){return k()(t,e).enumerable})),n.push.apply(n,a)}return n}function Rp(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qp(n,!0).forEach(function(e){T()(t,e,n[e])}):y.a?_()(t,y()(n)):qp(n).forEach(function(e){b()(t,e,k()(n,e))})}return t}function Lp(e){var t=e.invite,n=e.theme,a=e.config,o=X.isMobile()?"mobile":"desktop",i=function(e,t,n){var a={},o=t.get("mobile"),i=t.get("desktop");if(o||i){var r="mobile"===n?o:i,c=r.get("position"),l=r.get("type");switch(l){case 1:var s=K()(e.bottom,10)+K()(e.height,10)+8;a={width:"340px",height:"150px",left:e.left,right:e.right,bottom:"".concat(s,"px"),boxShadow:"0 0 14px 0 rgba(0, 0, 0, 0.16)"};break;case 2:a={width:"280px",height:"260px"};break;case 3:case 4:a={width:"330px",height:"150px"};break;case 5:a={picSrc:"".concat(r.get("src"))};break;case 6:a={width:"".concat(r.getIn(["bgi","width"])+20,"px"),height:"".concat(r.getIn(["bgi","height"])+20,"px")}}if(1!==l){var d=1;if(c&&(d=c.get("type")),"mobile"===n)switch(d){case 1:a=Rp({},a,{left:"50%",top:"50%",transform:"translate(-50%,-50%)"});break;case 2:a=Rp({},a,{left:"50%",transform:"translateX(-50%)",top:"".concat(c.get("value"),"px")});break;case 3:a=Rp({},a,{left:"50%",transform:"translateX(-50%)",bottom:"".concat(c.get("value"),"px")})}else switch(d){case 1:a=Rp({},a,{left:"50%",top:"50%",transform:"translate(-50%,-50%)"});break;case 2:a=Rp({},a,{left:"".concat(c.get("side"),"px"),bottom:"".concat(c.get("bottom"),"px")});break;case 3:a=Rp({},a,{right:"".concat(c.get("side"),"px"),bottom:"".concat(c.get("bottom"),"px")})}}}return Rp({},a)}(co(n,a,o),t,o),r=Za(i.picSrc);r&&(i=Rp({},i,{},r));var c=e.frameRef;return pe.a.createElement(Up,Qa()({},e,i,{ref:c}))}var Up=Object(d.d)(Ap).withConfig({displayName:"invite__InviteStyle",componentId:"sc-1646giz-0"})(["height:"," !important;width:"," !important;max-width:90%;top:",";left:",";right:",";bottom:",";transform:",";"],function(e){return e.height},function(e){return e.width},function(e){return e.top},function(e){return e.left},function(e){return e.right},function(e){return e.bottom},function(e){return e.transform}),Fp=Object(o.b)(function(e){return{config:e.get("config"),invite:e.get("invite"),theme:e.get("theme")}},function(e){return{dispatch:e}})(function(e){return pe.a.createElement(Lp,e)}),Wp=n(474),Gp=n.n(Wp),Vp=n(475),Hp=n.n(Vp),Qp=n(476),Yp=n.n(Qp),$p=d.d.div.withConfig({displayName:"frame-invite-content__FrameInviteContentBoxStyle",componentId:"sc-1g53vrw-0"})(["height:100%;width:100%;background:",";padding:",";background-size:",";transform:",";"],function(e){return e.background},function(e){return e.padding},function(e){return e.backgroundSize},function(e){return e.transform}),Jp=d.d.div.withConfig({displayName:"frame-invite-content__FrameInviteContentStyle",componentId:"sc-1g53vrw-1"})(["height:",";width:",";margin:",";padding:",";box-shadow:",";border-radius:",";background:",";font-size:13px;overflow:hidden;position:relative;.content{width:100%;height:100%;box-sizing:border-box;overflow:hidden;line-height:",";}"],function(e){return e.height},function(e){return e.width},function(e){return e.margin},function(e){return e.padding},function(e){return e.boxShadow},function(e){return e.borderRadius},function(e){return e.background},function(e){return e.lineHeight}),Kp=d.d.div.withConfig({displayName:"frame-invite-content__CloseWrapper",componentId:"sc-1g53vrw-2"})(["position:absolute;right:3px;top:3px;z-index:10;font-size:14px;width:30px;height:30px;text-align:center;line-height:30px;background:#fff;border-radius:50%;color:#999;cursor:pointer;box-shadow:0 0 3px 0 rgba(0,0,0,0.15);"]),Zp=d.d.div.withConfig({displayName:"frame-invite-content__ActionButton",componentId:"sc-1g53vrw-3"})(["position:absolute;height:","px;width:","px;left:","px;top:","px;cursor:pointer;"],function(e){return e.height},function(e){return e.width},function(e){return e.left},function(e){return e.top}),Xp=d.d.a.withConfig({displayName:"frame-invite-content__ActionLink",componentId:"sc-1g53vrw-4"})(["position:absolute;height:","px;width:","px;left:","px;top:","px;cursor:pointer;"],function(e){return e.height},function(e){return e.width},function(e){return e.left},function(e){return e.top}),em=Object(o.b)(function(e){return{config:e.get("config"),invite:e.get("invite")}},function(e){return{dispatch:e}})(function(e){function m(){n(Ct)}function f(){n(gt("customer")),yt(!0,"invite")}var t=e.invite,n=e.dispatch,a=function(e,t){var n={},a={},o="",i="",r=1,c=e.get("mobile"),l=e.get("desktop");if(c||l){var s="mobile"===t?c:l;switch(r=s.get("type"),o=s.get("text"),r){case 1:n={transform:"translate(20px,20px)"},a={width:"260px",height:"44px",boxShadow:"0 0 14px 0 rgba(0, 0, 0, 0.16)",borderRadius:"4px",padding:"50px 20px",background:"#fff",lineHeight:"22px"};break;case 2:n={background:"url(".concat(Gp.a,") no-repeat center")},a={width:"156px",height:"68px",padding:"58px 62px 0",lineHeight:"23px"};break;case 3:n={background:"url(".concat(Hp.a,") no-repeat center"),backgroundSize:"320px"},a={width:"175px",height:"44px",padding:"50px 0 0 110px",lineHeight:"22px"};break;case 4:n={background:"url(".concat(Yp.a,") no-repeat center"),backgroundSize:"320px"},a={width:"170px",height:"44px",padding:"46px 0 0 40px",lineHeight:"22px"};break;case 5:o="",n={background:"url(".concat(s.get("src"),") no-repeat center"),backgroundSize:"100%"};break;case 6:i=s.get("actions"),o="",n={background:"url(".concat(s.getIn(["bgi","src"]),") no-repeat center"),backgroundSize:"".concat(s.getIn(["bgi","width"]),"px ").concat(s.getIn(["bgi","height"]),"px")},a={width:"100%",height:"100%"}}}return{contentBoxStyle:n,contentStyle:a,content:o,actions:i,type:r}}(t,X.isMobile()?"mobile":"desktop"),o=a.contentBoxStyle,i=a.contentStyle,r=a.content,c=a.actions,l=a.type;return pe.a.createElement("div",null,6!==l?pe.a.createElement(Kp,{onClick:m},"✕"):null,pe.a.createElement($p,Qa()({},o,{onClick:6!==l?f:function(){}}),pe.a.createElement(Jp,i,pe.a.createElement("div",{className:"content"},r),function(e){var p=[];e&&e.toJS().forEach(function(e,t){var n=e.height,a=e.width,o=e.type,i=e.linkType,r=e.position,c=e.href,l={height:n,width:a,left:r.left,top:r.top},s="";switch(o){case 1:s=pe.a.createElement(Zp,Qa()({},l,{onClick:f,key:"".concat(o).concat(t)}));break;case 2:s=pe.a.createElement(Zp,Qa()({},l,{onClick:m,key:"".concat(o).concat(t)}));break;case 3:var d="",u="";1===i&&(d=c,u="_blank"),2===i&&(d="mailto:".concat(c)),3===i&&(d="tel:".concat(c)),s=pe.a.createElement(Xp,Qa()({},l,{key:"".concat(o).concat(t),href:d,target:u}));break;default:s=pe.a.createElement(Zp,Qa()({},l,{onClick:f,key:"".concat(o).concat(t)}))}p.push(s)});return p}(c))))});function tm(){var e=Va()(["\n    html,body {\n        height:100%;\n        width:100%;\n        margin:0;\n        padding:0;\n    }\n"]);return tm=function(){return e},e}var nm=Object(d.c)(tm()),am=d.d.div.withConfig({displayName:"router-invite__Wrapper",componentId:"sc-1m23l53-0"})(["width:100%;height:100%;overflow:hidden;"]),om=Object(o.b)(function(e){return{router:e.get("router")}},function(e){return{dispatch:e}})(function(e){var t=e.router;return pe.a.createElement(La,{visible:t.get("showInvite"),component:Fp,GlobalStyle:nm,iframeName:"invite"},pe.a.createElement(am,null,pe.a.createElement(em,null)))}),im=d.d.iframe.withConfig({displayName:"frame-call__CallFrame",componentId:"sc-1wagxvg-0"})(["border:none;margin:0;padding:0;overflow-x:visible;overflow-y:visible;overflow-wrap:normal;position:fixed;z-index:9999999;cursor:pointer;text-align:center;width:62px !important;height:62px !important;border-radius:50%;box-shadow:rgba(0,0,0,0.16) 0 5px 20px;left:","px;right:","px;background-color:",";bottom:","px;display:"," !important;"],function(e){return K()(e.left,10)+15},function(e){return K()(e.right,10)+15},function(e){return"".concat(e.bgColor)},function(e){return K()(e.bottom,10)+90},function(e){return"call"===e.type&&e.visible?"block":"none"}),rm=pe.a.forwardRef(function(e,t){var n=e.theme,a=e.frameRef,o=e.config,i=X.isMobile()?"mobile":"desktop",r=co(n,o,i),c=n.getIn(["".concat(i),"btn"]),l="";return c&&(l=c.type),pe.a.createElement(im,Qa()({},e,r,{type:l,name:"call",ref:a}))}),cm=Object(o.b)(function(e){return{theme:e.get("theme"),config:e.get("config")}})(rm),lm=Object(o.b)(function(e){return{theme:e.get("theme")}})(function(e){var t=e.theme,n=X.isMobile()?"mobile":"desktop",a=t.getIn(["".concat(n),"btn"]);return pe.a.createElement(Co,{bgColor:a&&a.theme},pe.a.createElement(jo,null,pe.a.createElement(Io,{type:"call-callback"})))});function sm(){var e=Va()(["\n  html,body {\n    height:100%;\n    width:100%;\n    margin:0;\n    padding:0;\n  }\n"]);return sm=function(){return e},e}function dm(e,t){function n(e){return K()(e,10)||0}var a=e.customTheme,o=e.withoutBtn,i=e.visible,r=[],c=a.getIn([fm,"btn","type"]),l=a.getIn([fm,"btn","position","type"]);if(!1===i?r.push("visibility: hidden !important;z-index:-1000 !important;"):r.push("visibility: visible !important;z-index:1000 !important;"),o)r.push.apply(r,["right: 20px;","bottom: 20px;"]);else if("mobile"==fm){var s=20+n("bottom"===t.type?0:n(t.bottom))+n(t.height)+("call"===c?n(t.height)+20:0);r.push.apply(r,["".concat(l||"right",": 0;"),"bottom: ".concat(s,"px;")])}else{var d=20+n("bottom"===t.type?0:n(t.bottom))+n(t.height)+("call"===c?n(t.height)+20:0),u="aside"===c?"-".concat(15):n(t[l]);r.push.apply(r,["".concat(l||"right",": ").concat(u,"px;"),"bottom: ".concat(d,"px;")])}return r}var um=Object(d.c)(sm()),pm=d.d.div.withConfig({displayName:"router-call-botton__Wrapper",componentId:"dkoslj-0"})(["width:100%;height:100%;overflow:hidden;"]),mm=Object(o.b)(function(e){return{router:e.get("router"),config:e.get("config")}},null)(function(e){var t=e.router,n=e.config;return pe.a.createElement(La,{visible:t.get("showButton")&&!n.get("withoutBtn"),component:cm,GlobalStyle:um,iframeName:"call"},pe.a.createElement(pm,{onClick:function(){yt(!0,"callback")}},pe.a.createElement(lm,null)))}),fm=X.isMobile()?"mobile":"desktop",hm=d.d.iframe.withConfig({displayName:"frame-smart-guide__Frame",componentId:"ys136d-0"})(["border:none;width:325px !important;margin:0;padding:0;overflow:hidden;overflow-wrap:normal;display:block;position:fixed;z-index:9999999;background:transparent;",""],function(e){return e.styles?e.styles.join(""):""}),gm=pe.a.forwardRef(function(e,t){var n=e.frameRef,a=e.customTheme,o=e.config,i=co(a,o,fm)||{},r=dm(e,i);return pe.a.createElement(hm,{name:"smart-guide",frameborder:"0",scrolling:"no",allowtransparency:"true",ref:n,styles:r})}),bm=Object(d.e)(Object(o.b)(function(e){return{withoutBtn:e.getIn(["config","withoutBtn"]),standalone:e.getIn(["config","standalone"]),customTheme:e.get("theme"),config:e.get("config")}},function(e){return{dispatch:e}})(gm)),vm=X.isMobile()?"mobile":"desktop",_m=d.d.div.withConfig({displayName:"frame-smart-guide-content__Container",componentId:"sc-1nq7zh4-0"})(["width:100%;height:100%;box-sizing:border-box;padding:20px;background:transparent;position:relative;",""],function(e){return"left"===e.type?"padding-right: 45px;":"padding-left: 45px;"}),wm=d.d.div.withConfig({displayName:"frame-smart-guide-content__Inner",componentId:"sc-1nq7zh4-1"})(["width:100%;height:100%;box-sizing:border-box;word-break:break-word;padding:15px;background:#fafafa;border-radius:8px;overflow:visible;position:relative;box-shadow:0 4px 8px 2px rgba(0,0,0,0.08);.close{"," position:absolute;right:-14px;top:-16px;z-index:100;font-size:14px;width:30px;height:30px;line-height:30px;text-align:center;background:#fff;border-radius:50%;color:#999;cursor:pointer;box-shadow:2px 2px 5px 1px rgba(0,0,0,0.1);}&:hover .close{display:block;}"],function(e){return e.mobile?"":"display: none;"}),ym=d.d.div.withConfig({displayName:"frame-smart-guide-content__Avatar",componentId:"sc-1nq7zh4-2"})(["position:absolute;bottom:20px;"," width:36px;height:36px;border-radius:18px;overflow:hidden;box-shadow:0 4px 8px 2px rgba(0,0,0,0.08);img{width:100%;height:100%;}"],function(e){return"left"===e.type?"right: 0;":"left: 0;"}),xm=d.d.div.withConfig({displayName:"frame-smart-guide-content__RichText",componentId:"sc-1nq7zh4-3"})(["width:100%;",""],function(e){return e.styles?e.styles.join(""):""}),km=Object(o.b)(function(e){return{detail:e.getIn(["smartGuide","templateDetail"]),posType:e.getIn(["theme",vm,"btn","position","type"])}},function(e){return{dispatch:e}})(function(e){var t=e.detail,n=e.dispatch,a=e.posType,o=t.avatar,i=t.html,r=(t.type,X.isMobile()),c=Object(ue.useRef)(null),l=Object(ue.useState)(null),s=ra()(l,2),d=s[0],u=s[1];return Object(ue.useEffect)(function(){var e=c.current;if(e&&e.scrollHeight){var t=window.parent.document.querySelector("iframe[name=smart-guide]"),n=e.scrollHeight;300<n?(u(["overflow: auto;","height: ".concat(300,"px;"),"max-height: ".concat(300,"px;")]),t.style.setProperty("height","".concat(375,"px"),"important")):(u(["height: ".concat(n)]),t.style.setProperty("height","".concat(n+75,"px"),"important"))}},[i]),pe.a.createElement(_m,{type:a},pe.a.createElement(ym,{type:a},pe.a.createElement("img",{alt:"avatar",src:o})),pe.a.createElement(wm,{mobile:r,onClick:function(e){e.stopPropagation(),sn(),n(function(e,t){return Te(e,t,!1)}),n(Ee({templateActive:!0})),yt(!0,"smart-guide")}},pe.a.createElement("div",{className:"close",onClick:function(e){e.stopPropagation(),n(function(e,t){return Te(e,t,!1)})}},"✕"),pe.a.createElement(xm,{styles:d,className:"rich-text",ref:c,dangerouslySetInnerHTML:{__html:i}})))});function Em(){var e=Va()(["\n    html,body {\n        height:100%;\n        width:100%;\n        margin:0;\n        padding:0;\n    }\n"]);return Em=function(){return e},e}var Im=Object(d.c)(Em()),Cm=d.d.div.withConfig({displayName:"router-smart-guide__Wrapper",componentId:"ab8bk7-0"})(["width:100%;height:100%;overflow:hidden;"]),Tm=Object(o.b)(function(e){return{router:e.get("router")}},null)(function(e){var t=e.router;return pe.a.createElement(La,{visible:t.get("showSmartGuide"),component:bm,GlobalStyle:Im,iframeName:"smart-guide"},pe.a.createElement(Cm,null,pe.a.createElement(km,null)))});function Sm(){var e=Va()(["\n    ._MEIQIA_FIX_BODY {\n        width:100% !important;\n        height:100% !important;\n        position:fixed !important;\n        overflow: visible !important;\n        zoom: 1 !important;\n    }\n"]);return Sm=function(){return e},e}var jm=Object(d.c)(Sm());var Nm=Object(o.b)(function(e){return{config:e.get("config")}},function(e){return{dispatch:e}})(function(e){var t=e.config,n=t.get("language"),a=Object(me.c)(),o=ra()(a,2),i=(o[0],o[1]);Object(ue.useEffect)(function(){i.changeLanguage(n)},[i,n]);t.get("isInit");return pe.a.createElement(pe.a.Fragment,null,pe.a.createElement(d.a,{target:window.parent.document.head},pe.a.createElement(jm,null)),pe.a.createElement(Bp,null),pe.a.createElement(Lo,null),pe.a.createElement(Fc,null),pe.a.createElement(om,null),pe.a.createElement(mm,null),pe.a.createElement(Tm,null))}),Om={main:"mediumseagreen",device:"desktop",panel:{type:"standard",position:{type:"right",bottom:"30",horizontal:"30"},themeColor:"#cc8238",fontColor:"#fff",profileBgColor:"#fff"},btn:{type:"round",position:{type:"right",bottom:"30",horizontal:"30"},themeColor:"#007aff"}},Mm=pe.a.createElement(d.b,{theme:Om},pe.a.createElement(o.a,{store:ln},pe.a.createElement(Nm,null)));Wa(ln.dispatch,ln);var Dm=r();a.render(Mm,Dm);n(798)}});